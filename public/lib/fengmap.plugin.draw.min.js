/**Released Version v3.1.10,BUILD 237,Time 1749031855583. Fengmap Javascript SDK , see: https://www.fengmap.com for details**/
((t,i)=>{"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.fengmap=i():t.fengmap=i()})(this,function(){return e=[function(N,P,t){t.r(P);var r=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"];Math.PI;function L(){var t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,e=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(r[255&t]+r[t>>8&255]+r[t>>16&255]+r[t>>24&255]+"-"+r[255&i]+r[i>>8&255]+"-"+r[i>>16&15|64]+r[i>>24&255]+"-"+r[63&e|128]+r[e>>8&255]+"-"+r[e>>16&255]+r[e>>24&255]+r[255&n]+r[n>>8&255]+r[n>>16&255]+r[n>>24&255]).toLowerCase()}function p(t,i,e){return Math.max(i,Math.min(e,t))}function F(t,i){return(t%i+i)%i}function D(t,i,e){return(1-e)*t+e*i}function Y(t,i){switch(i.constructor){case Float32Array:return t;case Uint32Array:return t/4294967295;case Uint16Array:return t/65535;case Uint8Array:return t/255;case Int32Array:return Math.max(t/2147483647,-1);case Int16Array:return Math.max(t/32767,-1);case Int8Array:return Math.max(t/127,-1);default:throw new Error("Invalid component type.")}}function s(t,i){switch(i.constructor){case Float32Array:return t;case Uint32Array:return Math.round(4294967295*t);case Uint16Array:return Math.round(65535*t);case Uint8Array:return Math.round(255*t);case Int32Array:return Math.round(2147483647*t);case Int16Array:return Math.round(32767*t);case Int8Array:return Math.round(127*t);default:throw new Error("Invalid component type.")}}function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _(){_=function(){return o};var u,o={},t=Object.prototype,a=t.hasOwnProperty,f=Object.defineProperty||function(t,i,e){t[i]=e.value},i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",e=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function s(t,i,e){return Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[i]}try{s({},"")}catch(u){s=function(t,i,e){return t[i]=e}}function h(t,i,e,n){var r,s,o,h,i=i&&i.prototype instanceof p?i:p,i=Object.create(i.prototype),n=new E(n||[]);return f(i,"_invoke",{value:(r=t,s=e,o=n,h=c,function(t,i){if(h===y)throw Error("Generator is already running");if(h===d){if("throw"===t)throw i;return{value:u,done:!0}}for(o.method=t,o.arg=i;;){var e=o.delegate;if(e){e=function t(i,e){var n=e.method,r=i.iterator[n];if(r===u)return e.delegate=null,"throw"===n&&i.iterator.return&&(e.method="return",e.arg=u,t(i,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;n=l(r,i.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,b;r=n.arg;return r?r.done?(e[i.resultName]=r.value,e.next=i.nextLoc,"return"!==e.method&&(e.method="next",e.arg=u),e.delegate=null,b):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b)}(e,o);if(e){if(e===b)continue;return e}}if("next"===o.method)o.sent=o.u=o.arg;else if("throw"===o.method){if(h===c)throw h=d,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);h=y;e=l(r,s,o);if("normal"===e.type){if(h=o.done?d:v,e.arg===b)continue;return{value:e.arg,done:o.done}}"throw"===e.type&&(h=d,o.method="throw",o.arg=e.arg)}})}),i}function l(t,i,e){try{return{type:"normal",arg:t.call(i,e)}}catch(t){return{type:"throw",arg:t}}}o.wrap=h;var c="suspendedStart",v="suspendedYield",y="executing",d="completed",b={};function p(){}function m(){}function w(){}var i={},k=(s(i,n,function(){return this}),Object.getPrototypeOf),k=k&&k(k(O([]))),g=(k&&k!==t&&a.call(k,n)&&(i=k),w.prototype=p.prototype=Object.create(i));function A(t){["next","throw","return"].forEach(function(i){s(t,i,function(t){return this._invoke(i,t)})})}function M(o,h){var i;f(this,"_invoke",{value:function(e,n){function t(){return new h(function(t,i){!function i(t,e,n,r){var s,t=l(o[t],o,e);if("throw"!==t.type)return(e=(s=t.arg).value)&&"object"==x(e)&&a.call(e,"__await")?h.resolve(e.v).then(function(t){i("next",t,n,r)},function(t){i("throw",t,n,r)}):h.resolve(e).then(function(t){s.value=t,n(s)},function(t){return i("throw",t,n,r)});r(t.arg)}(e,n,t,i)})}return i=i?i.then(t,t):t()}})}function S(t){var i={tryLoc:t[0]};1 in t&&(i.catchLoc=t[1]),2 in t&&(i.finallyLoc=t[2],i.afterLoc=t[3]),this.tryEntries.push(i)}function j(t){var i=t.completion||{};i.type="normal",delete i.arg,t.completion=i}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function O(i){if(i||""===i){var e,t=i[n];if(t)return t.call(i);if("function"==typeof i.next)return i;if(!isNaN(i.length))return e=-1,(t=function t(){for(;++e<i.length;)if(a.call(i,e))return t.value=i[e],t.done=!1,t;return t.value=u,t.done=!0,t}).next=t}throw new TypeError(x(i)+" is not iterable")}return f(g,"constructor",{value:m.prototype=w,configurable:!0}),f(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,r,"GeneratorFunction"),o.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,r,"GeneratorFunction")),t.prototype=Object.create(g),t},o.awrap=function(t){return{v:t}},A(M.prototype),s(M.prototype,e,function(){return this}),o.AsyncIterator=M,o.async=function(t,i,e,n,r){void 0===r&&(r=Promise);var s=new M(h(t,i,e,n),r);return o.isGeneratorFunction(i)?s:s.next().then(function(t){return t.done?t.value:s.next()})},A(g),s(g,r,"Generator"),s(g,n,function(){return this}),s(g,"toString",function(){return"[object Generator]"}),o.keys=function(t){var i,e=Object(t),n=[];for(i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},o.values=O,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this.u=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(j),!t)for(var i in this)"t"===i.charAt(0)&&a.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function t(t,i){return s.type="throw",s.arg=e,n.next=t,i&&(n.method="next",n.arg=u),!!i}for(var i=this.tryEntries.length-1;0<=i;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var o=a.call(r,"catchLoc"),h=a.call(r,"finallyLoc");if(o&&h){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!h)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,i){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}var s=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=i&&i<=r.finallyLoc?null:r)?r.completion:{};return s.type=t,s.arg=i,r?(this.method="next",this.next=r.finallyLoc,b):this.complete(s)},complete:function(t,i){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&i&&(this.next=i),b},finish:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var e=this.tryEntries[i];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),j(e),b}},catch:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var e,n,r=this.tryEntries[i];if(r.tryLoc===t)return"throw"===(e=r.completion).type&&(n=e.arg,j(r)),n}throw Error("illegal catch attempt")},delegateYield:function(t,i,e){return this.delegate={iterator:O(t),resultName:i,nextLoc:e},"next"===this.method&&(this.arg=u),b}},o}function V(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=x(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=x(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==x(t)?t:t+""))(n.key),n)}}var G=(()=>{function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=this,n=r;if(!(e instanceof n))throw new TypeError("Cannot call a class as a function");r.prototype.isVector2=!0,this.x=t,this.y=i}return t=r,(i=[{key:"width",get:function(){return this.x},set:function(t){this.x=t}},{key:"height",get:function(){return this.y},set:function(t){this.y=t}},{key:"set",value:function(t,i){return this.x=t,this.y=i,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setComponent",value:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this}},{key:"addVectors",value:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this}},{key:"addScaledVector",value:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this}},{key:"subVectors",value:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"applyMatrix3",value:function(t){var i=this.x,e=this.y,t=t.elements;return this.x=t[0]*i+t[3]*e+t[6],this.y=t[1]*i+t[4]*e+t[7],this}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}},{key:"clamp",value:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this}},{key:"clampScalar",value:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this}},{key:"clampLength",value:function(t,i){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(i,e)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y}},{key:"cross",value:function(t){return this.x*t.y-this.y*t.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){return Math.atan2(-this.y,-this.x)+Math.PI}},{key:"angleTo",value:function(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===i?Math.PI/2:(t=this.dot(t)/i,Math.acos(p(t,-1,1)))}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var i=this.x-t.x,t=this.y-t.y;return i*i+t*t}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this}},{key:"lerpVectors",value:function(t,i,e){return this.x=t.x+(i.x-t.x)*e,this.y=t.y+(i.y-t.y)*e,this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[i],this.y=t[i+1],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.x,t[i+1]=this.y,t}},{key:"fromBufferAttribute",value:function(t,i){return this.x=t.getX(i),this.y=t.getY(i),this}},{key:"rotateAround",value:function(t,i){var e=Math.cos(i),i=Math.sin(i),n=this.x-t.x,r=this.y-t.y;return this.x=n*e-r*i+t.x,this.y=n*i+r*e+t.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}},{key:Symbol.iterator,value:_().mark(function t(){return _().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.x;case 2:return t.next=4,this.y;case 4:case"end":return t.stop()}},t,this)})}])&&V(t.prototype,i),e&&V(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,e})();function R(t){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function J(){J=function(){return o};var u,o={},t=Object.prototype,a=t.hasOwnProperty,f=Object.defineProperty||function(t,i,e){t[i]=e.value},i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",e=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function s(t,i,e){return Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[i]}try{s({},"")}catch(u){s=function(t,i,e){return t[i]=e}}function h(t,i,e,n){var r,s,o,h,i=i&&i.prototype instanceof p?i:p,i=Object.create(i.prototype),n=new E(n||[]);return f(i,"_invoke",{value:(r=t,s=e,o=n,h=c,function(t,i){if(h===y)throw Error("Generator is already running");if(h===d){if("throw"===t)throw i;return{value:u,done:!0}}for(o.method=t,o.arg=i;;){var e=o.delegate;if(e){e=function t(i,e){var n=e.method,r=i.iterator[n];if(r===u)return e.delegate=null,"throw"===n&&i.iterator.return&&(e.method="return",e.arg=u,t(i,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;n=l(r,i.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,b;r=n.arg;return r?r.done?(e[i.resultName]=r.value,e.next=i.nextLoc,"return"!==e.method&&(e.method="next",e.arg=u),e.delegate=null,b):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b)}(e,o);if(e){if(e===b)continue;return e}}if("next"===o.method)o.sent=o.u=o.arg;else if("throw"===o.method){if(h===c)throw h=d,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);h=y;e=l(r,s,o);if("normal"===e.type){if(h=o.done?d:v,e.arg===b)continue;return{value:e.arg,done:o.done}}"throw"===e.type&&(h=d,o.method="throw",o.arg=e.arg)}})}),i}function l(t,i,e){try{return{type:"normal",arg:t.call(i,e)}}catch(t){return{type:"throw",arg:t}}}o.wrap=h;var c="suspendedStart",v="suspendedYield",y="executing",d="completed",b={};function p(){}function m(){}function w(){}var i={},k=(s(i,n,function(){return this}),Object.getPrototypeOf),k=k&&k(k(O([]))),g=(k&&k!==t&&a.call(k,n)&&(i=k),w.prototype=p.prototype=Object.create(i));function A(t){["next","throw","return"].forEach(function(i){s(t,i,function(t){return this._invoke(i,t)})})}function M(o,h){var i;f(this,"_invoke",{value:function(e,n){function t(){return new h(function(t,i){!function i(t,e,n,r){var s,t=l(o[t],o,e);if("throw"!==t.type)return(e=(s=t.arg).value)&&"object"==R(e)&&a.call(e,"__await")?h.resolve(e.v).then(function(t){i("next",t,n,r)},function(t){i("throw",t,n,r)}):h.resolve(e).then(function(t){s.value=t,n(s)},function(t){return i("throw",t,n,r)});r(t.arg)}(e,n,t,i)})}return i=i?i.then(t,t):t()}})}function S(t){var i={tryLoc:t[0]};1 in t&&(i.catchLoc=t[1]),2 in t&&(i.finallyLoc=t[2],i.afterLoc=t[3]),this.tryEntries.push(i)}function j(t){var i=t.completion||{};i.type="normal",delete i.arg,t.completion=i}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function O(i){if(i||""===i){var e,t=i[n];if(t)return t.call(i);if("function"==typeof i.next)return i;if(!isNaN(i.length))return e=-1,(t=function t(){for(;++e<i.length;)if(a.call(i,e))return t.value=i[e],t.done=!1,t;return t.value=u,t.done=!0,t}).next=t}throw new TypeError(R(i)+" is not iterable")}return f(g,"constructor",{value:m.prototype=w,configurable:!0}),f(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,r,"GeneratorFunction"),o.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,r,"GeneratorFunction")),t.prototype=Object.create(g),t},o.awrap=function(t){return{v:t}},A(M.prototype),s(M.prototype,e,function(){return this}),o.AsyncIterator=M,o.async=function(t,i,e,n,r){void 0===r&&(r=Promise);var s=new M(h(t,i,e,n),r);return o.isGeneratorFunction(i)?s:s.next().then(function(t){return t.done?t.value:s.next()})},A(g),s(g,r,"Generator"),s(g,n,function(){return this}),s(g,"toString",function(){return"[object Generator]"}),o.keys=function(t){var i,e=Object(t),n=[];for(i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},o.values=O,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this.u=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(j),!t)for(var i in this)"t"===i.charAt(0)&&a.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function t(t,i){return s.type="throw",s.arg=e,n.next=t,i&&(n.method="next",n.arg=u),!!i}for(var i=this.tryEntries.length-1;0<=i;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var o=a.call(r,"catchLoc"),h=a.call(r,"finallyLoc");if(o&&h){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!h)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,i){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}var s=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=i&&i<=r.finallyLoc?null:r)?r.completion:{};return s.type=t,s.arg=i,r?(this.method="next",this.next=r.finallyLoc,b):this.complete(s)},complete:function(t,i){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&i&&(this.next=i),b},finish:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var e=this.tryEntries[i];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),j(e),b}},catch:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var e,n,r=this.tryEntries[i];if(r.tryLoc===t)return"throw"===(e=r.completion).type&&(n=e.arg,j(r)),n}throw Error("illegal catch attempt")},delegateYield:function(t,i,e){return this.delegate={iterator:O(t),resultName:i,nextLoc:e},"next"===this.method&&(this.arg=u),b}},o}function Z(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=R(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=R(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==R(t)?t:t+""))(n.key),n)}}var H=(()=>{return t=function t(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=this,o=t;if(!(s instanceof o))throw new TypeError("Cannot call a class as a function");this.isQuaternion=!0,this.k=i,this.A=e,this.M=n,this.S=r},i=[{key:"x",get:function(){return this.k},set:function(t){this.k=t,this.j()}},{key:"y",get:function(){return this.A},set:function(t){this.A=t,this.j()}},{key:"z",get:function(){return this.M},set:function(t){this.M=t,this.j()}},{key:"w",get:function(){return this.S},set:function(t){this.S=t,this.j()}},{key:"set",value:function(t,i,e,n){return this.k=t,this.A=i,this.M=e,this.S=n,this.j(),this}},{key:"clone",value:function(){return new this.constructor(this.k,this.A,this.M,this.S)}},{key:"copy",value:function(t){return this.k=t.x,this.A=t.y,this.M=t.z,this.S=t.w,this.j(),this}},{key:"setFromEuler",value:function(t){var i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],e=t.k,n=t.A,r=t.M,s=t.O,t=Math.cos,o=Math.sin,h=t(e/2),u=t(n/2),a=t(r/2),f=o(e/2),l=o(n/2),c=o(r/2);switch(s){case"XYZ":this.k=f*u*a+h*l*c,this.A=h*l*a-f*u*c,this.M=h*u*c+f*l*a,this.S=h*u*a-f*l*c;break;case"YXZ":this.k=f*u*a+h*l*c,this.A=h*l*a-f*u*c,this.M=h*u*c-f*l*a,this.S=h*u*a+f*l*c;break;case"ZXY":this.k=f*u*a-h*l*c,this.A=h*l*a+f*u*c,this.M=h*u*c+f*l*a,this.S=h*u*a-f*l*c;break;case"ZYX":this.k=f*u*a-h*l*c,this.A=h*l*a+f*u*c,this.M=h*u*c-f*l*a,this.S=h*u*a+f*l*c;break;case"YZX":this.k=f*u*a+h*l*c,this.A=h*l*a+f*u*c,this.M=h*u*c-f*l*a,this.S=h*u*a-f*l*c;break;case"XZY":this.k=f*u*a-h*l*c,this.A=h*l*a-f*u*c,this.M=h*u*c+f*l*a,this.S=h*u*a+f*l*c;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===i&&this.j(),this}},{key:"setFromAxisAngle",value:function(t,i){var i=i/2,e=Math.sin(i);return this.k=t.x*e,this.A=t.y*e,this.M=t.z*e,this.S=Math.cos(i),this.j(),this}},{key:"setFromRotationMatrix",value:function(t){var t=t.elements,i=t[0],e=t[4],n=t[8],r=t[1],s=t[5],o=t[9],h=t[2],u=t[6],t=t[10],a=i+s+t;return 0<a?(a=.5/Math.sqrt(a+1),this.S=.25/a,this.k=(u-o)*a,this.A=(n-h)*a,this.M=(r-e)*a):s<i&&t<i?(a=2*Math.sqrt(1+i-s-t),this.S=(u-o)/a,this.k=.25*a,this.A=(e+r)/a,this.M=(n+h)/a):t<s?(a=2*Math.sqrt(1+s-i-t),this.S=(n-h)/a,this.k=(e+r)/a,this.A=.25*a,this.M=(o+u)/a):(a=2*Math.sqrt(1+t-i-s),this.S=(r-e)/a,this.k=(n+h)/a,this.A=(o+u)/a,this.M=.25*a),this.j(),this}},{key:"setFromUnitVectors",value:function(t,i){var e=t.dot(i)+1;return e<Number.EPSILON?(e=0,Math.abs(t.x)>Math.abs(t.z)?(this.k=-t.y,this.A=t.x,this.M=0):(this.k=0,this.A=-t.z,this.M=t.y)):(this.k=t.y*i.z-t.z*i.y,this.A=t.z*i.x-t.x*i.z,this.M=t.x*i.y-t.y*i.x),this.S=e,this.normalize()}},{key:"angleTo",value:function(t){return 2*Math.acos(Math.abs(p(this.dot(t),-1,1)))}},{key:"rotateTowards",value:function(t,i){var e=this.angleTo(t);return 0!==e&&(i=Math.min(1,i/e),this.slerp(t,i)),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this.k*=-1,this.A*=-1,this.M*=-1,this.j(),this}},{key:"dot",value:function(t){return this.k*t.k+this.A*t.A+this.M*t.M+this.S*t.S}},{key:"lengthSq",value:function(){return this.k*this.k+this.A*this.A+this.M*this.M+this.S*this.S}},{key:"length",value:function(){return Math.sqrt(this.k*this.k+this.A*this.A+this.M*this.M+this.S*this.S)}},{key:"normalize",value:function(){var t=this.length();return 0===t?(this.k=0,this.A=0,this.M=0,this.S=1):(this.k=this.k*(t=1/t),this.A=this.A*t,this.M=this.M*t,this.S=this.S*t),this.j(),this}},{key:"multiply",value:function(t){return this.multiplyQuaternions(this,t)}},{key:"premultiply",value:function(t){return this.multiplyQuaternions(t,this)}},{key:"multiplyQuaternions",value:function(t,i){var e=t.k,n=t.A,r=t.M,t=t.S,s=i.k,o=i.A,h=i.M,i=i.S;return this.k=e*i+t*s+n*h-r*o,this.A=n*i+t*o+r*s-e*h,this.M=r*i+t*h+e*o-n*s,this.S=t*i-e*s-n*o-r*h,this.j(),this}},{key:"slerp",value:function(t,i){if(0!==i){if(1===i)return this.copy(t);var e,n=this.k,r=this.A,s=this.M,o=this.S,h=o*t.S+n*t.k+r*t.A+s*t.M;h<0?(this.S=-t.S,this.k=-t.k,this.A=-t.A,this.M=-t.M,h=-h):this.copy(t),1<=h?(this.S=o,this.k=n,this.A=r,this.M=s):(t=1-h*h)<=Number.EPSILON?(this.S=(e=1-i)*o+i*this.S,this.k=e*n+i*this.k,this.A=e*r+i*this.A,this.M=e*s+i*this.M,this.normalize()):(e=Math.sqrt(t),t=Math.atan2(e,h),h=Math.sin((1-i)*t)/e,i=Math.sin(i*t)/e,this.S=o*h+this.S*i,this.k=n*h+this.k*i,this.A=r*h+this.A*i,this.M=s*h+this.M*i,this.j())}return this}},{key:"slerpQuaternions",value:function(t,i,e){return this.copy(t).slerp(i,e)}},{key:"random",value:function(){var t=2*Math.PI*Math.random(),i=2*Math.PI*Math.random(),e=Math.random(),n=Math.sqrt(1-e),e=Math.sqrt(e);return this.set(n*Math.sin(t),n*Math.cos(t),e*Math.sin(i),e*Math.cos(i))}},{key:"equals",value:function(t){return t.k===this.k&&t.A===this.A&&t.M===this.M&&t.S===this.S}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.k=t[i],this.A=t[i+1],this.M=t[i+2],this.S=t[i+3],this.j(),this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.k,t[i+1]=this.A,t[i+2]=this.M,t[i+3]=this.S,t}},{key:"fromBufferAttribute",value:function(t,i){return this.k=t.getX(i),this.A=t.getY(i),this.M=t.getZ(i),this.S=t.getW(i),this.j(),this}},{key:"toJSON",value:function(){return this.toArray()}},{key:"_onChange",value:function(t){return this.j=t,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:J().mark(function t(){return J().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.k;case 2:return t.next=4,this.A;case 4:return t.next=6,this.M;case 6:return t.next=8,this.S;case 8:case"end":return t.stop()}},t,this)})}],e=[{key:"slerpFlat",value:function(t,i,e,n,r,s,o){var h,u,a,f=e[n+0],l=e[n+1],c=e[n+2],e=e[n+3],n=r[s+0],v=r[s+1],y=r[s+2],r=r[s+3];0===o?(t[i+0]=f,t[i+1]=l,t[i+2]=c,t[i+3]=e):1===o?(t[i+0]=n,t[i+1]=v,t[i+2]=y,t[i+3]=r):(e===r&&f===n&&l===v&&c===y||(s=1-o,h=0<=(u=f*n+l*v+c*y+e*r)?1:-1,(a=1-u*u)>Number.EPSILON&&(a=Math.sqrt(a),u=Math.atan2(a,u*h),s=Math.sin(s*u)/a,o=Math.sin(o*u)/a),f=f*s+n*(u=o*h),l=l*s+v*u,c=c*s+y*u,e=e*s+r*u,s===1-o&&(f*=a=1/Math.sqrt(f*f+l*l+c*c+e*e),l*=a,c*=a,e*=a)),t[i]=f,t[i+1]=l,t[i+2]=c,t[i+3]=e)}},{key:"multiplyQuaternionsFlat",value:function(t,i,e,n,r,s){var o=e[n],h=e[n+1],u=e[n+2],e=e[n+3],n=r[s],a=r[s+1],f=r[s+2],r=r[s+3];return t[i]=o*r+e*n+h*f-u*a,t[i+1]=h*r+e*a+u*n-o*f,t[i+2]=u*r+e*f+o*a-h*n,t[i+3]=e*r-o*n-h*a-u*f,t}}],i&&Z(t.prototype,i),e&&Z(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,e})();function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function X(){X=function(){return o};var u,o={},t=Object.prototype,a=t.hasOwnProperty,f=Object.defineProperty||function(t,i,e){t[i]=e.value},i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",e=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function s(t,i,e){return Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[i]}try{s({},"")}catch(u){s=function(t,i,e){return t[i]=e}}function h(t,i,e,n){var r,s,o,h,i=i&&i.prototype instanceof p?i:p,i=Object.create(i.prototype),n=new E(n||[]);return f(i,"_invoke",{value:(r=t,s=e,o=n,h=c,function(t,i){if(h===y)throw Error("Generator is already running");if(h===d){if("throw"===t)throw i;return{value:u,done:!0}}for(o.method=t,o.arg=i;;){var e=o.delegate;if(e){e=function t(i,e){var n=e.method,r=i.iterator[n];if(r===u)return e.delegate=null,"throw"===n&&i.iterator.return&&(e.method="return",e.arg=u,t(i,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;n=l(r,i.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,b;r=n.arg;return r?r.done?(e[i.resultName]=r.value,e.next=i.nextLoc,"return"!==e.method&&(e.method="next",e.arg=u),e.delegate=null,b):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b)}(e,o);if(e){if(e===b)continue;return e}}if("next"===o.method)o.sent=o.u=o.arg;else if("throw"===o.method){if(h===c)throw h=d,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);h=y;e=l(r,s,o);if("normal"===e.type){if(h=o.done?d:v,e.arg===b)continue;return{value:e.arg,done:o.done}}"throw"===e.type&&(h=d,o.method="throw",o.arg=e.arg)}})}),i}function l(t,i,e){try{return{type:"normal",arg:t.call(i,e)}}catch(t){return{type:"throw",arg:t}}}o.wrap=h;var c="suspendedStart",v="suspendedYield",y="executing",d="completed",b={};function p(){}function m(){}function w(){}var i={},k=(s(i,n,function(){return this}),Object.getPrototypeOf),k=k&&k(k(O([]))),g=(k&&k!==t&&a.call(k,n)&&(i=k),w.prototype=p.prototype=Object.create(i));function A(t){["next","throw","return"].forEach(function(i){s(t,i,function(t){return this._invoke(i,t)})})}function M(o,h){var i;f(this,"_invoke",{value:function(e,n){function t(){return new h(function(t,i){!function i(t,e,n,r){var s,t=l(o[t],o,e);if("throw"!==t.type)return(e=(s=t.arg).value)&&"object"==Q(e)&&a.call(e,"__await")?h.resolve(e.v).then(function(t){i("next",t,n,r)},function(t){i("throw",t,n,r)}):h.resolve(e).then(function(t){s.value=t,n(s)},function(t){return i("throw",t,n,r)});r(t.arg)}(e,n,t,i)})}return i=i?i.then(t,t):t()}})}function S(t){var i={tryLoc:t[0]};1 in t&&(i.catchLoc=t[1]),2 in t&&(i.finallyLoc=t[2],i.afterLoc=t[3]),this.tryEntries.push(i)}function j(t){var i=t.completion||{};i.type="normal",delete i.arg,t.completion=i}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function O(i){if(i||""===i){var e,t=i[n];if(t)return t.call(i);if("function"==typeof i.next)return i;if(!isNaN(i.length))return e=-1,(t=function t(){for(;++e<i.length;)if(a.call(i,e))return t.value=i[e],t.done=!1,t;return t.value=u,t.done=!0,t}).next=t}throw new TypeError(Q(i)+" is not iterable")}return f(g,"constructor",{value:m.prototype=w,configurable:!0}),f(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,r,"GeneratorFunction"),o.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,r,"GeneratorFunction")),t.prototype=Object.create(g),t},o.awrap=function(t){return{v:t}},A(M.prototype),s(M.prototype,e,function(){return this}),o.AsyncIterator=M,o.async=function(t,i,e,n,r){void 0===r&&(r=Promise);var s=new M(h(t,i,e,n),r);return o.isGeneratorFunction(i)?s:s.next().then(function(t){return t.done?t.value:s.next()})},A(g),s(g,r,"Generator"),s(g,n,function(){return this}),s(g,"toString",function(){return"[object Generator]"}),o.keys=function(t){var i,e=Object(t),n=[];for(i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},o.values=O,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this.u=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(j),!t)for(var i in this)"t"===i.charAt(0)&&a.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function t(t,i){return s.type="throw",s.arg=e,n.next=t,i&&(n.method="next",n.arg=u),!!i}for(var i=this.tryEntries.length-1;0<=i;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var o=a.call(r,"catchLoc"),h=a.call(r,"finallyLoc");if(o&&h){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!h)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,i){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}var s=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=i&&i<=r.finallyLoc?null:r)?r.completion:{};return s.type=t,s.arg=i,r?(this.method="next",this.next=r.finallyLoc,b):this.complete(s)},complete:function(t,i){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&i&&(this.next=i),b},finish:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var e=this.tryEntries[i];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),j(e),b}},catch:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var e,n,r=this.tryEntries[i];if(r.tryLoc===t)return"throw"===(e=r.completion).type&&(n=e.arg,j(r)),n}throw Error("illegal catch attempt")},delegateYield:function(t,i,e){return this.delegate={iterator:O(t),resultName:i,nextLoc:e},"next"===this.method&&(this.arg=u),b}},o}function z(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=Q(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Q(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Q(t)?t:t+""))(n.key),n)}}var U=(()=>{function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,n=this,r=s;if(!(n instanceof r))throw new TypeError("Cannot call a class as a function");s.prototype.isVector3=!0,this.x=t,this.y=i,this.z=e}return t=s,(i=[{key:"set",value:function(t,i,e){return void 0===e&&(e=this.z),this.x=t,this.y=i,this.z=e,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this.z=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setZ",value:function(t){return this.z=t,this}},{key:"setComponent",value:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this}},{key:"addVectors",value:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this}},{key:"addScaledVector",value:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this.z-=t,this}},{key:"subVectors",value:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"multiplyVectors",value:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this}},{key:"applyEuler",value:function(t){return this.applyQuaternion(W.setFromEuler(t))}},{key:"applyAxisAngle",value:function(t,i){return this.applyQuaternion(W.setFromAxisAngle(t,i))}},{key:"applyMatrix3",value:function(t){var i=this.x,e=this.y,n=this.z,t=t.elements;return this.x=t[0]*i+t[3]*e+t[6]*n,this.y=t[1]*i+t[4]*e+t[7]*n,this.z=t[2]*i+t[5]*e+t[8]*n,this}},{key:"applyNormalMatrix",value:function(t){return this.applyMatrix3(t).normalize()}},{key:"applyMatrix4",value:function(t){var i=this.x,e=this.y,n=this.z,t=t.elements,r=1/(t[3]*i+t[7]*e+t[11]*n+t[15]);return this.x=(t[0]*i+t[4]*e+t[8]*n+t[12])*r,this.y=(t[1]*i+t[5]*e+t[9]*n+t[13])*r,this.z=(t[2]*i+t[6]*e+t[10]*n+t[14])*r,this}},{key:"applyQuaternion",value:function(t){var i=this.x,e=this.y,n=this.z,r=t.x,s=t.y,o=t.z,t=t.w,h=2*(s*n-o*e),u=2*(o*i-r*n),a=2*(r*e-s*i);return this.x=i+t*h+s*a-o*u,this.y=e+t*u+o*h-r*a,this.z=n+t*a+r*u-s*h,this}},{key:"project",value:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}},{key:"unproject",value:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}},{key:"transformDirection",value:function(t){var i=this.x,e=this.y,n=this.z,t=t.elements;return this.x=t[0]*i+t[4]*e+t[8]*n,this.y=t[1]*i+t[5]*e+t[9]*n,this.z=t[2]*i+t[6]*e+t[10]*n,this.normalize()}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}},{key:"clamp",value:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this}},{key:"clampScalar",value:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this}},{key:"clampLength",value:function(t,i){var e=this.length();return this.divideScalar(e||1).multiplyScalar(Math.max(t,Math.min(i,e)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this}},{key:"lerpVectors",value:function(t,i,e){return this.x=t.x+(i.x-t.x)*e,this.y=t.y+(i.y-t.y)*e,this.z=t.z+(i.z-t.z)*e,this}},{key:"cross",value:function(t){return this.crossVectors(this,t)}},{key:"crossVectors",value:function(t,i){var e=t.x,n=t.y,t=t.z,r=i.x,s=i.y,i=i.z;return this.x=n*i-t*s,this.y=t*r-e*i,this.z=e*s-n*r,this}},{key:"projectOnVector",value:function(t){var i=t.lengthSq();return 0===i?this.set(0,0,0):(i=t.dot(this)/i,this.copy(t).multiplyScalar(i))}},{key:"projectOnPlane",value:function(t){return K.copy(this).projectOnVector(t),this.sub(K)}},{key:"reflect",value:function(t){return this.sub(K.copy(t).multiplyScalar(2*this.dot(t)))}},{key:"angleTo",value:function(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===i?Math.PI/2:(t=this.dot(t)/i,Math.acos(p(t,-1,1)))}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var i=this.x-t.x,e=this.y-t.y,t=this.z-t.z;return i*i+e*e+t*t}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}},{key:"setFromSpherical",value:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}},{key:"setFromSphericalCoords",value:function(t,i,e){var n=Math.sin(i)*t;return this.x=n*Math.sin(e),this.y=Math.cos(i)*t,this.z=n*Math.cos(e),this}},{key:"setFromCylindrical",value:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}},{key:"setFromCylindricalCoords",value:function(t,i,e){return this.x=t*Math.sin(i),this.y=e,this.z=t*Math.cos(i),this}},{key:"setFromMatrixPosition",value:function(t){t=t.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(t){var i=this.setFromMatrixColumn(t,0).length(),e=this.setFromMatrixColumn(t,1).length(),t=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=e,this.z=t,this}},{key:"setFromMatrixColumn",value:function(t,i){return this.fromArray(t.elements,4*i)}},{key:"setFromMatrix3Column",value:function(t,i){return this.fromArray(t.elements,3*i)}},{key:"setFromEuler",value:function(t){return this.x=t.k,this.y=t.A,this.z=t.M,this}},{key:"setFromColor",value:function(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t}},{key:"fromBufferAttribute",value:function(t,i){return this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomDirection",value:function(){var t=Math.random()*Math.PI*2,i=2*Math.random()-1,e=Math.sqrt(1-i*i);return this.x=e*Math.cos(t),this.y=i,this.z=e*Math.sin(t),this}},{key:Symbol.iterator,value:X().mark(function t(){return X().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.x;case 2:return t.next=4,this.y;case 4:return t.next=6,this.z;case 6:case"end":return t.stop()}},t,this)})}])&&z(t.prototype,i),e&&z(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,e})(),K=new U,W=new H,t="srgb-linear",i="display-p3-linear",q="linear",$=7680;function tt(t){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function it(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=tt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=tt(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==tt(t)?t:t+""))(n.key),n)}}var m=(()=>{function b(t,i,e,n,r,s,o,h,u,a,f,l,c,v,y,d){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");b.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,i,e,n,r,s,o,h,u,a,f,l,c,v,y,d)}return t=b,(i=[{key:"set",value:function(t,i,e,n,r,s,o,h,u,a,f,l,c,v,y,d){var b=this.elements;return b[0]=t,b[4]=i,b[8]=e,b[12]=n,b[1]=r,b[5]=s,b[9]=o,b[13]=h,b[2]=u,b[6]=a,b[10]=f,b[14]=l,b[3]=c,b[7]=v,b[11]=y,b[15]=d,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new b).fromArray(this.elements)}},{key:"copy",value:function(t){var i=this.elements,t=t.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],i[9]=t[9],i[10]=t[10],i[11]=t[11],i[12]=t[12],i[13]=t[13],i[14]=t[14],i[15]=t[15],this}},{key:"copyPosition",value:function(t){var i=this.elements,t=t.elements;return i[12]=t[12],i[13]=t[13],i[14]=t[14],this}},{key:"setFromMatrix3",value:function(t){t=t.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(t,i,e){return t.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),e.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(t,i,e){return this.set(t.x,i.x,e.x,0,t.y,i.y,e.y,0,t.z,i.z,e.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(t){var i=this.elements,e=t.elements,n=1/et.setFromMatrixColumn(t,0).length(),r=1/et.setFromMatrixColumn(t,1).length(),t=1/et.setFromMatrixColumn(t,2).length();return i[0]=e[0]*n,i[1]=e[1]*n,i[2]=e[2]*n,i[3]=0,i[4]=e[4]*r,i[5]=e[5]*r,i[6]=e[6]*r,i[7]=0,i[8]=e[8]*t,i[9]=e[9]*t,i[10]=e[10]*t,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}},{key:"makeRotationFromEuler",value:function(t){var i,e,n,r,s=this.elements,o=t.x,h=t.y,u=t.z,a=Math.cos(o),o=Math.sin(o),f=Math.cos(h),h=Math.sin(h),l=Math.cos(u),u=Math.sin(u);return"XYZ"===t.order?(e=a*l,n=a*u,r=o*l,i=o*u,s[0]=f*l,s[4]=-f*u,s[8]=h,s[1]=n+r*h,s[5]=e-i*h,s[9]=-o*f,s[2]=i-e*h,s[6]=r+n*h,s[10]=a*f):"YXZ"===t.order?(i=f*u,e=h*l,s[0]=(r=f*l)+(n=h*u)*o,s[4]=e*o-i,s[8]=a*h,s[1]=a*u,s[5]=a*l,s[9]=-o,s[2]=i*o-e,s[6]=n+r*o,s[10]=a*f):"ZXY"===t.order?(i=f*u,e=h*l,s[0]=(n=f*l)-(r=h*u)*o,s[4]=-a*u,s[8]=e+i*o,s[1]=i+e*o,s[5]=a*l,s[9]=r-n*o,s[2]=-a*h,s[6]=o,s[10]=a*f):"ZYX"===t.order?(i=a*l,e=a*u,r=o*l,n=o*u,s[0]=f*l,s[4]=r*h-e,s[8]=i*h+n,s[1]=f*u,s[5]=n*h+i,s[9]=e*h-r,s[2]=-h,s[6]=o*f,s[10]=a*f):"YZX"===t.order?(n=a*f,i=a*h,e=o*f,r=o*h,s[0]=f*l,s[4]=r-n*u,s[8]=e*u+i,s[1]=u,s[5]=a*l,s[9]=-o*l,s[2]=-h*l,s[6]=i*u+e,s[10]=n-r*u):"XZY"===t.order&&(i=a*f,e=a*h,n=o*f,r=o*h,s[0]=f*l,s[4]=-u,s[8]=h*l,s[1]=i*u+r,s[5]=a*l,s[9]=e*u-n,s[2]=n*u-e,s[6]=o*l,s[10]=r*u+i),s[3]=0,s[7]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(t){return this.compose(nt,t,rt)}},{key:"lookAt",value:function(t,i,e){var n=this.elements;return h.subVectors(t,i),0===h.lengthSq()&&(h.z=1),h.normalize(),o.crossVectors(e,h),0===o.lengthSq()&&(1===Math.abs(e.z)?h.x+=1e-4:h.z+=1e-4,h.normalize(),o.crossVectors(e,h)),o.normalize(),st.crossVectors(h,o),n[0]=o.x,n[4]=st.x,n[8]=h.x,n[1]=o.y,n[5]=st.y,n[9]=h.y,n[2]=o.z,n[6]=st.z,n[10]=h.z,this}},{key:"multiply",value:function(t){return this.multiplyMatrices(this,t)}},{key:"premultiply",value:function(t){return this.multiplyMatrices(t,this)}},{key:"multiplyMatrices",value:function(t,i){var t=t.elements,i=i.elements,e=this.elements,n=t[0],r=t[4],s=t[8],o=t[12],h=t[1],u=t[5],a=t[9],f=t[13],l=t[2],c=t[6],v=t[10],y=t[14],d=t[3],b=t[7],p=t[11],t=t[15],m=i[0],w=i[4],k=i[8],g=i[12],A=i[1],M=i[5],S=i[9],j=i[13],E=i[2],O=i[6],x=i[10],R=i[14],T=i[3],I=i[7],C=i[11],i=i[15];return e[0]=n*m+r*A+s*E+o*T,e[4]=n*w+r*M+s*O+o*I,e[8]=n*k+r*S+s*x+o*C,e[12]=n*g+r*j+s*R+o*i,e[1]=h*m+u*A+a*E+f*T,e[5]=h*w+u*M+a*O+f*I,e[9]=h*k+u*S+a*x+f*C,e[13]=h*g+u*j+a*R+f*i,e[2]=l*m+c*A+v*E+y*T,e[6]=l*w+c*M+v*O+y*I,e[10]=l*k+c*S+v*x+y*C,e[14]=l*g+c*j+v*R+y*i,e[3]=d*m+b*A+p*E+t*T,e[7]=d*w+b*M+p*O+t*I,e[11]=d*k+b*S+p*x+t*C,e[15]=d*g+b*j+p*R+t*i,this}},{key:"multiplyScalar",value:function(t){var i=this.elements;return i[0]*=t,i[4]*=t,i[8]*=t,i[12]*=t,i[1]*=t,i[5]*=t,i[9]*=t,i[13]*=t,i[2]*=t,i[6]*=t,i[10]*=t,i[14]*=t,i[3]*=t,i[7]*=t,i[11]*=t,i[15]*=t,this}},{key:"determinant",value:function(){var t=this.elements,i=t[0],e=t[4],n=t[8],r=t[12],s=t[1],o=t[5],h=t[9],u=t[13],a=t[2],f=t[6],l=t[10],c=t[14];return t[3]*(+r*h*f-n*u*f-r*o*l+e*u*l+n*o*c-e*h*c)+t[7]*(+i*h*c-i*u*l+r*s*l-n*s*c+n*u*a-r*h*a)+t[11]*(+i*u*f-i*o*c-r*s*f+e*s*c+r*o*a-e*u*a)+t[15]*(-n*o*a-i*h*f+i*o*l+n*s*f-e*s*l+e*h*a)}},{key:"transpose",value:function(){var t=this.elements,i=t[1];return t[1]=t[4],t[4]=i,i=t[2],t[2]=t[8],t[8]=i,i=t[6],t[6]=t[9],t[9]=i,i=t[3],t[3]=t[12],t[12]=i,i=t[7],t[7]=t[13],t[13]=i,i=t[11],t[11]=t[14],t[14]=i,this}},{key:"setPosition",value:function(t,i,e){var n=this.elements;return t.isVector3?(n[12]=t.x,n[13]=t.y,n[14]=t.z):(n[12]=t,n[13]=i,n[14]=e),this}},{key:"invert",value:function(){var t=this.elements,i=t[0],e=t[1],n=t[2],r=t[3],s=t[4],o=t[5],h=t[6],u=t[7],a=t[8],f=t[9],l=t[10],c=t[11],v=t[12],y=t[13],d=t[14],b=t[15],p=f*d*u-y*l*u+y*h*c-o*d*c-f*h*b+o*l*b,m=v*l*u-a*d*u-v*h*c+s*d*c+a*h*b-s*l*b,w=a*y*u-v*f*u+v*o*c-s*y*c-a*o*b+s*f*b,k=v*f*h-a*y*h-v*o*l+s*y*l+a*o*d-s*f*d,g=i*p+e*m+n*w+r*k;return 0==g?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(t[0]=p*(p=1/g),t[1]=(y*l*r-f*d*r-y*n*c+e*d*c+f*n*b-e*l*b)*p,t[2]=(o*d*r-y*h*r+y*n*u-e*d*u-o*n*b+e*h*b)*p,t[3]=(f*h*r-o*l*r-f*n*u+e*l*u+o*n*c-e*h*c)*p,t[4]=m*p,t[5]=(a*d*r-v*l*r+v*n*c-i*d*c-a*n*b+i*l*b)*p,t[6]=(v*h*r-s*d*r-v*n*u+i*d*u+s*n*b-i*h*b)*p,t[7]=(s*l*r-a*h*r+a*n*u-i*l*u-s*n*c+i*h*c)*p,t[8]=w*p,t[9]=(v*f*r-a*y*r-v*e*c+i*y*c+a*e*b-i*f*b)*p,t[10]=(s*y*r-v*o*r+v*e*u-i*y*u-s*e*b+i*o*b)*p,t[11]=(a*o*r-s*f*r-a*e*u+i*f*u+s*e*c-i*o*c)*p,t[12]=k*p,t[13]=(a*y*n-v*f*n+v*e*l-i*y*l-a*e*d+i*f*d)*p,t[14]=(v*o*n-s*y*n-v*e*h+i*y*h+s*e*d-i*o*d)*p,t[15]=(s*f*n-a*o*n+a*e*h-i*f*h-s*e*l+i*o*l)*p,this)}},{key:"scale",value:function(t){var i=this.elements,e=t.x,n=t.y,t=t.z;return i[0]*=e,i[4]*=n,i[8]*=t,i[1]*=e,i[5]*=n,i[9]*=t,i[2]*=e,i[6]*=n,i[10]*=t,i[3]*=e,i[7]*=n,i[11]*=t,this}},{key:"getMaxScaleOnAxis",value:function(){var t=this.elements,i=t[0]*t[0]+t[1]*t[1]+t[2]*t[2];return Math.sqrt(Math.max(i,t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))}},{key:"makeTranslation",value:function(t,i,e){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,i,0,0,1,e,0,0,0,1),this}},{key:"makeRotationX",value:function(t){var i=Math.cos(t),t=Math.sin(t);return this.set(1,0,0,0,0,i,-t,0,0,t,i,0,0,0,0,1),this}},{key:"makeRotationY",value:function(t){var i=Math.cos(t),t=Math.sin(t);return this.set(i,0,t,0,0,1,0,0,-t,0,i,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(t){var i=Math.cos(t),t=Math.sin(t);return this.set(i,-t,0,0,t,i,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(t,i){var e=Math.cos(i),i=Math.sin(i),n=1-e,r=t.x,s=t.y,t=t.z,o=n*r,h=n*s;return this.set(o*r+e,o*s-i*t,o*t+i*s,0,o*s+i*t,h*s+e,h*t-i*r,0,o*t-i*s,h*t+i*r,n*t*t+e,0,0,0,0,1),this}},{key:"makeScale",value:function(t,i,e){return this.set(t,0,0,0,0,i,0,0,0,0,e,0,0,0,0,1),this}},{key:"makeShear",value:function(t,i,e,n,r,s){return this.set(1,e,r,0,t,1,s,0,i,n,1,0,0,0,0,1),this}},{key:"compose",value:function(t,i,e){var n=this.elements,r=i.k,s=i.A,o=i.M,i=i.S,h=r+r,u=s+s,a=o+o,f=r*h,l=r*u,r=r*a,c=s*u,s=s*a,o=o*a,h=i*h,u=i*u,i=i*a,a=e.x,v=e.y,e=e.z;return n[0]=(1-(c+o))*a,n[1]=(l+i)*a,n[2]=(r-u)*a,n[3]=0,n[4]=(l-i)*v,n[5]=(1-(f+o))*v,n[6]=(s+h)*v,n[7]=0,n[8]=(r+u)*e,n[9]=(s-h)*e,n[10]=(1-(f+c))*e,n[11]=0,n[12]=t.x,n[13]=t.y,n[14]=t.z,n[15]=1,this}},{key:"decompose",value:function(t,i,e){var n=this.elements,r=et.set(n[0],n[1],n[2]).length(),s=et.set(n[4],n[5],n[6]).length(),o=et.set(n[8],n[9],n[10]).length(),t=(this.determinant()<0&&(r=-r),t.x=n[12],t.y=n[13],t.z=n[14],u.copy(this),1/r),n=1/s,h=1/o;return u.elements[0]*=t,u.elements[1]*=t,u.elements[2]*=t,u.elements[4]*=n,u.elements[5]*=n,u.elements[6]*=n,u.elements[8]*=h,u.elements[9]*=h,u.elements[10]*=h,i.setFromRotationMatrix(u),e.x=r,e.y=s,e.z=o,this}},{key:"makePerspective",value:function(t,i,e,n,r,s){var o,h,u=6<arguments.length&&void 0!==arguments[6]?arguments[6]:2e3,a=this.elements,f=2*r/(i-t),l=2*r/(e-n),i=(i+t)/(i-t),t=(e+n)/(e-n);if(2e3===u)o=-(s+r)/(s-r),h=-2*s*r/(s-r);else{if(2001!==u)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+u);o=-s/(s-r),h=-s*r/(s-r)}return a[0]=f,a[4]=0,a[8]=i,a[12]=0,a[1]=0,a[5]=l,a[9]=t,a[13]=0,a[2]=0,a[6]=0,a[10]=o,a[14]=h,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this}},{key:"makeOrthographic",value:function(t,i,e,n,r,s){var o,h,u=6<arguments.length&&void 0!==arguments[6]?arguments[6]:2e3,a=this.elements,f=1/(i-t),l=1/(e-n),c=1/(s-r),i=(i+t)*f,t=(e+n)*l;if(2e3===u)o=(s+r)*c,h=-2*c;else{if(2001!==u)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+u);o=r*c,h=-1*c}return a[0]=2*f,a[4]=0,a[8]=0,a[12]=-i,a[1]=0,a[5]=2*l,a[9]=0,a[13]=-t,a[2]=0,a[6]=0,a[10]=h,a[14]=-o,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this}},{key:"equals",value:function(t){for(var i=this.elements,e=t.elements,n=0;n<16;n++)if(i[n]!==e[n])return!1;return!0}},{key:"fromArray",value:function(t){for(var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=0;e<16;e++)this.elements[e]=t[e+i];return this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=this.elements;return t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3],t[i+4]=e[4],t[i+5]=e[5],t[i+6]=e[6],t[i+7]=e[7],t[i+8]=e[8],t[i+9]=e[9],t[i+10]=e[10],t[i+11]=e[11],t[i+12]=e[12],t[i+13]=e[13],t[i+14]=e[14],t[i+15]=e[15],t}}])&&it(t.prototype,i),e&&it(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,e})(),et=new U,u=new m,nt=new U(0,0,0),rt=new U(1,1,1),o=new U,st=new U,h=new U;function ot(t){return(ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ht(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=ot(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=ot(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==ot(t)?t:t+""))(n.key),n)}}var ut=(()=>{function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.type="Curve",this.arcLengthDivisions=200}return i=t,(e=[{key:"getPoint",value:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}},{key:"getPointAt",value:function(t,i){t=this.getUtoTmapping(t);return this.getPoint(t,i)}},{key:"getPoints",value:function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,i=[],e=0;e<=t;e++)i.push(this.getPoint(e/t));return i}},{key:"getSpacedPoints",value:function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:5,i=[],e=0;e<=t;e++)i.push(this.getPointAt(e/t));return i}},{key:"getLength",value:function(){var t=this.getLengths();return t[t.length-1]}},{key:"getLengths",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.arcLengthDivisions;if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i,e=[],n=this.getPoint(0),r=0;e.push(0);for(var s=1;s<=t;s++)r+=(i=this.getPoint(s/t)).distanceTo(n),e.push(r),n=i;return this.cacheArcLengths=e}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.getLengths()}},{key:"getUtoTmapping",value:function(t,i){for(var e,n=this.getLengths(),r=0,s=n.length,o=i||t*n[s-1],h=0,u=s-1;h<=u;)if((e=n[r=Math.floor(h+(u-h)/2)]-o)<0)h=r+1;else{if(!(0<e)){u=r;break}u=r-1}return n[r=u]===o?r/(s-1):(r+(o-(i=n[r]))/(n[r+1]-i))/(s-1)}},{key:"getTangent",value:function(t,i){var e=t-1e-4,t=t+1e-4,e=(1<t&&(t=1),this.getPoint(e=e<0?0:e)),t=this.getPoint(t),i=i||new(e.isVector2?G:U);return i.copy(t).sub(e).normalize(),i}},{key:"getTangentAt",value:function(t,i){t=this.getUtoTmapping(t);return this.getTangent(t,i)}},{key:"computeFrenetFrames",value:function(t,i){for(var e=new U,n=[],r=[],s=[],o=new U,h=new m,u=0;u<=t;u++)n[u]=this.getTangentAt(u/t,new U);r[0]=new U,s[0]=new U;var a=Number.MAX_VALUE,f=Math.abs(n[0].x),l=Math.abs(n[0].y),c=Math.abs(n[0].z);f<=a&&(a=f,e.set(1,0,0)),l<=a&&(a=l,e.set(0,1,0)),c<=a&&e.set(0,0,1),o.crossVectors(n[0],e).normalize(),r[0].crossVectors(n[0],o),s[0].crossVectors(n[0],r[0]);for(var v,y=1;y<=t;y++)r[y]=r[y-1].clone(),s[y]=s[y-1].clone(),o.crossVectors(n[y-1],n[y]),o.length()>Number.EPSILON&&(o.normalize(),v=Math.acos(p(n[y-1].dot(n[y]),-1,1)),r[y].applyMatrix4(h.makeRotationAxis(o,v))),s[y].crossVectors(n[y],r[y]);if(!0===i){var d=Math.acos(p(r[0].dot(r[t]),-1,1));d/=t,0<n[0].dot(o.crossVectors(r[0],r[t]))&&(d=-d);for(var b=1;b<=t;b++)r[b].applyMatrix4(h.makeRotationAxis(n[b],d*b)),s[b].crossVectors(n[b],r[b])}return{tangents:n,normals:r,binormals:s}}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}},{key:"toJSON",value:function(){var t={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}},{key:"fromJSON",value:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}])&&ht(i.prototype,e),n&&ht(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,e,n})();function at(t){return(at="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ft(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=at(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=at(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==at(t)?t:t+""))(n.key),n)}}function lt(t,i,e){i=dt(i);var n=t,i=ct()?Reflect.construct(i,e||[],dt(t).constructor):i.apply(t,e);if(!i||"object"!=at(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=n))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function ct(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ct=function(){return!!t})()}function vt(t,i,e,n){var r=yt(dt(1&n?t.prototype:t),i,e);return 2&n&&"function"==typeof r?function(t){return r.apply(e,t)}:r}function yt(){return(yt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,e){var n=((t,i)=>{for(;!{}.hasOwnProperty.call(t,i)&&null!==(t=dt(t)););return t})(t,i);if(n)return(n=Object.getOwnPropertyDescriptor(n,i)).get?n.get.call(arguments.length<3?t:e):n.value}).apply(null,arguments)}function dt(t){return(dt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function bt(t,i){return(bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}var pt=(()=>{function f(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,r=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,s=5<arguments.length&&void 0!==arguments[5]?arguments[5]:2*Math.PI,o=6<arguments.length&&void 0!==arguments[6]&&arguments[6],h=7<arguments.length&&void 0!==arguments[7]?arguments[7]:0,u=this,a=f;if(u instanceof a)return(u=lt(this,f)).isEllipseCurve=!0,u.type="EllipseCurve",u.aX=t,u.aY=i,u.xRadius=e,u.yRadius=n,u.aStartAngle=r,u.aEndAngle=s,u.aClockwise=o,u.aRotation=h,u;throw new TypeError("Cannot call a class as a function")}var t,i=f,e=ut;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");return i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&bt(i,e),i=f,(e=[{key:"getPoint",value:function(t){for(var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new G,e=2*Math.PI,n=this.aEndAngle-this.aStartAngle,r=Math.abs(n)<Number.EPSILON;n<0;)n+=e;for(;e<n;)n-=e;n<Number.EPSILON&&(n=r?0:e),!0!==this.aClockwise||r||(n===e?n=-e:n-=e);var s,o,h,u,r=this.aStartAngle+t*n,t=this.aX+this.xRadius*Math.cos(r),r=this.aY+this.yRadius*Math.sin(r);return 0!==this.aRotation&&(s=Math.cos(this.aRotation),o=Math.sin(this.aRotation),t=(h=t-this.aX)*s-(u=r-this.aY)*o+this.aX,r=h*o+u*s+this.aY),i.set(t,r)}},{key:"copy",value:function(t){return vt(f,"copy",this,3)([t]),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}},{key:"toJSON",value:function(){var t=vt(f,"toJSON",this,3)([]);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}},{key:"fromJSON",value:function(t){return vt(f,"fromJSON",this,3)([t]),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}])&&ft(i.prototype,e),t&&ft(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i})(),mt={FULL:0,DOTTED:2,DOT_DASH:4,CENTER:8,DASH:16,DOUBLE_DOT_DASH:32,TRI_DOT_DASH:64,FMARROW:128,ARROW:256};function wt(t){return(wt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function kt(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=wt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=wt(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==wt(t)?t:t+""))(n.key),n)}}var a=new U,gt=new U,At=new U,l=new U,Mt=new U,St=new U,jt=new U,Et=(()=>{return t=function t(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new U,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new U(0,0,-1),n=this,r=t;if(!(n instanceof r))throw new TypeError("Cannot call a class as a function");this.origin=i,this.direction=e},(i=[{key:"set",value:function(t,i){return this.origin.copy(t),this.direction.copy(i),this}},{key:"copy",value:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}},{key:"at",value:function(t,i){return i.copy(this.origin).addScaledVector(this.direction,t)}},{key:"lookAt",value:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this}},{key:"recast",value:function(t){return this.origin.copy(this.at(t,a)),this}},{key:"closestPointToPoint",value:function(t,i){i.subVectors(t,this.origin);t=i.dot(this.direction);return t<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,t)}},{key:"distanceToPoint",value:function(t){return Math.sqrt(this.distanceSqToPoint(t))}},{key:"distanceSqToPoint",value:function(t){var i=a.subVectors(t,this.origin).dot(this.direction);return(i<0?this.origin:(a.copy(this.origin).addScaledVector(this.direction,i),a)).distanceToSquared(t)}},{key:"distanceSqToSegment",value:function(t,i,e,n){gt.copy(t).add(i).multiplyScalar(.5),At.copy(i).sub(t).normalize(),l.copy(this.origin).sub(gt);var r,s,o,t=.5*t.distanceTo(i),i=-this.direction.dot(At),h=l.dot(this.direction),u=-l.dot(At),a=l.lengthSq(),f=Math.abs(1-i*i);return f=0<f?(s=i*h-u,o=t*f,0<=(r=i*u-h)?-o<=s?s<=o?(r*=f=1/f)*(r+i*(s*=f)+2*h)+s*(i*r+s+2*u)+a:(s=t,-(r=Math.max(0,-(i*s+h)))*r+s*(s+2*u)+a):(s=-t,-(r=Math.max(0,-(i*s+h)))*r+s*(s+2*u)+a):s<=-o?-(r=Math.max(0,-(-i*t+h)))*r+(s=0<r?-t:Math.min(Math.max(-t,-u),t))*(s+2*u)+a:s<=o?(r=0,(s=Math.min(Math.max(-t,-u),t))*(s+2*u)+a):-(r=Math.max(0,-(i*t+h)))*r+(s=0<r?t:Math.min(Math.max(-t,-u),t))*(s+2*u)+a):(s=0<i?-t:t,-(r=Math.max(0,-(i*s+h)))*r+s*(s+2*u)+a),e&&e.copy(this.origin).addScaledVector(this.direction,r),n&&n.copy(gt).addScaledVector(At,s),f}},{key:"intersectSphere",value:function(t,i){a.subVectors(t.center,this.origin);var e=a.dot(this.direction),n=a.dot(a)-e*e,t=t.radius*t.radius;return t<n||(n=e-(t=Math.sqrt(t-n)),(e=e+t)<0)?null:n<0?this.at(e,i):this.at(n,i)}},{key:"intersectsSphere",value:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}},{key:"distanceToPlane",value:function(t){var i=t.normal.dot(this.direction);return 0===i?0===t.distanceToPoint(this.origin)?0:null:0<=(t=-(this.origin.dot(t.normal)+t.constant)/i)?t:null}},{key:"intersectPlane",value:function(t,i){t=this.distanceToPlane(t);return null===t?null:this.at(t,i)}},{key:"intersectsPlane",value:function(t){var i=t.distanceToPoint(this.origin);return 0===i||t.normal.dot(this.direction)*i<0}},{key:"intersectBox",value:function(t,i){var e,n,r,s=1/this.direction.x,o=1/this.direction.y,h=1/this.direction.z,u=this.origin,s=0<=s?(e=(t.min.x-u.x)*s,(t.max.x-u.x)*s):(e=(t.max.x-u.x)*s,(t.min.x-u.x)*s),o=0<=o?(r=(t.min.y-u.y)*o,(t.max.y-u.y)*o):(r=(t.max.y-u.y)*o,(t.min.y-u.y)*o);return o<e||s<r||((e<r||isNaN(e))&&(e=r),(o<s||isNaN(s))&&(s=o),(r=0<=h?(n=(t.min.z-u.z)*h,(t.max.z-u.z)*h):(n=(t.max.z-u.z)*h,(t.min.z-u.z)*h))<e)||s<n||((e<n||e!=e)&&(e=n),(s=r<s||s!=s?r:s)<0)?null:this.at(0<=e?e:s,i)}},{key:"intersectsBox",value:function(t){return null!==this.intersectBox(t,a)}},{key:"intersectTriangle",value:function(t,i,e,n,r){Mt.subVectors(i,t),St.subVectors(e,t),jt.crossVectors(Mt,St);var s,i=this.direction.dot(jt);if(0<i){if(n)return null;s=1}else{if(!(i<0))return null;s=-1,i=-i}l.subVectors(this.origin,t);e=s*this.direction.dot(St.crossVectors(l,St));return e<0||(n=s*this.direction.dot(Mt.cross(l)))<0||i<e+n||(t=-s*l.dot(jt))<0?null:this.at(t/i,r)}},{key:"applyMatrix4",value:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}},{key:"equals",value:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}])&&kt(t.prototype,i),e&&kt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,e})();function Ot(t){return(Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xt(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=Ot(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Ot(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Ot(t)?t:t+""))(n.key),n)}}var Rt=(()=>{function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.mask=1}return i=t,(e=[{key:"set",value:function(t){this.mask=(1<<t|0)>>>0}},{key:"enable",value:function(t){this.mask|=1<<t|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(t){this.mask^=1<<t|0}},{key:"disable",value:function(t){this.mask&=~(1<<t|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(t){return 0!=(this.mask&t.mask)}},{key:"isEnabled",value:function(t){return 0!=(this.mask&(1<<t|0))}}])&&xt(i.prototype,e),n&&xt(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,e,n})();function Tt(t){return(Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function It(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=Tt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Tt(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Tt(t)?t:t+""))(n.key),n)}}var Ct=new m,Bt=(()=>{return t=function t(i,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1/0,s=this,o=t;if(!(s instanceof o))throw new TypeError("Cannot call a class as a function");this.ray=new Et(i,e),this.near=n,this.far=r,this.camera=null,this.layers=new Rt,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}},(i=[{key:"set",value:function(t,i){this.ray.set(t,i)}},{key:"setFromCamera",value:function(t,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}},{key:"setFromXRController",value:function(t){return Ct.identity().extractRotation(t.matrixWorld),this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(Ct),this}},{key:"intersectObject",value:function(t){var i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[];return Pt(t,this,e,i),e.sort(Nt),e}},{key:"intersectObjects",value:function(t){for(var i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],n=0,r=t.length;n<r;n++)Pt(t[n],this,e,i);return e.sort(Nt),e}}])&&It(t.prototype,i),e&&It(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,e})();function Nt(t,i){return t.distance-i.distance}function Pt(t,i,e,n){var r=!0;if(!0===(r=t.layers.test(i.layers)&&!1===t.raycast(i,e)?!1:r)&&!0===n)for(var s=t.children,o=0,h=s.length;o<h;o++)Pt(s[o],i,e,!0)}function Lt(t){return(Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ft(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=Lt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Lt(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Lt(t)?t:t+""))(n.key),n)}}var Dt=(()=>{function a(t,i,e,n,r,s,o,h,u){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");a.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,i,e,n,r,s,o,h,u)}return t=a,(i=[{key:"set",value:function(t,i,e,n,r,s,o,h,u){var a=this.elements;return a[0]=t,a[1]=n,a[2]=o,a[3]=i,a[4]=r,a[5]=h,a[6]=e,a[7]=s,a[8]=u,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(t){var i=this.elements,t=t.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],this}},{key:"extractBasis",value:function(t,i,e){return t.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),e.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(t){t=t.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(t){return this.multiplyMatrices(this,t)}},{key:"premultiply",value:function(t){return this.multiplyMatrices(t,this)}},{key:"multiplyMatrices",value:function(t,i){var t=t.elements,i=i.elements,e=this.elements,n=t[0],r=t[3],s=t[6],o=t[1],h=t[4],u=t[7],a=t[2],f=t[5],t=t[8],l=i[0],c=i[3],v=i[6],y=i[1],d=i[4],b=i[7],p=i[2],m=i[5],i=i[8];return e[0]=n*l+r*y+s*p,e[3]=n*c+r*d+s*m,e[6]=n*v+r*b+s*i,e[1]=o*l+h*y+u*p,e[4]=o*c+h*d+u*m,e[7]=o*v+h*b+u*i,e[2]=a*l+f*y+t*p,e[5]=a*c+f*d+t*m,e[8]=a*v+f*b+t*i,this}},{key:"multiplyScalar",value:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this}},{key:"determinant",value:function(){var t=this.elements,i=t[0],e=t[1],n=t[2],r=t[3],s=t[4],o=t[5],h=t[6],u=t[7],t=t[8];return i*s*t-i*o*u-e*r*t+e*o*h+n*r*u-n*s*h}},{key:"invert",value:function(){var t=this.elements,i=t[0],e=t[1],n=t[2],r=t[3],s=t[4],o=t[5],h=t[6],u=t[7],a=t[8],f=a*s-o*u,l=o*h-a*r,c=u*r-s*h,v=i*f+e*l+n*c;return 0==v?this.set(0,0,0,0,0,0,0,0,0):(t[0]=f*(f=1/v),t[1]=(n*u-a*e)*f,t[2]=(o*e-n*s)*f,t[3]=l*f,t[4]=(a*i-n*h)*f,t[5]=(n*r-o*i)*f,t[6]=c*f,t[7]=(e*h-u*i)*f,t[8]=(s*i-e*r)*f,this)}},{key:"transpose",value:function(){var t=this.elements,i=t[1];return t[1]=t[3],t[3]=i,i=t[2],t[2]=t[6],t[6]=i,i=t[5],t[5]=t[7],t[7]=i,this}},{key:"getNormalMatrix",value:function(t){return this.setFromMatrix4(t).invert().transpose()}},{key:"transposeIntoArray",value:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this}},{key:"setUvTransform",value:function(t,i,e,n,r,s,o){var h=Math.cos(r),r=Math.sin(r);return this.set(e*h,e*r,-e*(h*s+r*o)+s+t,-n*r,n*h,-n*(-r*s+h*o)+o+i,0,0,1),this}},{key:"scale",value:function(t,i){return this.premultiply(Gt.makeScale(t,i)),this}},{key:"rotate",value:function(t){return this.premultiply(Gt.makeRotation(-t)),this}},{key:"translate",value:function(t,i){return this.premultiply(Gt.makeTranslation(t,i)),this}},{key:"makeTranslation",value:function(t,i){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,i,0,0,1),this}},{key:"makeRotation",value:function(t){var i=Math.cos(t),t=Math.sin(t);return this.set(i,-t,0,t,i,0,0,0,1),this}},{key:"makeScale",value:function(t,i){return this.set(t,0,0,0,i,0,0,0,1),this}},{key:"equals",value:function(t){for(var i=this.elements,e=t.elements,n=0;n<9;n++)if(i[n]!==e[n])return!1;return!0}},{key:"fromArray",value:function(t){for(var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=0;e<9;e++)this.elements[e]=t[e+i];return this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=this.elements;return t[i]=e[0],t[i+1]=e[1],t[i+2]=e[2],t[i+3]=e[3],t[i+4]=e[4],t[i+5]=e[5],t[i+6]=e[6],t[i+7]=e[7],t[i+8]=e[8],t}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}])&&Ft(t.prototype,i),e&&Ft(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,e})(),Gt=new Dt;function Ut(t){return(Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Yt(t,i,e){return(i=(t=>(t=((t,i)=>{if("object"!=Ut(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Ut(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Ut(t)?t:t+""))(i))in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var _t=(new Dt).set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),Vt=(new Dt).set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),Jt=Yt(Yt(Yt(Yt({},t,{transfer:q,primaries:"rec709",luminanceCoefficients:[.2126,.7152,.0722],toReference:function(t){return t},fromReference:function(t){return t}}),"srgb",{transfer:"srgb",primaries:"rec709",luminanceCoefficients:[.2126,.7152,.0722],toReference:function(t){return t.convertSRGBToLinear()},fromReference:function(t){return t.convertLinearToSRGB()}}),i,{transfer:q,primaries:"p3",luminanceCoefficients:[.2289,.6917,.0793],toReference:function(t){return t.applyMatrix3(Vt)},fromReference:function(t){return t.applyMatrix3(_t)}}),"display-p3",{transfer:"srgb",primaries:"p3",luminanceCoefficients:[.2289,.6917,.0793],toReference:function(t){return t.convertSRGBToLinear().applyMatrix3(Vt)},fromReference:function(t){return t.applyMatrix3(_t).convertLinearToSRGB()}}),Zt=new Set([t,i]),f={enabled:!0,R:t,get workingColorSpace(){return this.R},set workingColorSpace(t){if(!Zt.has(t))throw new Error('Unsupported working color space, "'.concat(t,'".'));this.R=t},convert:function(t,i,e){return!1!==this.enabled&&i!==e&&i&&e?(i=Jt[i].toReference,(0,Jt[e].fromReference)(i(t))):t},fromWorkingColorSpace:function(t,i){return this.convert(t,this.R,i)},toWorkingColorSpace:function(t,i){return this.convert(t,i,this.R)},getPrimaries:function(t){return Jt[t].primaries},getTransfer:function(t){return""===t?q:Jt[t].transfer},getLuminanceCoefficients:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.R;return t.fromArray(Jt[i].luminanceCoefficients)}};function Ht(t){return t<.04045?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function Qt(t){return t<.0031308?12.92*t:1.055*Math.pow(t,.41666)-.055}var Xt=.001,c=t;function zt(t){return(zt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Kt(){Kt=function(){return o};var u,o={},t=Object.prototype,a=t.hasOwnProperty,f=Object.defineProperty||function(t,i,e){t[i]=e.value},i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",e=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function s(t,i,e){return Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[i]}try{s({},"")}catch(u){s=function(t,i,e){return t[i]=e}}function h(t,i,e,n){var r,s,o,h,i=i&&i.prototype instanceof p?i:p,i=Object.create(i.prototype),n=new E(n||[]);return f(i,"_invoke",{value:(r=t,s=e,o=n,h=c,function(t,i){if(h===y)throw Error("Generator is already running");if(h===d){if("throw"===t)throw i;return{value:u,done:!0}}for(o.method=t,o.arg=i;;){var e=o.delegate;if(e){e=function t(i,e){var n=e.method,r=i.iterator[n];if(r===u)return e.delegate=null,"throw"===n&&i.iterator.return&&(e.method="return",e.arg=u,t(i,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;n=l(r,i.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,b;r=n.arg;return r?r.done?(e[i.resultName]=r.value,e.next=i.nextLoc,"return"!==e.method&&(e.method="next",e.arg=u),e.delegate=null,b):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b)}(e,o);if(e){if(e===b)continue;return e}}if("next"===o.method)o.sent=o.u=o.arg;else if("throw"===o.method){if(h===c)throw h=d,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);h=y;e=l(r,s,o);if("normal"===e.type){if(h=o.done?d:v,e.arg===b)continue;return{value:e.arg,done:o.done}}"throw"===e.type&&(h=d,o.method="throw",o.arg=e.arg)}})}),i}function l(t,i,e){try{return{type:"normal",arg:t.call(i,e)}}catch(t){return{type:"throw",arg:t}}}o.wrap=h;var c="suspendedStart",v="suspendedYield",y="executing",d="completed",b={};function p(){}function m(){}function w(){}var i={},k=(s(i,n,function(){return this}),Object.getPrototypeOf),k=k&&k(k(O([]))),g=(k&&k!==t&&a.call(k,n)&&(i=k),w.prototype=p.prototype=Object.create(i));function A(t){["next","throw","return"].forEach(function(i){s(t,i,function(t){return this._invoke(i,t)})})}function M(o,h){var i;f(this,"_invoke",{value:function(e,n){function t(){return new h(function(t,i){!function i(t,e,n,r){var s,t=l(o[t],o,e);if("throw"!==t.type)return(e=(s=t.arg).value)&&"object"==zt(e)&&a.call(e,"__await")?h.resolve(e.v).then(function(t){i("next",t,n,r)},function(t){i("throw",t,n,r)}):h.resolve(e).then(function(t){s.value=t,n(s)},function(t){return i("throw",t,n,r)});r(t.arg)}(e,n,t,i)})}return i=i?i.then(t,t):t()}})}function S(t){var i={tryLoc:t[0]};1 in t&&(i.catchLoc=t[1]),2 in t&&(i.finallyLoc=t[2],i.afterLoc=t[3]),this.tryEntries.push(i)}function j(t){var i=t.completion||{};i.type="normal",delete i.arg,t.completion=i}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function O(i){if(i||""===i){var e,t=i[n];if(t)return t.call(i);if("function"==typeof i.next)return i;if(!isNaN(i.length))return e=-1,(t=function t(){for(;++e<i.length;)if(a.call(i,e))return t.value=i[e],t.done=!1,t;return t.value=u,t.done=!0,t}).next=t}throw new TypeError(zt(i)+" is not iterable")}return f(g,"constructor",{value:m.prototype=w,configurable:!0}),f(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,r,"GeneratorFunction"),o.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,r,"GeneratorFunction")),t.prototype=Object.create(g),t},o.awrap=function(t){return{v:t}},A(M.prototype),s(M.prototype,e,function(){return this}),o.AsyncIterator=M,o.async=function(t,i,e,n,r){void 0===r&&(r=Promise);var s=new M(h(t,i,e,n),r);return o.isGeneratorFunction(i)?s:s.next().then(function(t){return t.done?t.value:s.next()})},A(g),s(g,r,"Generator"),s(g,n,function(){return this}),s(g,"toString",function(){return"[object Generator]"}),o.keys=function(t){var i,e=Object(t),n=[];for(i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},o.values=O,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this.u=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(j),!t)for(var i in this)"t"===i.charAt(0)&&a.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function t(t,i){return s.type="throw",s.arg=e,n.next=t,i&&(n.method="next",n.arg=u),!!i}for(var i=this.tryEntries.length-1;0<=i;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var o=a.call(r,"catchLoc"),h=a.call(r,"finallyLoc");if(o&&h){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!h)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,i){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}var s=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=i&&i<=r.finallyLoc?null:r)?r.completion:{};return s.type=t,s.arg=i,r?(this.method="next",this.next=r.finallyLoc,b):this.complete(s)},complete:function(t,i){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&i&&(this.next=i),b},finish:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var e=this.tryEntries[i];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),j(e),b}},catch:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var e,n,r=this.tryEntries[i];if(r.tryLoc===t)return"throw"===(e=r.completion).type&&(n=e.arg,j(r)),n}throw Error("illegal catch attempt")},delegateYield:function(t,i,e){return this.delegate={iterator:O(t),resultName:i,nextLoc:e},"next"===this.method&&(this.arg=u),b}},o}function Wt(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=zt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=zt(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==zt(t)?t:t+""))(n.key),n)}}var qt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},v={h:0,s:0,l:0},$t={h:0,s:0,l:0};function ti(t,i,e){return e<0&&(e+=1),1<e&&--e,e<1/6?t+6*(i-t)*e:e<.5?i:e<2/3?t+6*(i-t)*(2/3-e):t}var y=(()=>{function n(t,i,e){if(this instanceof n)return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,i,e);throw new TypeError("Cannot call a class as a function")}return t=n,(i=[{key:"set",value:function(t,i,e){var n;return void 0===i&&void 0===e?(n=t)&&n.isColor?this.copy(n):"number"==typeof n?this.setHex(n):"string"==typeof n&&this.setStyle(n):this.setRGB(t,i,e),this}},{key:"setScalar",value:function(t){return this.r=t,this.g=t,this.b=t,this}},{key:"setHex",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c;return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,f.toWorkingColorSpace(this,i),this}},{key:"setRGB",value:function(t,i,e){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:f.workingColorSpace;return this.r=t,this.g=i,this.b=e,f.toWorkingColorSpace(this,n),this}},{key:"setHSL",value:function(t,i,e){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:f.workingColorSpace;return t=F(t,1),i=p(i,0,1),e=p(e,0,1),0===i?this.r=this.g=this.b=e:(this.r=ti(i=2*e-(e=e<=.5?e*(1+i):e+i-e*i),e,t+1/3),this.g=ti(i,e,t),this.b=ti(i,e,t-1/3)),f.toWorkingColorSpace(this,n),this}},{key:"setStyle",value:function(i){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c;function e(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+i+" will be ignored.")}if(o=/^(\w+)\(([^\)]*)\)/.exec(i)){var n,r=o[1],s=o[2];switch(r){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return e(n[4]),this.setRGB(Math.min(255,parseInt(n[1],10))/255,Math.min(255,parseInt(n[2],10))/255,Math.min(255,parseInt(n[3],10))/255,t);if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return e(n[4]),this.setRGB(Math.min(100,parseInt(n[1],10))/100,Math.min(100,parseInt(n[2],10))/100,Math.min(100,parseInt(n[3],10))/100,t);break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return e(n[4]),this.setHSL(parseFloat(n[1])/360,parseFloat(n[2])/100,parseFloat(n[3])/100,t);break;default:console.warn("THREE.Color: Unknown color model "+i)}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(i)){var r=o[1],o=r.length;if(3===o)return this.setRGB(parseInt(r.charAt(0),16)/15,parseInt(r.charAt(1),16)/15,parseInt(r.charAt(2),16)/15,t);if(6===o)return this.setHex(parseInt(r,16),t);console.warn("THREE.Color: Invalid hex color "+i)}else if(i&&0<i.length)return this.setColorName(i,t);return this}},{key:"setColorName",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:c,e=qt[t.toLowerCase()];return void 0!==e?this.setHex(e,i):console.warn("THREE.Color: Unknown color "+t),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}},{key:"copySRGBToLinear",value:function(t){return this.r=Ht(t.r),this.g=Ht(t.g),this.b=Ht(t.b),this}},{key:"copyLinearToSRGB",value:function(t){return this.r=Qt(t.r),this.g=Qt(t.g),this.b=Qt(t.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c;return f.fromWorkingColorSpace(d.copy(this),t),65536*Math.round(p(255*d.r,0,255))+256*Math.round(p(255*d.g,0,255))+Math.round(p(255*d.b,0,255))}},{key:"getHexString",value:function(){return("000000"+this.getHex(0<arguments.length&&void 0!==arguments[0]?arguments[0]:c).toString(16)).slice(-6)}},{key:"getHSL",value:function(t){var i,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f.workingColorSpace,n=(f.fromWorkingColorSpace(d.copy(this),e),d.r),r=d.g,s=d.b,e=Math.max(n,r,s),o=Math.min(n,r,s),h=(o+e)/2;if(o===e)a=i=0;else{var u=e-o,a=h<=.5?u/(e+o):u/(2-e-o);switch(e){case n:i=(r-s)/u+(r<s?6:0);break;case r:i=(s-n)/u+2;break;case s:i=(n-r)/u+4}i/=6}return t.h=i,t.s=a,t.l=h,t}},{key:"getRGB",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:f.workingColorSpace;return f.fromWorkingColorSpace(d.copy(this),i),t.r=d.r,t.g=d.g,t.b=d.b,t}},{key:"getStyle",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:c,i=(f.fromWorkingColorSpace(d.copy(this),t),d.r),e=d.g,n=d.b;return t!==c?"color(".concat(t," ").concat(i.toFixed(3)," ").concat(e.toFixed(3)," ").concat(n.toFixed(3),")"):"rgb(".concat(Math.round(255*i),",").concat(Math.round(255*e),",").concat(Math.round(255*n),")")}},{key:"offsetHSL",value:function(t,i,e){return this.getHSL(v),this.setHSL(v.h+t,v.s+i,v.l+e)}},{key:"add",value:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}},{key:"addColors",value:function(t,i){return this.r=t.r+i.r,this.g=t.g+i.g,this.b=t.b+i.b,this}},{key:"addScalar",value:function(t){return this.r+=t,this.g+=t,this.b+=t,this}},{key:"sub",value:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}},{key:"multiply",value:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}},{key:"multiplyScalar",value:function(t){return this.r*=t,this.g*=t,this.b*=t,this}},{key:"lerp",value:function(t,i){return this.r+=(t.r-this.r)*i,this.g+=(t.g-this.g)*i,this.b+=(t.b-this.b)*i,this}},{key:"lerpColors",value:function(t,i,e){return this.r=t.r+(i.r-t.r)*e,this.g=t.g+(i.g-t.g)*e,this.b=t.b+(i.b-t.b)*e,this}},{key:"lerpHSL",value:function(t,i){this.getHSL(v),t.getHSL($t);var t=D(v.h,$t.h,i),e=D(v.s,$t.s,i),i=D(v.l,$t.l,i);return this.setHSL(t,e,i),this}},{key:"setFromVector3",value:function(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}},{key:"applyMatrix3",value:function(t){var i=this.r,e=this.g,n=this.b,t=t.elements;return this.r=t[0]*i+t[3]*e+t[6]*n,this.g=t[1]*i+t[4]*e+t[7]*n,this.b=t[2]*i+t[5]*e+t[8]*n,this}},{key:"equals",value:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.r=t[i],this.g=t[i+1],this.b=t[i+2],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.r,t[i+1]=this.g,t[i+2]=this.b,t}},{key:"fromBufferAttribute",value:function(t,i){return this.r=t.getX(i),this.g=t.getY(i),this.b=t.getZ(i),this}},{key:"toJSON",value:function(){return this.getHex()}},{key:Symbol.iterator,value:Kt().mark(function t(){return Kt().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.r;case 2:return t.next=4,this.g;case 4:return t.next=6,this.b;case 6:case"end":return t.stop()}},t,this)})}])&&Wt(t.prototype,i),e&&Wt(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,e})(),d=new y;function ii(t){return(ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ei(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=ii(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=ii(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==ii(t)?t:t+""))(n.key),n)}}y.NAMES=qt;var ni=(()=>{return t=function t(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new U(1/0,1/0,1/0),e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new U(-1/0,-1/0,-1/0),n=this,r=t;if(!(n instanceof r))throw new TypeError("Cannot call a class as a function");this.isBox3=!0,this.min=i,this.max=e},(i=[{key:"set",value:function(t,i){return this.min.copy(t),this.max.copy(i),this}},{key:"setFromArray",value:function(t){this.makeEmpty();for(var i=0,e=t.length;i<e;i+=3)this.expandByPoint(b.fromArray(t,i));return this}},{key:"setFromBufferAttribute",value:function(t){this.makeEmpty();for(var i=0,e=t.count;i<e;i++)this.expandByPoint(b.fromBufferAttribute(t,i));return this}},{key:"setFromPoints",value:function(t){this.makeEmpty();for(var i=0,e=t.length;i<e;i++)this.expandByPoint(t[i]);return this}},{key:"setFromCenterAndSize",value:function(t,i){i=b.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}},{key:"setFromObject",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(t,i)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){return this.min.copy(t.min),this.max.copy(t.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(t){return this.min.min(t),this.max.max(t),this}},{key:"expandByVector",value:function(t){return this.min.sub(t),this.max.add(t),this}},{key:"expandByScalar",value:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this}},{key:"expandByObject",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]&&arguments[1],e=(t.updateWorldMatrix(!1,!1),t.geometry);if(void 0!==e){var n=e.getAttribute("position");if(!0===i&&void 0!==n&&!0!==t.isInstancedMesh)for(var r=0,s=n.count;r<s;r++)!0===t.isMesh?t.getVertexPosition(r,b):b.fromBufferAttribute(n,r),b.applyMatrix4(t.matrixWorld),this.expandByPoint(b);else void 0!==t.boundingBox?(null===t.boundingBox&&t.computeBoundingBox(),ri.copy(t.boundingBox)):(null===e.boundingBox&&e.computeBoundingBox(),ri.copy(e.boundingBox)),ri.applyMatrix4(t.matrixWorld),this.union(ri)}for(var o=t.children,h=0,u=o.length;h<u;h++)this.expandByObject(o[h],i);return this}},{key:"containsPoint",value:function(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}},{key:"containsBox",value:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}},{key:"getParameter",value:function(t,i){return i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}},{key:"intersectsSphere",value:function(t){return this.clampPoint(t.center,b),b.distanceToSquared(t.center)<=t.radius*t.radius}},{key:"intersectsPlane",value:function(t){var i,e=0<t.normal.x?(i=t.normal.x*this.min.x,t.normal.x*this.max.x):(i=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(i+=t.normal.y*this.min.y,e+=t.normal.y*this.max.y):(i+=t.normal.y*this.max.y,e+=t.normal.y*this.min.y),0<t.normal.z?(i+=t.normal.z*this.min.z,e+=t.normal.z*this.max.z):(i+=t.normal.z*this.max.z,e+=t.normal.z*this.min.z),i<=-t.constant&&e>=-t.constant}},{key:"intersectsTriangle",value:function(t){return!this.isEmpty()&&(this.getCenter(ui),ai.subVectors(this.max,ui),si.subVectors(t.a,ui),oi.subVectors(t.b,ui),hi.subVectors(t.c,ui),w.subVectors(oi,si),k.subVectors(hi,oi),g.subVectors(si,hi),!!li([0,-w.z,w.y,0,-k.z,k.y,0,-g.z,g.y,w.z,0,-w.x,k.z,0,-k.x,g.z,0,-g.x,-w.y,w.x,0,-k.y,k.x,0,-g.y,g.x,0],si,oi,hi,ai))&&!!li([1,0,0,0,1,0,0,0,1],si,oi,hi,ai)&&(fi.crossVectors(w,k),li([fi.x,fi.y,fi.z],si,oi,hi,ai))}},{key:"clampPoint",value:function(t,i){return i.copy(t).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(t){return this.clampPoint(t,b).distanceTo(t)}},{key:"getBoundingSphere",value:function(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=.5*this.getSize(b).length()),t}},{key:"intersect",value:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(t){return this.min.min(t.min),this.max.max(t.max),this}},{key:"applyMatrix4",value:function(t){return this.isEmpty()||(n[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),n[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),n[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),n[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),n[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),n[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),n[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),n[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(n)),this}},{key:"translate",value:function(t){return this.min.add(t),this.max.add(t),this}},{key:"equals",value:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}])&&ei(t.prototype,i),e&&ei(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,e})(),n=[new U,new U,new U,new U,new U,new U,new U,new U],b=new U,ri=new ni,si=new U,oi=new U,hi=new U,w=new U,k=new U,g=new U,ui=new U,ai=new U,fi=new U,A=new U;function li(t,i,e,n,r){for(var s=0,o=t.length-3;s<=o;s+=3){A.fromArray(t,s);var h=r.x*Math.abs(A.x)+r.y*Math.abs(A.y)+r.z*Math.abs(A.z),u=i.dot(A),a=e.dot(A),f=n.dot(A);if(Math.max(-Math.max(u,a,f),Math.min(u,a,f))>h)return!1}return!0}function ci(t){return(ci="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vi(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=ci(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=ci(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==ci(t)?t:t+""))(n.key),n)}}var yi=(()=>{function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}return i=t,(e=[{key:"addEventListener",value:function(t,i){void 0===this.T&&(this.T={});var e=this.T;void 0===e[t]&&(e[t]=[]),-1===e[t].indexOf(i)&&e[t].push(i)}},{key:"hasEventListener",value:function(t,i){var e;return void 0!==this.T&&void 0!==(e=this.T)[t]&&-1!==e[t].indexOf(i)}},{key:"removeEventListener",value:function(t,i){var e;void 0!==this.T&&void 0!==(t=this.T[t])&&-1!==(e=t.indexOf(i))&&t.splice(e,1)}},{key:"dispatchEvent",value:function(t){if(void 0!==this.T){var i=this.T[t.type];if(void 0!==i){t.target=this;for(var e=i.slice(0),n=0,r=e.length;n<r;n++)e[n].call(this,t);t.target=null}}}}])&&vi(i.prototype,e),n&&vi(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,e,n})();function di(t,i,e){i=pi(i);var n=t,i=bi()?Reflect.construct(i,e||[],pi(t).constructor):i.apply(t,e);if(!i||"object"!=ki(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=n))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function bi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(bi=function(){return!!t})()}function pi(t){return(pi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function mi(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&wi(t,i)}function wi(t,i){return(wi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function ki(t){return(ki="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function gi(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Ai(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=ki(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=ki(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==ki(t)?t:t+""))(n.key),n)}}function Mi(t,i,e){return i&&Ai(t.prototype,i),e&&Ai(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}var M=new U,Si=new G,ji=(()=>Mi(function t(i,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(gi(this,t),Array.isArray(i))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=i,this.itemSize=e,this.count=void 0!==i?i.length/e:0,this.normalized=n,this.usage=35044,this.updateRanges=[],this.gpuType=1015,this.version=0},[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(t){!0===t&&this.version++}},{key:"setUsage",value:function(t){return this.usage=t,this}},{key:"addUpdateRange",value:function(t,i){this.updateRanges.push({start:t,count:i})}},{key:"clearUpdateRanges",value:function(){this.updateRanges.length=0}},{key:"copy",value:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}},{key:"copyAt",value:function(t,i,e){t*=this.itemSize,e*=i.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[t+n]=i.array[e+n];return this}},{key:"copyArray",value:function(t){return this.array.set(t),this}},{key:"applyMatrix3",value:function(t){if(2===this.itemSize)for(var i=0,e=this.count;i<e;i++)Si.fromBufferAttribute(this,i),Si.applyMatrix3(t),this.setXY(i,Si.x,Si.y);else if(3===this.itemSize)for(var n=0,r=this.count;n<r;n++)M.fromBufferAttribute(this,n),M.applyMatrix3(t),this.setXYZ(n,M.x,M.y,M.z);return this}},{key:"applyMatrix4",value:function(t){for(var i=0,e=this.count;i<e;i++)M.fromBufferAttribute(this,i),M.applyMatrix4(t),this.setXYZ(i,M.x,M.y,M.z);return this}},{key:"applyNormalMatrix",value:function(t){for(var i=0,e=this.count;i<e;i++)M.fromBufferAttribute(this,i),M.applyNormalMatrix(t),this.setXYZ(i,M.x,M.y,M.z);return this}},{key:"transformDirection",value:function(t){for(var i=0,e=this.count;i<e;i++)M.fromBufferAttribute(this,i),M.transformDirection(t),this.setXYZ(i,M.x,M.y,M.z);return this}},{key:"set",value:function(t){return this.array.set(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:0),this}},{key:"getComponent",value:function(t,i){t=this.array[t*this.itemSize+i];return t=this.normalized?Y(t,this.array):t}},{key:"setComponent",value:function(t,i,e){return this.normalized&&(e=s(e,this.array)),this.array[t*this.itemSize+i]=e,this}},{key:"getX",value:function(t){t=this.array[t*this.itemSize];return t=this.normalized?Y(t,this.array):t}},{key:"setX",value:function(t,i){return this.normalized&&(i=s(i,this.array)),this.array[t*this.itemSize]=i,this}},{key:"getY",value:function(t){t=this.array[t*this.itemSize+1];return t=this.normalized?Y(t,this.array):t}},{key:"setY",value:function(t,i){return this.normalized&&(i=s(i,this.array)),this.array[t*this.itemSize+1]=i,this}},{key:"getZ",value:function(t){t=this.array[t*this.itemSize+2];return t=this.normalized?Y(t,this.array):t}},{key:"setZ",value:function(t,i){return this.normalized&&(i=s(i,this.array)),this.array[t*this.itemSize+2]=i,this}},{key:"getW",value:function(t){t=this.array[t*this.itemSize+3];return t=this.normalized?Y(t,this.array):t}},{key:"setW",value:function(t,i){return this.normalized&&(i=s(i,this.array)),this.array[t*this.itemSize+3]=i,this}},{key:"setXY",value:function(t,i,e){return t*=this.itemSize,this.normalized&&(i=s(i,this.array),e=s(e,this.array)),this.array[t+0]=i,this.array[t+1]=e,this}},{key:"setXYZ",value:function(t,i,e,n){return t*=this.itemSize,this.normalized&&(i=s(i,this.array),e=s(e,this.array),n=s(n,this.array)),this.array[t+0]=i,this.array[t+1]=e,this.array[t+2]=n,this}},{key:"setXYZW",value:function(t,i,e,n,r){return t*=this.itemSize,this.normalized&&(i=s(i,this.array),e=s(e,this.array),n=s(n,this.array),r=s(r,this.array)),this.array[t+0]=i,this.array[t+1]=e,this.array[t+2]=n,this.array[t+3]=r,this}},{key:"onUpload",value:function(t){return this.onUploadCallback=t,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(t.name=this.name),35044!==this.usage&&(t.usage=this.usage),t}}]))(),Ei=(()=>{function n(t,i,e){return gi(this,n),di(this,n,[new Uint16Array(t),i,e])}return mi(n,ji),Mi(n)})(),Oi=(()=>{function n(t,i,e){return gi(this,n),di(this,n,[new Uint32Array(t),i,e])}return mi(n,ji),Mi(n)})(),xi=(()=>{function n(t,i,e){return gi(this,n),di(this,n,[new Float32Array(t),i,e])}return mi(n,ji),Mi(n)})();function Ri(t){return(Ri="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ti(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=Ri(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Ri(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Ri(t)?t:t+""))(n.key),n)}}var Ii=new ni,Ci=new U,Bi=new U,Ni=(()=>{return t=function t(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new U,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:-1,n=this,r=t;if(!(n instanceof r))throw new TypeError("Cannot call a class as a function");this.isSphere=!0,this.center=i,this.radius=e},(i=[{key:"set",value:function(t,i){return this.center.copy(t),this.radius=i,this}},{key:"setFromPoints",value:function(t,i){for(var e=this.center,n=(void 0!==i?e.copy(i):Ii.setFromPoints(t).getCenter(e),0),r=0,s=t.length;r<s;r++)n=Math.max(n,e.distanceToSquared(t[r]));return this.radius=Math.sqrt(n),this}},{key:"copy",value:function(t){return this.center.copy(t.center),this.radius=t.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(t){return t.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(t){var i=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=i*i}},{key:"intersectsBox",value:function(t){return t.intersectsSphere(this)}},{key:"intersectsPlane",value:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(t,i){var e=this.center.distanceToSquared(t);return i.copy(t),e>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}},{key:"getBoundingBox",value:function(t){return this.isEmpty()?t.makeEmpty():(t.set(this.center,this.center),t.expandByScalar(this.radius)),t}},{key:"applyMatrix4",value:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}},{key:"translate",value:function(t){return this.center.add(t),this}},{key:"expandByPoint",value:function(t){var i;return this.isEmpty()?(this.center.copy(t),this.radius=0):(Ci.subVectors(t,this.center),(t=Ci.lengthSq())>this.radius*this.radius&&(i=.5*((t=Math.sqrt(t))-this.radius),this.center.addScaledVector(Ci,i/t),this.radius+=i)),this}},{key:"union",value:function(t){return t.isEmpty()||(this.isEmpty()?this.copy(t):!0===this.center.equals(t.center)?this.radius=Math.max(this.radius,t.radius):(Bi.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint(Ci.copy(t.center).add(Bi)),this.expandByPoint(Ci.copy(t.center).sub(Bi)))),this}},{key:"equals",value:function(t){return t.center.equals(this.center)&&t.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}])&&Ti(t.prototype,i),e&&Ti(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,e})();function Pi(t){return(Pi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Li(){Li=function(){return o};var u,o={},t=Object.prototype,a=t.hasOwnProperty,f=Object.defineProperty||function(t,i,e){t[i]=e.value},i="function"==typeof Symbol?Symbol:{},n=i.iterator||"@@iterator",e=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function s(t,i,e){return Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[i]}try{s({},"")}catch(u){s=function(t,i,e){return t[i]=e}}function h(t,i,e,n){var r,s,o,h,i=i&&i.prototype instanceof p?i:p,i=Object.create(i.prototype),n=new E(n||[]);return f(i,"_invoke",{value:(r=t,s=e,o=n,h=c,function(t,i){if(h===y)throw Error("Generator is already running");if(h===d){if("throw"===t)throw i;return{value:u,done:!0}}for(o.method=t,o.arg=i;;){var e=o.delegate;if(e){e=function t(i,e){var n=e.method,r=i.iterator[n];if(r===u)return e.delegate=null,"throw"===n&&i.iterator.return&&(e.method="return",e.arg=u,t(i,e),"throw"===e.method)||"return"!==n&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+n+"' method")),b;n=l(r,i.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,b;r=n.arg;return r?r.done?(e[i.resultName]=r.value,e.next=i.nextLoc,"return"!==e.method&&(e.method="next",e.arg=u),e.delegate=null,b):r:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,b)}(e,o);if(e){if(e===b)continue;return e}}if("next"===o.method)o.sent=o.u=o.arg;else if("throw"===o.method){if(h===c)throw h=d,o.arg;o.dispatchException(o.arg)}else"return"===o.method&&o.abrupt("return",o.arg);h=y;e=l(r,s,o);if("normal"===e.type){if(h=o.done?d:v,e.arg===b)continue;return{value:e.arg,done:o.done}}"throw"===e.type&&(h=d,o.method="throw",o.arg=e.arg)}})}),i}function l(t,i,e){try{return{type:"normal",arg:t.call(i,e)}}catch(t){return{type:"throw",arg:t}}}o.wrap=h;var c="suspendedStart",v="suspendedYield",y="executing",d="completed",b={};function p(){}function m(){}function w(){}var i={},k=(s(i,n,function(){return this}),Object.getPrototypeOf),k=k&&k(k(O([]))),g=(k&&k!==t&&a.call(k,n)&&(i=k),w.prototype=p.prototype=Object.create(i));function A(t){["next","throw","return"].forEach(function(i){s(t,i,function(t){return this._invoke(i,t)})})}function M(o,h){var i;f(this,"_invoke",{value:function(e,n){function t(){return new h(function(t,i){!function i(t,e,n,r){var s,t=l(o[t],o,e);if("throw"!==t.type)return(e=(s=t.arg).value)&&"object"==Pi(e)&&a.call(e,"__await")?h.resolve(e.v).then(function(t){i("next",t,n,r)},function(t){i("throw",t,n,r)}):h.resolve(e).then(function(t){s.value=t,n(s)},function(t){return i("throw",t,n,r)});r(t.arg)}(e,n,t,i)})}return i=i?i.then(t,t):t()}})}function S(t){var i={tryLoc:t[0]};1 in t&&(i.catchLoc=t[1]),2 in t&&(i.finallyLoc=t[2],i.afterLoc=t[3]),this.tryEntries.push(i)}function j(t){var i=t.completion||{};i.type="normal",delete i.arg,t.completion=i}function E(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function O(i){if(i||""===i){var e,t=i[n];if(t)return t.call(i);if("function"==typeof i.next)return i;if(!isNaN(i.length))return e=-1,(t=function t(){for(;++e<i.length;)if(a.call(i,e))return t.value=i[e],t.done=!1,t;return t.value=u,t.done=!0,t}).next=t}throw new TypeError(Pi(i)+" is not iterable")}return f(g,"constructor",{value:m.prototype=w,configurable:!0}),f(w,"constructor",{value:m,configurable:!0}),m.displayName=s(w,r,"GeneratorFunction"),o.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},o.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,s(t,r,"GeneratorFunction")),t.prototype=Object.create(g),t},o.awrap=function(t){return{v:t}},A(M.prototype),s(M.prototype,e,function(){return this}),o.AsyncIterator=M,o.async=function(t,i,e,n,r){void 0===r&&(r=Promise);var s=new M(h(t,i,e,n),r);return o.isGeneratorFunction(i)?s:s.next().then(function(t){return t.done?t.value:s.next()})},A(g),s(g,r,"Generator"),s(g,n,function(){return this}),s(g,"toString",function(){return"[object Generator]"}),o.keys=function(t){var i,e=Object(t),n=[];for(i in e)n.push(i);return n.reverse(),function t(){for(;n.length;){var i=n.pop();if(i in e)return t.value=i,t.done=!1,t}return t.done=!0,t}},o.values=O,E.prototype={constructor:E,reset:function(t){if(this.prev=0,this.next=0,this.sent=this.u=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(j),!t)for(var i in this)"t"===i.charAt(0)&&a.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function t(t,i){return s.type="throw",s.arg=e,n.next=t,i&&(n.method="next",n.arg=u),!!i}for(var i=this.tryEntries.length-1;0<=i;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var o=a.call(r,"catchLoc"),h=a.call(r,"finallyLoc");if(o&&h){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(o){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!h)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,i){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc<=this.prev&&a.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var r=n;break}}var s=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=i&&i<=r.finallyLoc?null:r)?r.completion:{};return s.type=t,s.arg=i,r?(this.method="next",this.next=r.finallyLoc,b):this.complete(s)},complete:function(t,i){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&i&&(this.next=i),b},finish:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var e=this.tryEntries[i];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),j(e),b}},catch:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var e,n,r=this.tryEntries[i];if(r.tryLoc===t)return"throw"===(e=r.completion).type&&(n=e.arg,j(r)),n}throw Error("illegal catch attempt")},delegateYield:function(t,i,e){return this.delegate={iterator:O(t),resultName:i,nextLoc:e},"next"===this.method&&(this.arg=u),b}},o}function Fi(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=Pi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Pi(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Pi(t)?t:t+""))(n.key),n)}}var Di=new m,Gi=new H,Ui=(()=>{return t=function t(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:t.DEFAULT_ORDER,s=this,o=t;if(!(s instanceof o))throw new TypeError("Cannot call a class as a function");this.isEuler=!0,this.k=i,this.A=e,this.M=n,this.O=r},(i=[{key:"x",get:function(){return this.k},set:function(t){this.k=t,this.j()}},{key:"y",get:function(){return this.A},set:function(t){this.A=t,this.j()}},{key:"z",get:function(){return this.M},set:function(t){this.M=t,this.j()}},{key:"order",get:function(){return this.O},set:function(t){this.O=t,this.j()}},{key:"set",value:function(t,i,e){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:this.O;return this.k=t,this.A=i,this.M=e,this.O=n,this.j(),this}},{key:"clone",value:function(){return new this.constructor(this.k,this.A,this.M,this.O)}},{key:"copy",value:function(t){return this.k=t.k,this.A=t.A,this.M=t.M,this.O=t.O,this.j(),this}},{key:"setFromRotationMatrix",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.O,e=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],t=t.elements,n=t[0],r=t[4],s=t[8],o=t[1],h=t[5],u=t[9],a=t[2],f=t[6],l=t[10];switch(i){case"XYZ":this.A=Math.asin(p(s,-1,1)),Math.abs(s)<.9999999?(this.k=Math.atan2(-u,l),this.M=Math.atan2(-r,n)):(this.k=Math.atan2(f,h),this.M=0);break;case"YXZ":this.k=Math.asin(-p(u,-1,1)),Math.abs(u)<.9999999?(this.A=Math.atan2(s,l),this.M=Math.atan2(o,h)):(this.A=Math.atan2(-a,n),this.M=0);break;case"ZXY":this.k=Math.asin(p(f,-1,1)),Math.abs(f)<.9999999?(this.A=Math.atan2(-a,l),this.M=Math.atan2(-r,h)):(this.A=0,this.M=Math.atan2(o,n));break;case"ZYX":this.A=Math.asin(-p(a,-1,1)),Math.abs(a)<.9999999?(this.k=Math.atan2(f,l),this.M=Math.atan2(o,n)):(this.k=0,this.M=Math.atan2(-r,h));break;case"YZX":this.M=Math.asin(p(o,-1,1)),Math.abs(o)<.9999999?(this.k=Math.atan2(-u,h),this.A=Math.atan2(-a,n)):(this.k=0,this.A=Math.atan2(s,l));break;case"XZY":this.M=Math.asin(-p(r,-1,1)),Math.abs(r)<.9999999?(this.k=Math.atan2(f,h),this.A=Math.atan2(s,n)):(this.k=Math.atan2(-u,l),this.A=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this.O=i,!0===e&&this.j(),this}},{key:"setFromQuaternion",value:function(t,i,e){return Di.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Di,i,e)}},{key:"setFromVector3",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.O;return this.set(t.x,t.y,t.z,i)}},{key:"reorder",value:function(t){return Gi.setFromEuler(this),this.setFromQuaternion(Gi,t)}},{key:"equals",value:function(t){return t.k===this.k&&t.A===this.A&&t.M===this.M&&t.O===this.O}},{key:"fromArray",value:function(t){return this.k=t[0],this.A=t[1],this.M=t[2],void 0!==t[3]&&(this.O=t[3]),this.j(),this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.k,t[i+1]=this.A,t[i+2]=this.M,t[i+3]=this.O,t}},{key:"_onChange",value:function(t){return this.j=t,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:Li().mark(function t(){return Li().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.k;case 2:return t.next=4,this.A;case 4:return t.next=6,this.M;case 6:return t.next=8,this.O;case 8:case"end":return t.stop()}},t,this)})}])&&Fi(t.prototype,i),e&&Fi(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,e})();function Yi(t){return(Yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _i(t){return(t=>{if(Array.isArray(t))return Vi(t)})(t)||(t=>{if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)})(t)||((t,i)=>{var e;if(t)return"string"==typeof t?Vi(t,i):"Map"===(e="Object"===(e={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Vi(t,i):void 0})(t)||(()=>{throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function Vi(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,n=Array(i);e<i;e++)n[e]=t[e];return n}function Ji(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=Yi(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Yi(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Yi(t)?t:t+""))(n.key),n)}}function Zi(t,i,e){i=Qi(i);var n=t,i=Hi()?Reflect.construct(i,e||[],Qi(t).constructor):i.apply(t,e);if(!i||"object"!=Yi(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=n))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function Hi(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Hi=function(){return!!t})()}function Qi(t){return(Qi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Xi(t,i){return(Xi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}Ui.DEFAULT_ORDER="XYZ";var zi=0,Ki=new U,Wi=new H,S=new m,qi=new U,$i=new U,te=new U,ie=new H,ee=new U(1,0,0),ne=new U(0,1,0),re=new U(0,0,1),se={type:"added"},oe={type:"removed"},he={type:"childadded",child:null},ue={type:"childremoved",child:null},ae=(()=>{function s(){var t;if(!(this instanceof s))throw new TypeError("Cannot call a class as a function");(t=Zi(this,s)).isObject3D=!0,Object.defineProperty(t,"id",{value:zi++}),t.uuid=L(),t.name="",t.type="Object3D",t.parent=null,t.children=[],t.up=s.DEFAULT_UP.clone();var i=new U,e=new Ui,n=new H,r=new U(1,1,1);return e._onChange(function(){n.setFromEuler(e,!1)}),n._onChange(function(){e.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(t,{position:{configurable:!0,enumerable:!0,value:i},rotation:{configurable:!0,enumerable:!0,value:e},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new m},normalMatrix:{value:new Dt}}),t.matrix=new m,t.matrixWorld=new m,t.matrixAutoUpdate=s.DEFAULT_MATRIX_AUTO_UPDATE,t.matrixWorldAutoUpdate=s.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,t.matrixWorldNeedsUpdate=!1,t.layers=new Rt,t.visible=!0,t.castShadow=!1,t.receiveShadow=!1,t.frustumCulled=!0,t.renderOrder=0,t.animations=[],t.userData={},t}var t,i=s,e=yi;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");return i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Xi(i,e),i=s,(e=[{key:"onBeforeShadow",value:function(){}},{key:"onAfterShadow",value:function(){}},{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(t){return this.quaternion.premultiply(t),this}},{key:"setRotationFromAxisAngle",value:function(t,i){this.quaternion.setFromAxisAngle(t,i)}},{key:"setRotationFromEuler",value:function(t){this.quaternion.setFromEuler(t,!0)}},{key:"setRotationFromMatrix",value:function(t){this.quaternion.setFromRotationMatrix(t)}},{key:"setRotationFromQuaternion",value:function(t){this.quaternion.copy(t)}},{key:"rotateOnAxis",value:function(t,i){return Wi.setFromAxisAngle(t,i),this.quaternion.multiply(Wi),this}},{key:"rotateOnWorldAxis",value:function(t,i){return Wi.setFromAxisAngle(t,i),this.quaternion.premultiply(Wi),this}},{key:"rotateX",value:function(t){return this.rotateOnAxis(ee,t)}},{key:"rotateY",value:function(t){return this.rotateOnAxis(ne,t)}},{key:"rotateZ",value:function(t){return this.rotateOnAxis(re,t)}},{key:"translateOnAxis",value:function(t,i){return Ki.copy(t).applyQuaternion(this.quaternion),this.position.add(Ki.multiplyScalar(i)),this}},{key:"translateX",value:function(t){return this.translateOnAxis(ee,t)}},{key:"translateY",value:function(t){return this.translateOnAxis(ne,t)}},{key:"translateZ",value:function(t){return this.translateOnAxis(re,t)}},{key:"localToWorld",value:function(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(S.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(t,i,e){t.isVector3?qi.copy(t):qi.set(t,i,e);t=this.parent;this.updateWorldMatrix(!0,!1),$i.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?S.lookAt($i,qi,this.up):S.lookAt(qi,$i,this.up),this.quaternion.setFromRotationMatrix(S),t&&(S.extractRotation(t.matrixWorld),Wi.setFromRotationMatrix(S),this.quaternion.premultiply(Wi.invert()))}},{key:"add",value:function(t){if(1<arguments.length)for(var i=0;i<arguments.length;i++)this.add(arguments[i]);else t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(t.removeFromParent(),(t.parent=this).children.push(t),t.dispatchEvent(se),he.child=t,this.dispatchEvent(he),he.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t);return this}},{key:"remove",value:function(t){if(1<arguments.length)for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);else{var e=this.children.indexOf(t);-1!==e&&(t.parent=null,this.children.splice(e,1),t.dispatchEvent(oe),ue.child=t,this.dispatchEvent(ue),ue.child=null)}return this}},{key:"removeFromParent",value:function(){var t=this.parent;return null!==t&&t.remove(this),this}},{key:"clear",value:function(){return this.remove.apply(this,_i(this.children))}},{key:"attach",value:function(t){return this.updateWorldMatrix(!0,!1),S.copy(this.matrixWorld).invert(),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),S.multiply(t.parent.matrixWorld)),t.applyMatrix4(S),t.removeFromParent(),(t.parent=this).children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(se),he.child=t,this.dispatchEvent(he),he.child=null,this}},{key:"getObjectById",value:function(t){return this.getObjectByProperty("id",t)}},{key:"getObjectByName",value:function(t){return this.getObjectByProperty("name",t)}},{key:"getObjectByProperty",value:function(t,i){if(this[t]===i)return this;for(var e=0,n=this.children.length;e<n;e++){var r=this.children[e].getObjectByProperty(t,i);if(void 0!==r)return r}}},{key:"getObjectsByProperty",value:function(t,i){for(var e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:[],n=(this[t]===i&&e.push(this),this.children),r=0,s=n.length;r<s;r++)n[r].getObjectsByProperty(t,i,e);return e}},{key:"getWorldPosition",value:function(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose($i,t,te),t}},{key:"getWorldScale",value:function(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose($i,ie,t),t}},{key:"getWorldDirection",value:function(t){this.updateWorldMatrix(!0,!1);var i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(t){t(this);for(var i=this.children,e=0,n=i.length;e<n;e++)i[e].traverse(t)}},{key:"traverseVisible",value:function(t){if(!1!==this.visible){t(this);for(var i=this.children,e=0,n=i.length;e<n;e++)i[e].traverseVisible(t)}}},{key:"traverseAncestors",value:function(t){var i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),t=!(this.matrixWorldNeedsUpdate=!1));for(var i=this.children,e=0,n=i.length;e<n;e++)i[e].updateMatrixWorld(t)}},{key:"updateWorldMatrix",value:function(t,i){var e=this.parent;if(!0===t&&null!==e&&e.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===i)for(var n=this.children,r=0,s=n.length;r<s;r++)n[r].updateWorldMatrix(!1,!0)}},{key:"toJSON",value:function(e){var t,i,n,r,s,o,h=void 0===e||"string"==typeof e,u={},a=(h&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},u.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"}),{});function f(t,i){return void 0===t[i.uuid]&&(t[i.uuid]=i.toJSON(e)),i.uuid}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),!0===this.castShadow&&(a.castShadow=!0),!0===this.receiveShadow&&(a.receiveShadow=!0),!1===this.visible&&(a.visible=!1),!1===this.frustumCulled&&(a.frustumCulled=!1),0!==this.renderOrder&&(a.renderOrder=this.renderOrder),0<Object.keys(this.userData).length&&(a.userData=this.userData),a.layers=this.layers.mask,a.matrix=this.matrix.toArray(),a.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(a.matrixAutoUpdate=!1),this.isInstancedMesh&&(a.type="InstancedMesh",a.count=this.count,a.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor)&&(a.instanceColor=this.instanceColor.toJSON()),this.isBatchedMesh&&(a.type="BatchedMesh",a.perObjectFrustumCulled=this.perObjectFrustumCulled,a.sortObjects=this.sortObjects,a.drawRanges=this._drawRanges,a.reservedRanges=this._reservedRanges,a.visibility=this._visibility,a.active=this._active,a.bounds=this._bounds.map(function(t){return{boxInitialized:t.boxInitialized,boxMin:t.box.min.toArray(),boxMax:t.box.max.toArray(),sphereInitialized:t.sphereInitialized,sphereRadius:t.sphere.radius,sphereCenter:t.sphere.center.toArray()}}),a.maxInstanceCount=this._maxInstanceCount,a.maxVertexCount=this._maxVertexCount,a.maxIndexCount=this._maxIndexCount,a.geometryInitialized=this._geometryInitialized,a.geometryCount=this._geometryCount,a.matricesTexture=this._matricesTexture.toJSON(e),null!==this._colorsTexture&&(a.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(a.boundingSphere={center:a.boundingSphere.center.toArray(),radius:a.boundingSphere.radius}),null!==this.boundingBox)&&(a.boundingBox={min:a.boundingBox.min.toArray(),max:a.boundingBox.max.toArray()}),this.isScene)this.background&&(this.background.isColor?a.background=this.background.toJSON():this.background.isTexture&&(a.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(a.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){a.geometry=f(e.geometries,this.geometry);var l=this.geometry.parameters;if(void 0!==l&&void 0!==l.shapes){var c=l.shapes;if(Array.isArray(c))for(var v=0,y=c.length;v<y;v++){var d=c[v];f(e.shapes,d)}else f(e.shapes,c)}}if(this.isSkinnedMesh&&(a.bindMode=this.bindMode,a.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton)&&(f(e.skeletons,this.skeleton),a.skeleton=this.skeleton.uuid),void 0!==this.material)if(Array.isArray(this.material)){for(var b=[],p=0,m=this.material.length;p<m;p++)b.push(f(e.materials,this.material[p]));a.material=b}else a.material=f(e.materials,this.material);if(0<this.children.length){a.children=[];for(var w=0;w<this.children.length;w++)a.children.push(this.children[w].toJSON(e).object)}if(0<this.animations.length){a.animations=[];for(var k=0;k<this.animations.length;k++){var g=this.animations[k];a.animations.push(f(e.animations,g))}}return h&&(l=A(e.geometries),h=A(e.materials),t=A(e.textures),i=A(e.images),n=A(e.shapes),r=A(e.skeletons),s=A(e.animations),o=A(e.nodes),0<l.length&&(u.geometries=l),0<h.length&&(u.materials=h),0<t.length&&(u.textures=t),0<i.length&&(u.images=i),0<n.length&&(u.shapes=n),0<r.length&&(u.skeletons=r),0<s.length&&(u.animations=s),0<o.length)&&(u.nodes=o),u.object=a,u;function A(t){var i,e=[];for(i in t){var n=t[i];delete n.metadata,e.push(n)}return e}}},{key:"clone",value:function(t){return(new this.constructor).copy(this,t)}},{key:"copy",value:function(t){var i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(var e=0;e<t.children.length;e++){var n=t.children[e];this.add(n.clone())}return this}}])&&Ji(i.prototype,e),t&&Ji(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i})(),i=(ae.DEFAULT_UP=new U(0,1,0),ae.DEFAULT_MATRIX_AUTO_UPDATE=!0,ae.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0,{BROWSER:0,WX:1});Object.freeze(i);Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function fe(t){return(fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function le(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=fe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=fe(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==fe(t)?t:t+""))(n.key),n)}}function ce(t,i,e){i=ye(i);var n=t,i=ve()?Reflect.construct(i,e||[],ye(t).constructor):i.apply(t,e);if(!i||"object"!=fe(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=n))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function ve(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(ve=function(){return!!t})()}function ye(t){return(ye=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function de(t,i){return(de=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}var be=0,j=new m,pe=new ae,me=new U,E=new ni,we=new ni,O=new U,ke=(()=>{function p(){var t;if(this instanceof p)return(t=ce(this,p)).isBufferGeometry=!0,Object.defineProperty(t,"id",{value:be++}),t.uuid=L(),t.name="",t.type="BufferGeometry",t.index=null,t.attributes={},t.morphAttributes={},t.morphTargetsRelative=!1,t.groups=[],t.boundingBox=null,t.boundingSphere=null,t.drawRange={start:0,count:1/0},t.userData={},t;throw new TypeError("Cannot call a class as a function")}var t,i=p,e=yi;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");return i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&de(i,e),i=p,(e=[{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(t){return Array.isArray(t)?this.index=new((t=>{for(var i=t.length-1;0<=i;--i)if(65535<=t[i])return 1})(t)?Oi:Ei)(t,1):this.index=t,this}},{key:"getAttribute",value:function(t){return this.attributes[t]}},{key:"setAttribute",value:function(t,i){return this.attributes[t]=i,this}},{key:"deleteAttribute",value:function(t){return delete this.attributes[t],this}},{key:"hasAttribute",value:function(t){return void 0!==this.attributes[t]}},{key:"addGroup",value:function(t,i){this.groups.push({start:t,count:i,materialIndex:2<arguments.length&&void 0!==arguments[2]?arguments[2]:0})}},{key:"clearGroups",value:function(){this.groups=[]}},{key:"setDrawRange",value:function(t,i){this.drawRange.start=t,this.drawRange.count=i}},{key:"applyMatrix4",value:function(t){var i=this.attributes.position,i=(void 0!==i&&(i.applyMatrix4(t),i.needsUpdate=!0),this.attributes.normal),e=(void 0!==i&&(e=(new Dt).getNormalMatrix(t),i.applyNormalMatrix(e),i.needsUpdate=!0),this.attributes.tangent);return void 0!==e&&(e.transformDirection(t),e.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"applyQuaternion",value:function(t){return j.makeRotationFromQuaternion(t),this.applyMatrix4(j),this}},{key:"rotateX",value:function(t){return j.makeRotationX(t),this.applyMatrix4(j),this}},{key:"rotateY",value:function(t){return j.makeRotationY(t),this.applyMatrix4(j),this}},{key:"rotateZ",value:function(t){return j.makeRotationZ(t),this.applyMatrix4(j),this}},{key:"translate",value:function(t,i,e){return j.makeTranslation(t,i,e),this.applyMatrix4(j),this}},{key:"scale",value:function(t,i,e){return j.makeScale(t,i,e),this.applyMatrix4(j),this}},{key:"lookAt",value:function(t){return pe.lookAt(t),pe.updateMatrix(),this.applyMatrix4(pe.matrix),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(me).negate(),this.translate(me.x,me.y,me.z),this}},{key:"setFromPoints",value:function(t){for(var i=[],e=0,n=t.length;e<n;e++){var r=t[e];i.push(r.x,r.y,r.z||0)}return this.setAttribute("position",new xi(i,3)),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new ni);var t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new U(-1/0,-1/0,-1/0),new U(1/0,1/0,1/0));else{if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),i)for(var e=0,n=i.length;e<n;e++){var r=i[e];E.setFromBufferAttribute(r),this.morphTargetsRelative?(O.addVectors(this.boundingBox.min,E.min),this.boundingBox.expandByPoint(O),O.addVectors(this.boundingBox.max,E.max),this.boundingBox.expandByPoint(O)):(this.boundingBox.expandByPoint(E.min),this.boundingBox.expandByPoint(E.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new Ni);var t=this.attributes.position,i=this.morphAttributes.position;if(t&&t.isGLBufferAttribute)console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new U,1/0);else if(t){var e=this.boundingSphere.center;if(E.setFromBufferAttribute(t),i)for(var n=0,r=i.length;n<r;n++){var s=i[n];we.setFromBufferAttribute(s),this.morphTargetsRelative?(O.addVectors(E.min,we.min),E.expandByPoint(O),O.addVectors(E.max,we.max),E.expandByPoint(O)):(E.expandByPoint(we.min),E.expandByPoint(we.max))}E.getCenter(e);for(var o=0,h=0,u=t.count;h<u;h++)O.fromBufferAttribute(t,h),o=Math.max(o,e.distanceToSquared(O));if(i)for(var a=0,f=i.length;a<f;a++)for(var l=i[a],c=this.morphTargetsRelative,v=0,y=l.count;v<y;v++)O.fromBufferAttribute(l,v),c&&(me.fromBufferAttribute(t,v),O.add(me)),o=Math.max(o,e.distanceToSquared(O));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeTangents",value:function(){var t=this.index,i=this.attributes;if(null===t||void 0===i.position||void 0===i.normal||void 0===i.uv)console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");else{for(var e=i.position,n=i.normal,r=i.uv,s=(!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new ji(new Float32Array(4*e.count),4)),this.getAttribute("tangent")),o=[],h=[],u=0;u<e.count;u++)o[u]=new U,h[u]=new U;for(var a,f,l,c,v=new U,y=new U,d=new U,b=new G,p=new G,m=new G,w=new U,k=new U,g=this.groups,A=0,M=(g=0===g.length?[{start:0,count:t.count}]:g).length;A<M;++A)for(var S=g[A],j=S.start,E=j,L=j+S.count;E<L;E+=3)a=t.getX(E+0),f=t.getX(E+1),l=t.getX(E+2),c=void 0,v.fromBufferAttribute(e,a),y.fromBufferAttribute(e,f),d.fromBufferAttribute(e,l),b.fromBufferAttribute(r,a),p.fromBufferAttribute(r,f),m.fromBufferAttribute(r,l),y.sub(v),d.sub(v),p.sub(b),m.sub(b),c=1/(p.x*m.y-m.x*p.y),isFinite(c)&&(w.copy(y).multiplyScalar(m.y).addScaledVector(d,-p.y).multiplyScalar(c),k.copy(d).multiplyScalar(p.x).addScaledVector(y,-m.x).multiplyScalar(c),o[a].add(w),o[f].add(w),o[l].add(w),h[a].add(k),h[f].add(k),h[l].add(k));for(var O=new U,x=new U,R=new U,T=new U,I=0,F=g.length;I<F;++I)for(var C=g[I],B=C.start,N=B,D=B+C.count;N<D;N+=3)P(t.getX(N+0)),P(t.getX(N+1)),P(t.getX(N+2))}function P(t){R.fromBufferAttribute(n,t),T.copy(R);var i=o[t],i=(O.copy(i),O.sub(R.multiplyScalar(R.dot(i))).normalize(),x.crossVectors(T,i),x.dot(h[t]));s.setXYZW(t,O.x,O.y,O.z,i<0?-1:1)}}},{key:"computeVertexNormals",value:function(){var t=this.index,i=this.getAttribute("position");if(void 0!==i){var e=this.getAttribute("normal");if(void 0===e)e=new ji(new Float32Array(3*i.count),3),this.setAttribute("normal",e);else for(var n=0,r=e.count;n<r;n++)e.setXYZ(n,0,0,0);var s=new U,o=new U,h=new U,u=new U,a=new U,f=new U,l=new U,c=new U;if(t)for(var v=0,y=t.count;v<y;v+=3){var d=t.getX(v+0),b=t.getX(v+1),p=t.getX(v+2);s.fromBufferAttribute(i,d),o.fromBufferAttribute(i,b),h.fromBufferAttribute(i,p),l.subVectors(h,o),c.subVectors(s,o),l.cross(c),u.fromBufferAttribute(e,d),a.fromBufferAttribute(e,b),f.fromBufferAttribute(e,p),u.add(l),a.add(l),f.add(l),e.setXYZ(d,u.x,u.y,u.z),e.setXYZ(b,a.x,a.y,a.z),e.setXYZ(p,f.x,f.y,f.z)}else for(var m=0,w=i.count;m<w;m+=3)s.fromBufferAttribute(i,m+0),o.fromBufferAttribute(i,m+1),h.fromBufferAttribute(i,m+2),l.subVectors(h,o),c.subVectors(s,o),l.cross(c),e.setXYZ(m+0,l.x,l.y,l.z),e.setXYZ(m+1,l.x,l.y,l.z),e.setXYZ(m+2,l.x,l.y,l.z);this.normalizeNormals(),e.needsUpdate=!0}}},{key:"normalizeNormals",value:function(){for(var t=this.attributes.normal,i=0,e=t.count;i<e;i++)O.fromBufferAttribute(t,i),O.normalize(),t.setXYZ(i,O.x,O.y,O.z)}},{key:"toNonIndexed",value:function(){function t(t,i){for(var e=t.array,n=t.itemSize,r=t.normalized,s=new e.constructor(i.length*n),o=0,h=0,u=0,a=i.length;u<a;u++)for(var o=t.isInterleavedBufferAttribute?i[u]*t.data.stride+t.offset:i[u]*n,f=0;f<n;f++)s[h++]=e[o++];return new ji(s,n,r)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var i,e=new p,n=this.index.array,r=this.attributes;for(i in r){var s=t(r[i],n);e.setAttribute(i,s)}var o,h=this.morphAttributes;for(o in h){for(var u=[],a=h[o],f=0,l=a.length;f<l;f++){var c=t(a[f],n);u.push(c)}e.morphAttributes[o]=u}e.morphTargetsRelative=this.morphTargetsRelative;for(var v=this.groups,y=0,d=v.length;y<d;y++){var b=v[y];e.addGroup(b.start,b.count,b.materialIndex)}return e}},{key:"toJSON",value:function(){var t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),0<Object.keys(this.userData).length&&(t.userData=this.userData),void 0!==this.parameters){var i,e=this.parameters;for(i in e)void 0!==e[i]&&(t[i]=e[i])}else{t.data={attributes:{}};var n,r=this.index,s=(null!==r&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)}),this.attributes);for(n in s){var o=s[n];t.data.attributes[n]=o.toJSON(t.data)}var h,u={},a=!1;for(h in this.morphAttributes){for(var f=this.morphAttributes[h],l=[],c=0,v=f.length;c<v;c++){var y=f[c];l.push(y.toJSON(t.data))}0<l.length&&(u[h]=l,a=!0)}a&&(t.data.morphAttributes=u,t.data.morphTargetsRelative=this.morphTargetsRelative);r=this.groups,r=(0<r.length&&(t.data.groups=JSON.parse(JSON.stringify(r))),this.boundingSphere);null!==r&&(t.data.boundingSphere={center:r.center.toArray(),radius:r.radius})}return t}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var i,e={},n=(this.name=t.name,t.index),r=(null!==n&&this.setIndex(n.clone(e)),t.attributes);for(i in r){var s=r[i];this.setAttribute(i,s.clone(e))}var o,h=t.morphAttributes;for(o in h){for(var u=[],a=h[o],f=0,l=a.length;f<l;f++)u.push(a[f].clone(e));this.morphAttributes[o]=u}this.morphTargetsRelative=t.morphTargetsRelative;for(var c=t.groups,v=0,y=c.length;v<y;v++){var d=c[v];this.addGroup(d.start,d.count,d.materialIndex)}n=t.boundingBox,null!==n&&(this.boundingBox=n.clone()),n=t.boundingSphere;return null!==n&&(this.boundingSphere=n.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}])&&le(i.prototype,e),t&&le(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i})();function ge(t){return(ge="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ae(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=ge(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=ge(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==ge(t)?t:t+""))(n.key),n)}}function Me(t,i,e){i=je(i);var n=t,i=Se()?Reflect.construct(i,e||[],je(t).constructor):i.apply(t,e);if(!i||"object"!=ge(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=n))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function Se(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Se=function(){return!!t})()}function je(t){return(je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ee(t,i){return(Ee=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}var Oe=0,xe=(()=>{function i(){var t;if(this instanceof i)return(t=Me(this,i)).isMaterial=!0,Object.defineProperty(t,"id",{value:Oe++}),t.uuid=L(),t.name="",t.type="Material",t.blending=1,t.side=0,t.vertexColors=!1,t.opacity=1,t.transparent=!1,t.alphaHash=!1,t.blendSrc=204,t.blendDst=205,t.blendEquation=100,t.blendSrcAlpha=null,t.blendDstAlpha=null,t.blendEquationAlpha=null,t.blendColor=new y(0,0,0),t.blendAlpha=0,t.depthFunc=3,t.depthTest=!0,t.depthWrite=!0,t.stencilWriteMask=255,t.stencilFunc=519,t.stencilRef=0,t.stencilFuncMask=255,t.stencilFail=$,t.stencilZFail=$,t.stencilZPass=$,t.stencilWrite=!1,t.clippingPlanes=null,t.clipIntersection=!1,t.clipShadows=!1,t.shadowSide=null,t.colorWrite=!0,t.precision=null,t.polygonOffset=!1,t.polygonOffsetFactor=0,t.polygonOffsetUnits=0,t.dithering=!1,t.alphaToCoverage=!1,t.premultipliedAlpha=!1,t.forceSinglePass=!1,t.visible=!0,t.toneMapped=!0,t.userData={},t.version=0,t.I=Xt,t;throw new TypeError("Cannot call a class as a function")}var t,e=i,n=yi;if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");return e.prototype=Object.create(n&&n.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),n&&Ee(e,n),e=i,(n=[{key:"alphaTest",get:function(){return this.I},set:function(t){0<this.I!=0<t&&this.version++,this.I=t}},{key:"onBeforeRender",value:function(){}},{key:"onBeforeCompile",value:function(){}},{key:"customProgramCacheKey",value:function(){return this.onBeforeCompile.toString()}},{key:"setValues",value:function(t){if(void 0!==t)for(var i in t){var e,n=t[i];void 0===n?console.warn("THREE.Material: parameter '".concat(i,"' has value of undefined.")):void 0===(e=this[i])?console.warn("THREE.Material: '".concat(i,"' is not a property of THREE.").concat(this.type,".")):e&&e.isColor?e.set(n):e&&e.isVector3&&n&&n.isVector3?e.copy(n):this[i]=n}}},{key:"toJSON",value:function(t){var i=void 0===t||"string"==typeof t,e=(i&&(t={textures:{},images:{}}),{metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}});function n(t){var i,e=[];for(i in t){var n=t[i];delete n.metadata,e.push(n)}return e}return e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),this.color&&this.color.isColor&&(e.color=this.color.getHex()),void 0!==this.roughness&&(e.roughness=this.roughness),void 0!==this.metalness&&(e.metalness=this.metalness),void 0!==this.sheen&&(e.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(e.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(e.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(e.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(e.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(e.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(e.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(e.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(e.shininess=this.shininess),void 0!==this.clearcoat&&(e.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(e.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(e.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(e.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(e.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,e.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(e.dispersion=this.dispersion),void 0!==this.iridescence&&(e.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(e.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(e.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(e.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(e.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),void 0!==this.anisotropy&&(e.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(e.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(e.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(e.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(e.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(e.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(e.lightMap=this.lightMap.toJSON(t).uuid,e.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(e.aoMap=this.aoMap.toJSON(t).uuid,e.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(e.bumpMap=this.bumpMap.toJSON(t).uuid,e.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(e.normalMap=this.normalMap.toJSON(t).uuid,e.normalMapType=this.normalMapType,e.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(e.displacementMap=this.displacementMap.toJSON(t).uuid,e.displacementScale=this.displacementScale,e.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(e.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(e.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(e.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(e.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(e.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(e.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(e.envMap=this.envMap.toJSON(t).uuid,void 0!==this.combine)&&(e.combine=this.combine),void 0!==this.envMapRotation&&(e.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(e.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(e.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(e.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(e.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.transmission&&(e.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(e.transmissionMap=this.transmissionMap.toJSON(t).uuid),void 0!==this.thickness&&(e.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(e.thicknessMap=this.thicknessMap.toJSON(t).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(e.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(e.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(e.size=this.size),null!==this.shadowSide&&(e.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(e.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(e.blending=this.blending),0!==this.side&&(e.side=this.side),!0===this.vertexColors&&(e.vertexColors=!0),this.opacity<1&&(e.opacity=this.opacity),!0===this.transparent&&(e.transparent=!0),204!==this.blendSrc&&(e.blendSrc=this.blendSrc),205!==this.blendDst&&(e.blendDst=this.blendDst),100!==this.blendEquation&&(e.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(e.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(e.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(e.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(e.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(e.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(e.depthFunc=this.depthFunc),!1===this.depthTest&&(e.depthTest=this.depthTest),!1===this.depthWrite&&(e.depthWrite=this.depthWrite),!1===this.colorWrite&&(e.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(e.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(e.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(e.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(e.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==$&&(e.stencilFail=this.stencilFail),this.stencilZFail!==$&&(e.stencilZFail=this.stencilZFail),this.stencilZPass!==$&&(e.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(e.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(e.rotation=this.rotation),!0===this.polygonOffset&&(e.polygonOffset=!0),0!==this.polygonOffsetFactor&&(e.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(e.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(e.linewidth=this.linewidth),void 0!==this.dashSize&&(e.dashSize=this.dashSize),void 0!==this.gapSize&&(e.gapSize=this.gapSize),void 0!==this.scale&&(e.scale=this.scale),!0===this.dithering&&(e.dithering=!0),0<this.alphaTest&&(e.alphaTest=this.alphaTest),!0===this.alphaHash&&(e.alphaHash=!0),!0===this.alphaToCoverage&&(e.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(e.premultipliedAlpha=!0),!0===this.forceSinglePass&&(e.forceSinglePass=!0),!0===this.wireframe&&(e.wireframe=!0),1<this.wireframeLinewidth&&(e.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(e.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(e.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(e.flatShading=!0),!1===this.visible&&(e.visible=!1),!1===this.toneMapped&&(e.toneMapped=!1),!1===this.fog&&(e.fog=!1),0<Object.keys(this.userData).length&&(e.userData=this.userData),i&&(i=n(t.textures),t=n(t.images),0<i.length&&(e.textures=i),0<t.length)&&(e.images=t),e}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var i=t.clippingPlanes,e=null;if(null!==i)for(var n=i.length,e=new Array(n),r=0;r!==n;++r)e[r]=i[r].clone();return this.clippingPlanes=e,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"needsUpdate",set:function(t){!0===t&&this.version++}},{key:"onBuild",value:function(){console.warn("Material: onBuild() has been removed.")}}])&&Ae(e.prototype,n),t&&Ae(e,t),Object.defineProperty(e,"prototype",{writable:!1}),e})();function Re(t){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Te(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=Re(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Re(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Re(t)?t:t+""))(n.key),n)}}function Ie(t,i,e){i=Ne(i);var n=t,i=Ce()?Reflect.construct(i,e||[],Ne(t).constructor):i.apply(t,e);if(!i||"object"!=Re(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=n))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function Ce(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ce=function(){return!!t})()}function Be(){return(Be="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,e){var n=((t,i)=>{for(;!{}.hasOwnProperty.call(t,i)&&null!==(t=Ne(t)););return t})(t,i);if(n)return(n=Object.getOwnPropertyDescriptor(n,i)).get?n.get.call(arguments.length<3?t:e):n.value}).apply(null,arguments)}function Ne(t){return(Ne=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Pe(t,i){return(Pe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}var Le=(()=>{function o(t){var i;if(this instanceof o)return(i=Ie(this,o)).isLineBasicMaterial=!0,i.type="LineBasicMaterial",i.color=new y(16777215),i.map=null,i.linewidth=1,i.linecap="round",i.linejoin="round",i.fog=!0,i.setValues(t),i;throw new TypeError("Cannot call a class as a function")}var t,i=o,e=xe;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");return i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Pe(i,e),i=o,(e=[{key:"copy",value:function(t){var i,e,n,r,s;return i=o,e="copy",n=this,s=Be(Ne(1&(r=3)?i.prototype:i),e,n),(2&r&&"function"==typeof s?function(t){return s.apply(n,t)}:s)([t]),this.color.copy(t.color),this.map=t.map,this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}])&&Te(i.prototype,e),t&&Te(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i})();function Fe(t){return(Fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function De(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=Fe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Fe(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Fe(t)?t:t+""))(n.key),n)}}function Ge(t,i,e){i=_e(i);var n=t,i=Ue()?Reflect.construct(i,e||[],_e(t).constructor):i.apply(t,e);if(!i||"object"!=Fe(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=n))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function Ue(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Ue=function(){return!!t})()}function Ye(){return(Ye="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,e){var n=((t,i)=>{for(;!{}.hasOwnProperty.call(t,i)&&null!==(t=_e(t)););return t})(t,i);if(n)return(n=Object.getOwnPropertyDescriptor(n,i)).get?n.get.call(arguments.length<3?t:e):n.value}).apply(null,arguments)}function _e(t){return(_e=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ve(t,i){return(Ve=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}var Je=new U,Ze=new U,He=new m,Qe=new Et,Xe=new Ni,ze=new U,Ke=new U,We=(()=>{function h(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new ke,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new Le,e=this,n=h;if(e instanceof n)return(e=Ge(this,h)).isLine=!0,e.type="Line",e.geometry=t,e.material=i,e.updateMorphTargets(),e;throw new TypeError("Cannot call a class as a function")}var t,i=h,e=ae;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");return i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Ve(i,e),i=h,(e=[{key:"copy",value:function(t,i){var e,n,r,s,o;return e=h,n="copy",r=this,o=Ye(_e(1&(s=3)?e.prototype:e),n,r),(2&s&&"function"==typeof o?function(t){return o.apply(r,t)}:o)([t,i]),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}},{key:"computeLineDistances",value:function(){var t=this.geometry;if(null===t.index){for(var i=t.attributes.position,e=[0],n=1,r=i.count;n<r;n++)Je.fromBufferAttribute(i,n-1),Ze.fromBufferAttribute(i,n),e[n]=e[n-1],e[n]+=Je.distanceTo(Ze);t.setAttribute("lineDistance",new xi(e,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},{key:"raycast",value:function(t,i){var e=this.geometry,n=this.matrixWorld,r=t.params.Line.threshold,s=e.drawRange;if(null===e.boundingSphere&&e.computeBoundingSphere(),Xe.copy(e.boundingSphere),Xe.applyMatrix4(n),Xe.radius+=r,!1!==t.ray.intersectsSphere(Xe)){He.copy(n).invert(),Qe.copy(t.ray).applyMatrix4(He);var n=r/((this.scale.x+this.scale.y+this.scale.z)/3),o=n*n,h=this.isLineSegments?2:1,u=e.index,r=e.attributes.position;if(null!==u){for(var n=Math.max(0,s.start),e=Math.min(u.count,s.start+s.count),a=n,f=e-1;a<f;a+=h){var l=u.getX(a),c=u.getX(a+1),l=qe(this,t,Qe,o,l,c);l&&i.push(l)}this.isLineLoop&&(e=u.getX(e-1),n=u.getX(n),e=qe(this,t,Qe,o,e,n))&&i.push(e)}else{for(var n=Math.max(0,s.start),e=Math.min(r.count,s.start+s.count),v=n,y=e-1;v<y;v+=h){var d=qe(this,t,Qe,o,v,v+1);d&&i.push(d)}this.isLineLoop&&(r=qe(this,t,Qe,o,e-1,n))&&i.push(r)}}}},{key:"updateMorphTargets",value:function(){var t=this.geometry.morphAttributes,i=Object.keys(t);if(0<i.length){var e=t[i[0]];if(void 0!==e){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var n=0,r=e.length;n<r;n++){var s=e[n].name||String(n);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=n}}}}}])&&De(i.prototype,e),t&&De(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i})();function qe(t,i,e,n,r,s){var o=t.geometry.attributes.position,o=(Je.fromBufferAttribute(o,r),Ze.fromBufferAttribute(o,s),e.distanceSqToSegment(Je,Ze,ze,Ke));if(!(n<o)){ze.applyMatrix4(t.matrixWorld);s=i.ray.origin.distanceTo(ze);if(!(s<i.near||s>i.far))return{distance:s,point:Ke.clone().applyMatrix4(t.matrixWorld),index:r,face:null,faceIndex:null,barycoord:null,object:t}}}function $e(t){return($e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function tn(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=$e(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=$e(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==$e(t)?t:t+""))(n.key),n)}}function en(t,i,e){return i&&tn(t.prototype,i),e&&tn(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}var t=en(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.C=!0,this.T={}}),nn=(Object.assign(t.prototype,{B:function(t,i){this.N(t,i)||(void 0===this.T[t]&&(this.T[t]=[]),this.T[t].push(i))},N:function(t,i){return i?void 0!==this.T[t]&&-1!==this.T[t].indexOf(i):void 0!==this.T[t]&&0<this.T[t].length},P:function(t,i){void 0!==this.T[t]&&-1!==(i=this.T[t].indexOf(i))&&this.T[t].splice(i,1)},L:function(t){if(this.C&&void 0!==this.T[t.type])for(var i=this.T[t.type].slice(0),e=0,n=i.length;e<n;e++)i[e].call(this,t)}}),t),i={NONE:0,EXTRUDE_MARKER:2,FM3DTILE_LAYER:4,IMAGE_MARKER:8,LOCATION_MARKER:16,POLYGON_MARKER:32,TEXT_MARKER:64,LINE_MARKER:128,LINE3D_MARKER:256,HEAT_MAP_MARKER:512,EXTENT:1024,EXTERNAL_MODEL:2048,MODEL:4096,FACILITY:8192,LABEL:16384,DYNAMIC_MODEL_MARKER:32768,DOM_MARKER:65536,SPHERE_MARKER:1<<17,CAD_LAYER:1<<18,EXTENT_LAYER:1<<20,EXTERNAL_MODEL_LAYER:1<<21,MODEL_LAYER:1<<22,FACILITY_LAYER:1<<23,LABEL_LAYER:1<<24,MARKER_GROUP:1<<25,FLOW_LINE_LAYER:1<<27,FLOW_LINE_MARKER:1<<27,FIRE_MARKER:1<<28,WALL_MARKER:1<<29,TUBE_MARKER:1<<30},T=(i.LAYER_NODE_TYPE=new Map,i.LAYER_NODE_TYPE.set(i.EXTENT_LAYER,i.EXTENT),i.LAYER_NODE_TYPE.set(i.EXTERNAL_MODEL_LAYER,i.EXTERNAL_MODEL),i.LAYER_NODE_TYPE.set(i.MODEL_LAYER,i.MODEL),i.LAYER_NODE_TYPE.set(i.FACILITY_LAYER,i.FACILITY),i.LAYER_NODE_TYPE.set(i.LABEL_LAYER,i.LABEL),i.LAYER_NODE_TYPE.set(i.DOM_MARKER,i.DOM_MARKER),i.LAYER_NODE_TYPE.set(i.DYNAMIC_MODEL_MARKER,i.DYNAMIC_MODEL_MARKER),i.LAYER_NODE_TYPE.set(i.EXTRUDE_MARKER,i.EXTRUDE_MARKER),i.LAYER_NODE_TYPE.set(i.HEAT_MAP_MARKER,i.HEAT_MAP_MARKER),i.LAYER_NODE_TYPE.set(i.LINE_MARKER,i.LINE_MARKER),i.LAYER_NODE_TYPE.set(i.LOCATION_MARKER,i.LOCATION_MARKER),i.LAYER_NODE_TYPE.set(i.POLYGON_MARKER,i.POLYGON_MARKER),i.LAYER_NODE_TYPE.set(i.TEXT_MARKER,i.TEXT_MARKER),i.LAYER_NODE_TYPE.set(i.IMAGE_MARKER,i.IMAGE_MARKER),i.LAYER_NODE_TYPE.set(i.FLOW_LINE_LAYER,i.FLOW_LINE_MARKER),i.LAYER_NODE_TYPE.set(i.FIRE_MARKER,i.FIRE_MARKER),i.LAYER_NODE_TYPE.set(i.WALL_MARKER,i.WALL_MARKER),i.LAYER_NODE_TYPE.set(i.TUBE_MARKER,i.TUBE_MARKER),i.LAYER_NODE_TYPE.set(i.LINE3D_MARKER,i.LINE3D_MARKER),i.LAYER_NODE_TYPE.set(i.SPHERE_MARKER,i.SPHERE_MARKER),i.LAYER_NODE_TYPE.set(i.CAD_LAYER,i.CAD_LAYER),i);function rn(t,i){return(t=>{if(Array.isArray(t))return t})(t)||((t,i)=>{var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,s,o,h=[],u=!0,a=!1;try{if(s=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;u=!1}else for(;!(u=(n=s.call(e)).done)&&(h.push(n.value),h.length!==i);u=!0);}catch(t){a=!0,r=t}finally{try{if(!u&&null!=e.return&&(o=e.return(),Object(o)!==o))return}finally{if(a)throw r}}return h}})(t,i)||sn(t,i)||(()=>{throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function sn(t,i){var e;if(t)return"string"==typeof t?on(t,i):"Map"===(e="Object"===(e={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?on(t,i):void 0}function on(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,n=Array(i);e<i;e++)n[e]=t[e];return n}function hn(i,t){var e,n=Object.keys(i);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(i),t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})),n.push.apply(n,e)),n}function un(n){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hn(Object(r),!0).forEach(function(t){var i,e;i=n,e=r[t=t],(t=ln(t))in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):hn(Object(r)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))})}return n}function an(t){return(an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function fn(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,ln(n.key),n)}}function ln(t){t=((t,i)=>{if("object"!=an(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=an(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string");return"symbol"==an(t)?t:t+""}t=(()=>{function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.F=t,this.D="none",this.currentobj=null,this.G={url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QoOAiAd1TTTFgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAABfElEQVRYw81XO26EMBB9poAIrBwh2hPgMt1WS7cSN+AonAXtIahSpfLWVNtFewXLkG7SeCVIbH5rBZ40jYGZ8fjxPMOwDAcARwAnAO8A3sz6HcAVwAeATwBf8IgIQAGgA0AzrTPfRM8GPy8I6rLz2l1fPAR/2GVJNV4B3DwGf9jN+J7cuTM4Y4yEEFSWJUkpSWtNWmuSUlJZliSEIMbYVBKjlXCWPcsyUkrRFJRSlGXZ1HHMJ1wYhlRVFS1FVVUUhuFsYkau4FJKWgsp5VgSg6MobC+t2bmtEo4Ein4Cne3MfcHBia4vr3/YPodwc6GUcv0dh8Bo+wBpmoJz7k3LOedI09T26BiYi2WAPM/hGw6fJ9iE5xnmj/0RNmFihgwv/bS01ojj2GsF2rZFkiS/l78DbIzANBMDNE3jPZDD5z0wncwAdV17T8Dh82pVQSGEdxIKIZxquKkQ7UKKd3EZbX4db96Q7KIl20VTunlbvovBZBej2b8Np2zr8fwHFGE/6k/Mu0oAAAAASUVORK5CYII=",size:32,height:1,collision:!1},this.U={width:5,type:mt.FULL,color:"#FF0000",height:3},this.Y={color:"#FF0000",borderWidth:3,borderColor:"#0000FF",opacity:.5,height:3},this._="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QocCDgHXcqo9wAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAEQ0lEQVRYw71XTWhcVRg9584kVGzHZKYlTFpsJ/PeKBaKMjN05aYIKgguupASqaKCC1cFVxaSaQW7dSW4KRFBEETEje5qtWK1SdP409L0zZgpJrEtvqY/qebNe/e46KSZDMkkmSR9mwdz35zv3O8737nfJdbxuG7xdQp7EfCj8au//NkORqzd4Lls8S0SgzR8UTHbm0qlr/r+9ORDIZDLFt6B4SDJXQBAci/AbHeyd8L3p6qbSsB1C++SLJHc0fg7yQyFbFd37z83b05d3hQCrls8SrBEcutS6yR3k8wnU713fH9qbEMJuG7hPYIDAAyAGsl447qk6wDmACQIPJVMpWd8f/r3lXDjqwne07PvUQmXBfUbKQS5U8AAyZ568LNW0RGJAalOyRgTRbN1srYVNtsR4Z49hSc6O3iKZBoArPTjzMzsCzduXLy7VizTDgGSAqCGXdDaqK3NmI0S6PYVSrgmAq6bP+S6+cKyzGI2WlxbsRWDbds6D7hu/vCqCOScwquAGaSNpZcDrNXCCEDYWJQoeowtSpYizIDrFl9rScBxiv0gBwn2yWhZwI4OGy4ioNZilhAA2G2AweZMxBvs9RVQA6RxJNQAPJ3LFW8jVCeoTruo77mjqYUTgD3oOIXbS6dZ++9LlRnKDDhOMfS8c589aEPHKRw0xDHS7G0wlrsADSBTz5RpSmuzEYUrdE584Vt7EVZHx8sjXzGXzb8sY44bch8e4mOlc5I9akA+u1xwafG7YWXdBAxZNOBLcYvwpLEdvTQ8tCiE1Q8wGJMQSYoEhhRrov6jkAD1Jsnk/Dkg4AsCNUgEDAFRBAGQQo6GzzWV7DsLfFnXQD5rYAZoeHh+h7I6Mu4Nf7gU+76+/ONxY07RsK9O9ufQ2ucrlZFbS33vOMV+Q3xCMvYguFTyvOHTBgA8b6Q8VwsGZe3QfHrZIs9RZAIRwarTfb+rVK/9mcja4543fHqRD1SrYxNBGJUEDa0IaMyaRGCpCKBk7RgjfVAuj5xa0ogmJkarsVhUkrVDUYtTlPxXBKM1HF5WUhnCifHK8DctrfjSpdFqENpSLDTfLgcYBGEIaG61BKRoGrTHx8vDn69qIJmYGG05WG7ZsjUEtGoNeN75cwDOtj0RAUAms79nYUfBNjIeNQnzkXQ6XwMAa2sEgGvXfp2dX17XROQ4ToLsehvgGw1/dObtVcI9wf5kAAokYI3A74Hax1eujE2ueyj1fX8ukeiZjMXMk4Y8QHI7SbMgMnSQ6AOZIZERUJEw5Hmjv23YVDwz8/etVGJXBUZZktkmVwPJusfbr62N3i+Xz5/Z8HuBPzN5rTvZe5VAhuSehjabD/4pYEued2F0025Gvj9VTXalrwvMk9y+cHbYoaAWliqVC96m3w39m9NXUqn0HYDPkOiywslaGB2rVi9U14rV9u3Y96fHkqmd92T1x1ygE9Xq+b/awfkfmzntCAO/rwcAAAAASUVORK5CYII=",this.V="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5QoOAiAd1TTTFgAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAABfElEQVRYw81XO26EMBB9poAIrBwh2hPgMt1WS7cSN+AonAXtIahSpfLWVNtFewXLkG7SeCVIbH5rBZ40jYGZ8fjxPMOwDAcARwAnAO8A3sz6HcAVwAeATwBf8IgIQAGgA0AzrTPfRM8GPy8I6rLz2l1fPAR/2GVJNV4B3DwGf9jN+J7cuTM4Y4yEEFSWJUkpSWtNWmuSUlJZliSEIMbYVBKjlXCWPcsyUkrRFJRSlGXZ1HHMJ1wYhlRVFS1FVVUUhuFsYkau4FJKWgsp5VgSg6MobC+t2bmtEo4Ein4Cne3MfcHBia4vr3/YPodwc6GUcv0dh8Bo+wBpmoJz7k3LOedI09T26BiYi2WAPM/hGw6fJ9iE5xnmj/0RNmFihgwv/bS01ojj2GsF2rZFkiS/l78DbIzANBMDNE3jPZDD5z0wncwAdV17T8Dh82pVQSGEdxIKIZxquKkQ7UKKd3EZbX4db96Q7KIl20VTunlbvovBZBej2b8Np2zr8fwHFGE/6k/Mu0oAAAAASUVORK5CYII=",this.objectArray=[],this.J=[],this.Z=[],this.H=[],this.X=[],this.K=null,this.W=null,this.q=null,this.$=null,this.tt=void 0,this.it="#FF0000",this.et=this.F.getRenderManager().renderer.domElement,this.nt=this.nt.bind(this),this.rt=this.rt.bind(this),this.st=this.st.bind(this),this.ot=new Bt,this.ht=new nn,this.ut=null,this.ft=null,this.lt={},this.ct()}return t=i,(e=[{key:"editUrl",get:function(){return this.V},set:function(t){this.V=t}},{key:"centerUrl",get:function(){return this._},set:function(t){this._=t}},{key:"PointStyle",get:function(){return this.G},set:function(t){this.G=t}},{key:"operate",get:function(){return this.tt},set:function(t){this.tt=t;for(var i=0;i<this.H.length;i++)this.H[i].visible=!1,"move"===t?"center"===this.H[i]._opetype&&(this.H[i].visible=!0):"center"!==this.H[i]._opetype&&(this.H[i].visible=!0)}},{key:"LineStyle",get:function(){return this.U},set:function(t){this.U=t}},{key:"PolygonStyle",get:function(){return this.Y},set:function(t){this.Y=t}},{key:"DrawTool",get:function(){return this.D},set:function(t){if(this.D=t,"edit"!==this.D){for(var i=0;i<this.H.length;i++)this.H[i].remove();null!==this.ft&&(this.ft.parent.remove(this.ft),this.ft=null,this.F.enableUpdateRender()),this.J.length=0,this.Z.length=0,this.H.length=0,this.W=null,this.K=null}}},{key:"edit",value:function(t,i){if("none"===this.DrawTool||"edit"===this.DrawTool)if(t&&t.shapetype){if(!(0<this.H.length||null!==this.ft)&&(i||null==this.W||this.W.id!==t.id)&&(!t.opetype||"no"===t.opetype.type)){for(var e=0;e<this.H.length;e++)this.H[e].remove();null!==this.ft&&(this.ft.parent.remove(this.ft),this.ft=null,this.F.enableUpdateRender()),this.H.length=0,this.K=null,this.W=t,i||(this.$=t.id),t.type===T.POLYGON_MARKER?(this.vt(t),this.DrawTool="edit"):t.type===T.LINE_MARKER?(this.yt(t),this.DrawTool="edit"):t.type===T.IMAGE_MARKER&&(this.DrawTool="edit",this.q=null,this.dt(t))}}else{for(var n=0;n<this.H.length;n++)this.H[n].remove();this.H.length=0,(this.W=null)!==this.ft&&(this.ft.parent.remove(this.ft),this.ft=null,this.F.enableUpdateRender())}}},{key:"on",value:function(t,i){this.ht.B(t,i)}},{key:"dispose",value:function(){this.et.removeEventListener("mousedown",this.nt,!1),this.et.removeEventListener("mousemove",this.rt,!1),this.et.removeEventListener("mouseup",this.st,!1)}},{key:"createMarkerByInfo",value:function(t){var i;if("circle"===t.shapetype||"ellipse"===t.shapetype||"rect"===t.shapetype||"polygon"===t.shapetype)return i=new fengmap.FMPolygonMarkerEdit(t),r=this.F.getFloor(t.level),i.addTo(r),i.mapEdit=this,t.id&&(i.id=t.id),i;if("line"!==t.shapetype)return r=this.F.getFloor(t.level),(i=new fengmap.FMImageMarkerEdit(t)).addTo(r),i.mapEdit=this,t.id&&(i.id=t.id),i;var e=new fengmap.FMSegment;e.points=[];for(var n=0;n<t.points.length;n++)e.points.push({x:t.points[n].x,y:t.points[n].y,z:t.points[n].z});e.level=t.level,t.segments=[e];var r=new fengmap.FMLineMarkerEdit(t);return r.addTo(this.F),r.mapEdit=this,t.id&&(r.id=t.id),r}}])&&fn(t.prototype,e),n&&fn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n})(),Object.assign(t.prototype,{ct:function(){this.et.addEventListener("mousedown",this.nt,!1),this.et.addEventListener("mousemove",this.rt,!1),this.et.addEventListener("mouseup",this.st,!1)},bt:function(t,i){if(("none"===this.DrawTool||"edit"===this.DrawTool)&&(null!==this.ft&&(this.ft.parent.remove(this.ft),this.ft=null,this.F.enableUpdateRender()),t)&&(i||null==this.W||this.W.id!==t.id)&&(!t.opetype||"no"===t.opetype.type)){for(var e=0;e<this.H.length;e++)this.H[e].remove();this.H.length=0,this.K=null,this.W=t,i||(this.$=t.id),t.type===T.POLYGON_MARKER?(this.vt(t),this.DrawTool="edit"):t.type===T.LINE_MARKER?(this.yt(t),this.DrawTool="edit"):t.type===T.IMAGE_MARKER&&(this.DrawTool="edit",this.q=null,this.dt(t))}},wt:function(t){t=un({},t);return t.buildingID===this.F.getMapOptions().mapID&&(t.buildingID=null),t},kt:function(t,i){var e=new G;if(e.x=t/this.et.getBoundingClientRect().width*2-1,e.y=2*-(i/this.et.getBoundingClientRect().height)+1,"point"===this.W.shapetype)return t=[this.W.getRenderNode()],this.ot.setFromCamera(e,this.F.camera),0<(i=this.ot.intersectObjects(t,!0)).length?i[0].object:null;for(var n=[],r=0;r<this.H.length;r++)this.H[r].opetype.node.visible&&n.push(this.H[r].opetype.node);this.ot.setFromCamera(e,this.F.camera);t=this.ot.intersectObjects(n,!0);return 0<t.length?t[0].object:null},gt:function(t,i){var e=t.offsetX,t=t.offsetY,n=new U;n.x=e/this.et.clientWidth*2-1,n.y=2*-(t/this.et.clientHeight)+1,n.z=.5,this.ot.setFromCamera(n,this.F.camera);var r,s=null,o=((t,i)=>{var e,n,r,s,o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(t)},n:function(){var t=o.next();return n=t.done,t},e:function(t){r=!0,e=t},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw e}}};if(Array.isArray(t)||(o=sn(t))||i&&t&&"number"==typeof t.length)return o&&(t=o),s=0,{s:i=function(){},n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:i};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})(this.F.getRenderManager().getRenderList());try{for(o.s();!(r=o.n()).done;)for(var h=rn(r.value,2),u=(h[0],h[1]),a=this.ot.intersectObject(u,!0),f=0;f<a.length;f++)a[f].object.mapNode&&(s=a[f].object)}catch(t){o.e(t)}finally{o.f()}e=null;e=null!==s&&s.mapNode?s.mapNode.type!==T.LINE_MARKER?{buildingID:s.mapNode.parent.parent.parent.buildingID,level:s.mapNode.level}:{buildingID:(t=s.mapNode.segments[0]).buildingID,level:t.level}:{buildingID:this.F.getMapOptions().mapID,level:this.F.getLevel()},null===this.ut&&(this.ut=e),i&&i()},nt:function(n){var r=this;this.gt(n,function(){if("none"!==r.DrawTool)if(2===n.button)"edit"!==r.DrawTool?r.At():(null!==r.K||null!==r.W&&"point"===r.W.shapetype)&&r.Mt(),r.K=null,r.ut=null;else{var t=n.clientX-r.et.getBoundingClientRect().left,i=n.clientY-r.et.getBoundingClientRect().top;if("edit"===r.DrawTool){if(null===r.K){if(null===r.W)return;var e=r.kt(t,i);"point"!==r.W.shapetype?null!==e&&(r.K=e.mapNode,r.St(!1)):null!==e&&(r.q={x:r.W.x,y:r.W.y},r.St(!1))}}else{e={x:t,y:i,buildingID:r.ut.buildingID,level:r.ut.level},t=fengmap.FMUtil.coordsScreenToMap(r.F,e);t.buildingID=r.ut.buildingID,t.level=r.ut.level,"point"===r.DrawTool?(r.jt(t),r.ht.L({type:"drawend",info:r.wt(r.currentobj.info),object:r.currentobj}),r.currentobj=null,r.ut=null):"line"===r.DrawTool?r.J.push(t):"circle"===r.DrawTool?0===r.Z.length?r.Z.push(t):(r.Et(t),r.ht.L({type:"drawend",info:r.wt(r.currentobj.info),object:r.currentobj}),r.Z.length=0,r.currentobj=null,r.ut=null):"rect"===r.DrawTool?0===r.Z.length?r.Z.push(t):(r.Ot(t),r.ht.L({type:"drawend",info:r.wt(r.currentobj.info),object:r.currentobj}),r.Z.length=0,r.currentobj=null,r.ut=null):"polygon"===r.DrawTool?r.Z.push(t):"ellipse"===r.DrawTool&&(0===r.Z.length?r.Z.push(t):(r.xt(t),r.ht.L({type:"drawend",info:r.wt(r.currentobj.info),object:r.currentobj}),r.Z.length=0,r.currentobj=null,r.ut=null))}}})},rt:function(t){if("none"!==this.DrawTool&&null!==this.ut){t={x:t.clientX-this.et.getBoundingClientRect().left,y:t.clientY-this.et.getBoundingClientRect().top,buildingID:this.ut.buildingID,level:this.ut.level},t=fengmap.FMUtil.coordsScreenToMap(this.F,t);if("edit"===this.DrawTool)return null!==this.W&&"point"===this.W.shapetype&&null!==this.q?(this.W.moveTo({animate:!1,x:t.x,y:t.y}),void this.ht.L({type:"drawing",info:this.wt(this.W.info),object:this.W})):void(null!==this.W&&null!==this.K&&(this.Rt(t),this.W.id=this.$,this.ht.L({type:"drawing",info:this.wt(this.W.info),object:this.W})));"line"===this.DrawTool?this.Tt(t):"circle"===this.DrawTool?this.Et(t):"rect"===this.DrawTool?this.Ot(t):"polygon"===this.DrawTool?this.It(t):"ellipse"===this.DrawTool&&this.xt(t),this.F.enableUpdateRender(),null!==this.currentobj&&this.ht.L({type:"drawing",info:this.wt(this.currentobj.info),object:this.currentobj})}},st:function(t){if(2!==t.button&&"edit"===this.DrawTool&&null!==this.W&&("point"===this.W.shapetype||null!==this.K)){if("point"===this.W.shapetype)this.bt(this.W,!0);else if("center"!==this.K.opetype.type){if("ellipse"===this.W.shapetype||"circle"===this.W.shapetype)this.q=this.Ct(this.W.points);else if("rect"===this.W.shapetype){this.q=this.W.points;var t=this.Bt("center"),i=(t.visible=!0,void 0!==this.tt&&"edit"===this.tt&&(t.visible=!1),this.Bt("point",!0));t.position.x=(i[0].position.x+i[1].position.x)/2,t.position.z=(i[0].position.z+i[1].position.z)/2,this.X.length=0,this.X.push({x:Math.abs(i[0].position.x-i[1].position.x)/2,y:Math.abs(i[0].position.z-i[1].position.z)/2})}else if("polygon"===this.W.shapetype){this.q=this.W.points;for(var e=this.Ct(this.q).center,n=this.X.length=0;n<this.q.length;n++)this.X.push({x:this.q[n].x-e.x,y:this.q[n].y-e.y});t=this.Bt("center");t.position.x=e.x-this.F.x,t.position.z=this.F.y-e.y}else if("line"===this.W.shapetype){this.q=this.W.points;for(var r=this.Ct(this.q).center,s=this.X.length=0;s<this.q.length;s++)this.X.push({x:this.q[s].x-r.x,y:this.q[s].y-r.y});i=this.Bt("center");i.position.x=r.x-this.F.x,i.position.z=this.F.y-r.y}}else this.bt(this.W,!0);this.St(!0),this.K=null,this.W.id=this.$,this.ht.L({type:"editend",info:this.wt(this.W.info),object:this.W})}},dt:function(t){t.getRenderNode().position;var i=[new U(-.5,0,.5),new U(-.5,0,-.5),new U(.5,0,-.5),new U(.5,0,.5),new U(-.5,0,.5)],i=(new ke).setFromPoints(i),e=new Le({color:new y(this.it)}),i=(e.depthTest=!1,e.depthWrite=!1,new We(i,e));i.scale.set(1.1,1.1,1.1),t.getRenderNode().add(i),this.ft=i,this.F.enableUpdateRender()},Rt:function(t){if(null!==this.K){var n=this;if("ellipse"!==this.W.shapetype?(this.K.opetype.node.position.x=t.x-this.F.x,this.K.opetype.node.position.z=this.F.y-t.y):"xradius"===this.K.opetype.type?this.K.opetype.node.position.x=t.x-this.F.x:("yradius"!==this.K.opetype.type&&(this.K.opetype.node.position.x=t.x-this.F.x),this.K.opetype.node.position.z=this.F.y-t.y),"circle"===this.W.shapetype)"yradius"===this.K.opetype.type?(s=A("center"),this.Z.length=0,this.Z.push({x:this.F.x+s.position.x,y:this.F.y-s.position.z}),this.Et(t,!0)):(A("yradius").visible=!1,this.Z.length=0,this.Z.push({x:t.x,y:t.y}),this.Et({x:t.x,y:t.y+this.q.yradius},!0));else if("ellipse"===this.W.shapetype)this.Z.length=0,"yradius"===this.K.opetype.type||"xradius"===this.K.opetype.type?(s=A("center"),s={x:this.F.x+s.position.x,y:this.F.y-s.position.z},r=null,r="yradius"===this.K.opetype.type?this.Nt(s,this.q.xradius,Math.abs(s.y-t.y)):this.Nt(s,Math.abs(s.x-t.x),this.q.yradius),this.xt(r,!0)):(A("xradius").visible=!1,A("yradius").visible=!1,s=this.Nt(t,this.q.xradius,this.q.yradius),this.xt(s,!0));else if("rect"===this.W.shapetype)if("center"===this.K.opetype.type){for(var i=A("point",!0),e=0;e<i.length;e++)i[e].visible=!1;this.Z.length=0,this.Z.push({x:t.x+this.X[0].x,y:t.y-this.X[0].y}),this.Ot({x:t.x-this.X[0].x,y:t.y+this.X[0].y},!0)}else{var r=A("center"),s=A("point",r.visible=!1,this.K.opetype.node.uuid);null!==s&&(this.Z.length=0,this.Z.push({x:this.F.x+s.position.x,y:this.F.y-s.position.z}),this.Ot(t,!0))}else if("polygon"===this.W.shapetype)if("center"===this.K.opetype.type){for(var o=this.Bt("point",!0),h=0;h<o.length;h++)o[h].visible=!1;for(var u=this.K.opetype.node.position.x,a=this.K.opetype.node.position.z,f=[],l=0;l<this.X.length;l++)f.push({x:u+this.X[l].x,y:a-this.X[l].y});this.It(f,!0)}else{for(var c=this.Bt("point",!0),v=[],y=0;y<c.length;y++)v.push({x:c[y].position.x,y:c[y].position.z});this.It(v,!0)}else if("line"===this.W.shapetype){var d=this.Bt("point",!0),b=[];if("center"===this.K.opetype.type){for(var p=0;p<d.length;p++)d[p].visible=!1;for(var m=this.K.opetype.node.position.x,w=this.K.opetype.node.position.z,k=0;k<this.X.length;k++)b.push({x:m+this.X[k].x,y:w-this.X[k].y})}else for(var g=0;g<d.length;g++)b.push({x:d[g].position.x,y:d[g].position.z});this.Tt(b,!0)}}function A(t,i,e){return n.Bt(t,i,e)}},Bt:function(t,i,e){var n=null;i&&(n=[]);for(var r=0;r<this.H.length;r++)if(this.H[r].opetype.type===t)if(i)(!e||this.H[r].opetype.node.uuid!==e)&&n.push(this.H[r].opetype.node);else{if(!e){n=this.H[r].opetype.node;break}if(this.H[r].opetype.node.uuid!==e){n=this.H[r].opetype.node;break}}return n},At:function(){var t;"line"===this.DrawTool?this.Tt():"circle"===this.DrawTool?this.Et():"rect"===this.DrawTool?this.Ot():"polygon"===this.DrawTool?this.It():"ellipse"===this.DrawTool&&this.xt(),"line"!==this.DrawTool&&"polygon"!==this.DrawTool||(t=!0,"line"===this.DrawTool?this.J.length<2&&(t=!1):"polygon"===this.DrawTool&&this.Z.length<3&&(t=!1),t&&(this.ht.L({type:"drawend",info:this.wt(this.currentobj.info),object:this.currentobj}),this.ut=null),"line"===this.DrawTool&&(this.J.length=0,this.currentobj=null),"polygon"===this.DrawTool&&(this.Z.length=0,this.currentobj=null))},Mt:function(){if(this.q){if("circle"===this.W.shapetype)this.Z.length=0,this.Z.push({x:this.q.center.x,y:this.q.center.y}),this.Et({x:this.q.center.x,y:this.q.center.y+this.q.yradius},!0);else if("ellipse"===this.W.shapetype){this.Z.length=0;var t=this.Nt({x:this.q.center.x,y:this.q.center.y},this.q.xradius,this.q.yradius);this.xt(t,!0)}else if("rect"===this.W.shapetype)this.Ot(),this.bt(this.W);else if("polygon"===this.W.shapetype){for(var i=[],e=0;e<this.q.length;e++)i.push({x:this.q[e].x-this.F.x,y:this.F.y-this.q[e].y});this.It(i,!0)}else if("line"===this.W.shapetype){for(var n=[],r=0;r<this.q.length;r++)n.push({x:this.q[r].x-this.F.x,y:this.F.y-this.q[r].y});this.Tt(n,!0)}else if("point"===this.W.shapetype)return this.W.moveTo({animate:!1,x:this.q.x,y:this.q.y}),this.ht.L({type:"editend",info:this.wt(this.W.info),object:this.W}),void(this.W=null);this.W.id=this.$,this.ht.L({type:"editend",info:this.wt(this.W.info),object:this.W}),this.bt(this.W,!0)}},jt:function(t){var i,e={},n=this.PointStyle;for(i in n)e[i]=n[i];e.x=t.x,e.y=t.y,e.buildingID=this.ut.buildingID;var t=this.F.getBuilding(this.ut.buildingID).getFloor(this.ut.level),r=new fengmap.FMImageMarkerEdit(e);r.addTo(t),(r.mapEdit=this).currentobj=r},Tt:function(t,i){var e,n=new fengmap.FMSegment,r=(n.points=[],{}),s=this.LineStyle;for(e in s)r[e]=s[e];if(void 0===r.height&&(r.height=3),i){null!==this.W&&this.W.remove();for(var o=0;o<t.length;o++)n.points.push({x:this.F.x+t[o].x,y:this.F.y-t[o].y,z:r.height})}else{if(0===this.J.length)return;if(null!==this.currentobj&&(this.currentobj.remove(),!t)&&1===this.J.length)return;for(var h=0;h<this.J.length;h++)n.points.push({x:this.J[h].x,y:this.J[h].y,z:r.height});t&&n.points.push({x:t.x,y:t.y,z:r.height})}i?(n.level=this.ut.level,n.buildingID=this.ut.buildingID):(n.level=this.J[0].level,n.buildingID=this.J[0].buildingID),r.segments=[n],r.pointSegCount=300;var u=new fengmap.FMLineMarkerEdit(r);u.addTo(this.F),u.mapEdit=this,i?this.W=u:this.currentobj=u},Et:function(t,i){if(0!==this.Z.length){if(i)null!==this.W&&this.W.remove();else if(null!==this.currentobj&&(this.currentobj.remove(),!t))return this.Z.length=0,void(this.currentobj=null);var e,n=this.Z[0],t=Math.sqrt((n.x-t.x)*(n.x-t.x)+(n.y-t.y)*(n.y-t.y)),r=this.PolygonStyle,s={};for(e in r)s[e]=r[e];s.points=fengmap.FMCalculator.circleBuilder(t,this.Z[0],32),s.shapetype="circle";var o,t=new fengmap.FMPolygonMarkerEdit(s);i?(o=this.F.getBuilding(this.ut.buildingID).getFloor(this.ut.level),t.addTo(o)):(o=this.F.getBuilding(n.buildingID).getFloor(n.level),t.addTo(o)),t.mapEdit=this,i?this.W=t:this.currentobj=t}},Ot:function(t,i){var e=[];if(t||i){if(0===this.Z.length)return;if(i)null!==this.W&&this.W.remove();else if(null!==this.currentobj&&(this.currentobj.remove(),!t))return this.Z.length=0,void(this.currentobj=null);var n=this.Z[0],e=[n,{x:t.x,y:n.y},t,{x:n.x,y:t.y}]}else if("edit"===this.DrawTool)e=this.q,null!==this.W&&this.W.remove();else if(null!==this.currentobj)return this.currentobj.remove(),this.Z.length=0,void(this.currentobj=null);if(0!==e.length){var r,s=this.PolygonStyle,o={};for(r in s)o[r]=s[r];o.points=e,o.shapetype="rect";n=new fengmap.FMPolygonMarkerEdit(o);i?(e=this.F.getBuilding(this.ut.buildingID).getFloor(this.ut.level),n.addTo(e)):(e=this.F.getBuilding(this.Z[0].buildingID).getFloor(this.Z[0].level),n.addTo(e)),n.mapEdit=this,!t&&!i||i?this.W=n:this.currentobj=n}},It:function(t,i){var e=[];if(i){null!==this.W&&this.W.remove();for(var n=0;n<t.length;n++)e.push({x:this.F.x+t[n].x,y:this.F.y-t[n].y})}else{if(0===this.Z.length)return;null!==this.currentobj&&this.currentobj.remove();for(var r=0;r<this.Z.length;r++)e.push({x:this.Z[r].x,y:this.Z[r].y});if(t)e.push({x:t.x,y:t.y});else if(2===e.length)return}var s,o=this.PolygonStyle,h={};for(s in o)h[s]=o[s];h.points=e;var u,a=new fengmap.FMPolygonMarkerEdit(h);i?(u=this.F.getBuilding(this.ut.buildingID).getFloor(this.ut.level),a.addTo(u)):(u=this.F.getBuilding(this.Z[0].buildingID).getFloor(this.Z[0].level),a.addTo(u)),a.mapEdit=this,i?this.W=a:this.currentobj=a},xt:function(t,i){var e=null;if(i)null!==this.W&&this.W.remove(),e=t;else{if(0===this.Z.length)return;if(null!==this.currentobj&&this.currentobj.remove(),!t)return this.Z.length=0,void(this.currentobj=null);var n=this.Z[0],r=Math.abs(t.x-n.x),t=Math.abs(t.y-n.y),e=t<r?this.Nt(n,r,r/2):this.Nt(n,t/2,t)}for(var s=[],o=0;o<e.length;o++)s.push({x:e[o].x,y:e[o].y});var h,u=this.PolygonStyle,a={};for(h in u)a[h]=u[h];a.points=s,a.shapetype="ellipse";r=new fengmap.FMPolygonMarkerEdit(a);i?(n=this.F.getBuilding(this.ut.buildingID).getFloor(this.ut.level),r.addTo(n)):(t=this.F.getBuilding(this.Z[0].buildingID).getFloor(this.Z[0].level),r.addTo(t)),r.mapEdit=this,i?this.W=r:this.currentobj=r},Nt:function(t,i,e){return new pt(t.x,t.y,i,e,0,2*Math.PI,!1,0).getPoints(32)},yt:function(t){for(var i=[],e=(this.q=t.points,this.Ct(t.points).center),n=this.X.length=0;n<t.points.length;n++)i.push(t.points[n]),this.X.push({x:t.points[n].x-e.x,y:t.points[n].y-e.y});i.push({x:e.x,y:e.y,optype:"center"}),this.Pt(i,t)},vt:function(t){var i,e=this,n=[];if("polygon"===t.shapetype){this.q=t.points;for(var r=this.Ct(t.points).center,s=this.X.length=0;s<t.points.length;s++)n.push(t.points[s]),this.X.push({x:t.points[s].x-r.x,y:t.points[s].y-r.y});n.push({x:r.x,y:r.y,optype:"center"})}else"rect"===t.shapetype?(this.q=t.points,n.push(t.points[0]),n.push(t.points[2]),n.push({x:(t.points[0].x+t.points[2].x)/2,y:(t.points[0].y+t.points[2].y)/2,optype:"center"}),this.X.length=0,this.X.push({x:Math.abs(t.points[0].x-t.points[2].x)/2,y:Math.abs(t.points[0].y-t.points[2].y)/2})):"circle"!==t.shapetype&&"ellipse"!==t.shapetype||(i=this.Ct(t.points),this.q=i,n.push({x:i.center.x,y:i.center.y,optype:"center"}),n.push({x:i.center.x,y:i.center.y+i.yradius,optype:"yradius"}),"ellipse"===t.shapetype&&n.push({x:i.center.x+i.xradius,y:i.center.y,optype:"xradius"}));e.Pt(n,t)},Pt:function(t,i){this.F.getFloor(this.F.getLevel());for(var e=0;e<t.length;e++){var n=(n=t[e].optype)||"point",r=this.editUrl,r=("center"===n&&(r=this.centerUrl),new fengmap.FMImageMarkerEdit({url:r,size:16,height:i.height+1,x:t[e].x,y:t[e].y,collision:!1,opetype:n})),s=this.F.getBuilding(i.info.buildingID).getFloor(i.info.level);r.addTo(s),void 0!==this.tt&&("move"===this.tt?"center"!==n&&(r.visible=!1):"edit"===this.tt&&"center"===n&&(r.visible=!1)),this.H.push(r)}},Ct:function(t){for(var i=null,e=null,n=null,r=null,s=0;s<t.length;s++)0===s?(i=t[s].x,e=t[s].y,n=t[s].x,r=t[s].y):(i>t[s].x&&(i=t[s].x),e>t[s].y&&(e=t[s].y),n<t[s].x&&(n=t[s].x),r<t[s].y&&(r=t[s].y));return{center:{x:(i+n)/2,y:(e+r)/2},xradius:Math.abs(n-i)/2,yradius:Math.abs(r-e)/2}},Lt:function(t){var i=t.buildingID,t=t.level;null===i&&(i=this.F.getMapOptions().mapID,t=this.F.getLevel()),null===this.currentobj&&(this.ut={buildingID:i,level:t})},St:function(t){var i=this.F.getInteracations();t?(i.enableDrag=this.lt.enableDrag,i.enableRotate=this.lt.enableRotate,i.enableTilt=this.lt.enableTilt,i.enableZoom=this.lt.enableZoom):(this.lt.enableDrag=i.enableDrag,this.lt.enableRotate=i.enableRotate,this.lt.enableTilt=i.enableTilt,this.lt.enableZoom=i.enableZoom,i.enableDrag=t,i.enableRotate=t,i.enableTilt=t,i.enableZoom=t)},Ft:function(t){if(this.W&&this.W.id===t){for(var i=0;i<this.H.length;i++)this.H[i].remove();this.H.length=0}}}),i=t;function cn(t){return(cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vn(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=cn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=cn(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==cn(t)?t:t+""))(n.key),n)}}var yn=(()=>{function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}return i=t,n=[{key:"round",value:function(t){return 0<t.toFixed(2)?Math.ceil(t.toFixed(2)):Math.floor(t.toFixed(2))}},{key:"generateUUID",value:function(){for(var t=[],i=0;i<256;i++)t[i]=(i<16?"0":"")+i.toString(16);var e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,s=4294967295*Math.random()|0,e=t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&n]+t[n>>8&255]+"-"+t[n>>16&15|64]+t[n>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&s]+t[s>>8&255]+t[s>>16&255]+t[s>>24&255];return t.length=0,e.toUpperCase()}},{key:"findNearNthPowerOfTwo",value:function(t){t-=1;return(t=(t=(t=(t=(t|=t>>1)|t>>2)|t>>4)|t>>8)|t>>16)<0?1:1+t}},{key:"rgbToArray",value:function(t){var i=new y;return i.setStyle(t),[i.r,i.g,i.b]}},{key:"toRgba",value:function(t){var i;return void 0===t?t:"number"!=typeof t?3<=(i=t.split(",")).length?"rgba("+parseInt(i[0])+","+parseInt(i[1])+","+parseInt(i[2])+",1)":t:"rgba("+parseInt(255*new y(t).r)+","+parseInt(255*new y(t).g)+","+parseInt(255*new y(t).b)+",1)"}},{key:"toColor",value:function(t){var i;return"number"==typeof t?t:3<=(i=t.split(",")).length?parseInt(i[0])<<16|parseInt(i[1])<<8|parseInt(i[2]):(console.error("color format error",t),0)}},{key:"cov",value:function(t){for(var i=[],e=[0,0],n=[],r=0;r<t.length;r++)e[0]+=t[r].x,e[1]+=t[r].y;e[0]=e[0]/t.length,e[1]=e[1]/t.length;for(var s=0;s<t.length;s++)n.push([t[s].x-e[0],t[s].y-e[1]]);for(var o=[],h=0;h<n[0].length;h++){for(var u=[],a=0;a<n.length;a++)u.push(n[a][h]);o.push(u)}for(var f=0;f<o.length;f++){for(var l=[],c=0;c<n[0].length;c++){for(var v=0,y=0;y<o[f].length;y++)v+=o[f][y]*n[y][c];v/=t.length-1,l.push(v)}i.push(l)}return i}},{key:"eig",value:function(t){var i=(t[0][0]+t[1][1])/2,e=t[0][0]*t[1][1]-t[1][0]*t[0][1],n=i+Math.sqrt(i*i-e),i=i-Math.sqrt(i*i-e);return 0==t[0][1]&&0==t[1][0]?{eigValue:[n,i],eigVect:[[1,0],[0,1]]}:(e=(n-t[0][0])/t[0][1],t=(i-t[0][0])/t[0][1],{eigValue:[n,i],eigVect:[[1/Math.sqrt(1+e*e),e/Math.sqrt(1+e*e)],[1/Math.sqrt(1+t*t),t/Math.sqrt(1+t*t)]]})}}],(e=null)&&vn(i.prototype,e),n&&vn(i,n),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,e,n})();function dn(t){return(dn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function bn(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=dn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=dn(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==dn(t)?t:t+""))(n.key),n)}}function pn(t,i,e){i=kn(i);var n=t,i=mn()?Reflect.construct(i,e||[],kn(t).constructor):i.apply(t,e);if(!i||"object"!=dn(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=n))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function mn(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(mn=function(){return!!t})()}function wn(){return(wn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,e){var n=((t,i)=>{for(;!{}.hasOwnProperty.call(t,i)&&null!==(t=kn(t)););return t})(t,i);if(n)return(n=Object.getOwnPropertyDescriptor(n,i)).get?n.get.call(arguments.length<3?t:e):n.value}).apply(null,arguments)}function kn(t){return(kn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function gn(t,i){return(gn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}var An=(t=>{function s(t){var i;if(this instanceof s)return(i=pn(this,s,[t])).info2=t,i.id=""+yn.generateUUID(),i.shapetype2="point",i.opetype2="no",t.opetype&&(i.opetype2=t.opetype,i.shapetype2="no"),i.mapEdit=null,i;throw new TypeError("Cannot call a class as a function")}var i,e=s;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&gn(e,t),e=s,(t=[{key:"info",get:function(){return this.info2.id=this.id,this.info2.x=this.x,this.info2.y=this.y,this.info2.height=this.height,this.info2.shapetype=this.shapetype,this.info2.level=this.level,this.info2}},{key:"opetype",get:function(){if(this.opetype2)return{node:this.getRenderNode(),type:this.opetype2}}},{key:"shapetype",get:function(){return this.shapetype2}},{key:"deleteMarker",value:function(){var t,i,e,n,r;t=s,i="remove",e=this,r=wn(kn(1&(n=3)?t.prototype:t),i,e),(2&n&&"function"==typeof r?function(t){return r.apply(e,t)}:r)([])}}])&&bn(e.prototype,t),i&&bn(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e})(fengmap.FMImageMarker);function Mn(t,i){return(t=>{if(Array.isArray(t))return t})(t)||((t,i)=>{var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,s,o,h=[],u=!0,a=!1;try{if(s=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;u=!1}else for(;!(u=(n=s.call(e)).done)&&(h.push(n.value),h.length!==i);u=!0);}catch(t){a=!0,r=t}finally{try{if(!u&&null!=e.return&&(o=e.return(),Object(o)!==o))return}finally{if(a)throw r}}return h}})(t,i)||jn(t,i)||(()=>{throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function Sn(t,i){var e,n,r,s,o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(t)},n:function(){var t=o.next();return n=t.done,t},e:function(t){r=!0,e=t},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw e}}};if(Array.isArray(t)||(o=jn(t))||i&&t&&"number"==typeof t.length)return o&&(t=o),s=0,{s:i=function(){},n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:i};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function jn(t,i){var e;if(t)return"string"==typeof t?En(t,i):"Map"===(e="Object"===(e={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?En(t,i):void 0}function En(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,n=Array(i);e<i;e++)n[e]=t[e];return n}function On(t){return(On="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xn(i,t){var e,n=Object.keys(i);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(i),t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})),n.push.apply(n,e)),n}function Rn(n){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(r),!0).forEach(function(t){var i,e;i=n,e=r[t=t],(t=In(t))in i?Object.defineProperty(i,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):i[t]=e}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(r)):xn(Object(r)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(r,t))})}return n}function Tn(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,In(n.key),n)}}function In(t){t=((t,i)=>{if("object"!=On(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=On(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string");return"symbol"==On(t)?t:t+""}var t=(()=>{function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.F=t,this.Dt=null,this.Gt=!1,this.et=this.F.getRenderManager().renderer.domElement,this.G={url:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAACARJREFUeF7lW3twVNUZ/313N8kmQHbvIuCrM4itpUJ2A7ZQxrbwh62KxccgyNDWVpNdotiZvtTyGIHROJk+LFNHSnZX2yllrEYYrENtnU4h0wdCTdm7aBusBSwOsUr2xSubzb1f524aRsMm955z7y6d6f33fr/v+32/Pec73zn3LOH//KFq5P/Rr3PdxGJ2AQwsZMYsBj5OwDSAJwGoBXAaQA7AEQCHodABIuxJblWPVZpfBQVgCkfyX2DW7ybi2wFqEE6G8DpB2eZBcVtPbEqfMN4GoAICMIVW5VcQ62vBmG2Dg6UJAwWC8lPF4I6DT6tvWwIEDFwVINySmQOFtwD4tAAHEdOzRHh8MKN+/29dNCgCHMvWJQHM4Z55CKBHAa5xg9i4PogOEil3JTv9/3Aay7EA10VPNOiof5aZb3VKRghPyCvsWXEw7n9ZCDfK2JEATfdlVY9u7GbGAick5LFUhKLcq3X6fyHrQ1qA4V/e97uLl/z5lHWGclcqHtghI4KkAEzN0eyuqg/7MTJkYEDx4Ibk1uCfREWQEiAcST8MoEM0WIXt3ynUept7n2rsF4kjLMDwUof9Van2IpmUbGmHFlfvFIEJClBa7v5cwXVehHtZWwWexSIrg5AATdH0SoWx3THLCjpgoDd1hToLG8mwE0ZAAKZwNJNyo72tqwGarvJimqqgvg44mWP8s0/H8fdscbbMi0hZnowFuiwNzUljx8i0CUdyNwL6b+zal7ObfqmCti/6sDBci/q6C0Mf6dPxy98PYMcfBqE70+JVLR601ZvYFiDUmt5OhJUyAphBVi3xoXWxD16PdcgjJ3R8a+tpHHtXVgViYGimFp/yphVfazYAzP38hIF0WmZLawZob2nA4vl1Vlw+9P7UWQNtm0/jjWO6EO68MdEjWkx91ApsS4Dmtswi1nmPlbNy79uW+NC2pF4GivezBla25/F+joXxDHSn4sFFVkB7AkQzG5h5o5Wz0e/NOf/ChkZbw34s37tfLWDdM2dFQ5v2hTO+fv9bT36sMB7YlgDhSOZ5gJeJsuhobcBN88SG/ugYBjOWbsjjqFQ94NlafPIbjgUIRTIagUMiAphL3d4nAmWrvYgf03bLi+cQ2z0gCgOYlmoJdadjAcKRzLsATxNh8MlrvEh8xzzzdP68driI1h+a56ZiDzPuTyWCP3FBgPQZAEKHmrfMr0V7ywQxxmNYH39Px5L1eWFfRHg4GQt+z7EAoUhaJ0ARYXDn52qx/svuCHAyZ+CGB81Tc8HHxlJoqwiGIulzBPhEwi8K12Dz6okikDFte/81hBWPnRL3xVijJYLjbtttCSBTAz4yVcFLj/nFSZdB7N5fwLqnxZdCN2tA0twOiGazc1MjZlzmEYVdYP9Q7DReea0o7IeI7kjG1F2Oa0A4kn4OwHJRBssX1mLtl5zVgb60jtvW5zE4JBod8HDNtX9NTPq7YwGaW7MPMhnjVtNyQTwK0PVII2ZcLj8K1iTO4OUDUt9A8lpWDaKLxt1M2KoBoWh2LrHRI/4bAGY7vO27kzCpQWgRKYXq6h5A+/ZzMmHNff6vkvHgbVZgWwKYTpoj6bcYuNrKYbn3s6Z7sPn+iZgSsC+CmXzHs+fkzwUUfEXrDFp+L7AtQCiSXkPA4zICmJgpfsI3ltbj5vm1UGjssOac//HOAdlhP0Iv4yX1yp4YWS4dtgWYtzo/uVAovg0iR1XtqksVfP66WsybOXIkRjAbHfNIrFsrYm+yKFXwPvTDEDq0WHCNnR/LtgCms3AkbTYV5jeB/9mHgVM15J3RE2s8aYekkACzWnJBj8d4k5gn23F+MWyYaWMqoW6yG1tIgNIoiOYeAOtP2g1QVTvCcS8GZvbELrec+yO8hAXAMvaE1exfwDynqsnZCabQUq1z/P3/aDfiApSWxNynGPo+APIdjp2ERGwIL2mxoPAdBSkBhgti/xMAfVOEYwVtc8y+2alEwzuiMaQFMO8HDLFPM0/NRYO6bU9Qosl4IC7jV1oAM1ioNf1ZItoD8MWcCq9o8eCNMsmbGEcCDK8KmR+A+duyBBzisszclEpMFh768qvAKMbTv3bU56/xmxulax0mIwGnu7W4uk0CeB7ieASUpkJpt8j7ADavvVbpEb8MUY6YKwL8tx6sJUJ7lbLvKxS8Tb0/F7sOU1EBSg1SINsN8PUVFYHBBuGWQ/Ggo/uBrtWADybbdG92BnmMJAHufBEpoyQDW1Lx4Gq3RHZtCowQCq/K3AODn3GL4Cg/vQ0T1bn7fkRyx0RlSLkuQGlpjPTvBOgOl0UoGqwsOJQISB3NjcWlIgJcEz1xST37UgAuc0sEZqxLJYLSJ1JVFaC0Kqzqv4l0+jXIebMFoj9qmcAiqxNeGbErMgLO14NI2jw3eECG2AcweWalOZUIHHXopyy8ogJcuex4fTAwoYeAT8iSN0D3HIqrP5PFW+EqKkBpKjjqEt3p9sYToeICyHeJ3Fco1LjS7V10AYa7xEw3AHtdIoPZ41mc6vQ7uphpNfzN91UZAWYgoS6R6Cktpjotnnbyr54Aw1Mh20JkJMZlRjjsxcBckZNdW5mOYVS1ETASvzmSeZEx5h+shuAxrte2XnLASVIi2KoLEGo7NZX0oUMATx1NlIg2JWOq8IVMkYQviOkELIudE8ncajDvGtUl7levUD+zdyNJXIWQZVLFIjiaYnNL5qus8AaU/kRNv9V58L7XE9P+LZ+KHLLqU0COZuVQ/wGFa5RfEyvmcQAAAABJRU5ErkJggg==",size:32,height:1,collision:!1},this.it="#FF0000",this.U={width:5,type:mt.FULL,color:"#FF0000",height:3},this.Y={color:"#FF0000",borderWidth:3,borderColor:"#0000FF",opacity:.5,height:3},this._="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAACPtJREFUeF7tmntwVPUVx79nn9lXEhEjIBjrhGklVHlMJW1x0BmBIoKtGqCQiLVUkBoLEalUARUY35gp5eFUKY8ECMQRsDXUYdpSGSC0DUpBOwEZpNRQKJBsdjfZ5697NnfbzWY3926y9y4GfzP71/7u757zub/HOef7I1zlja5y//EVgEzOACHErQCIiD7OlB0ZmQFCCD2AjQBmSI5vBVBKREGtQWQKwCsAnnrnsBcCwIO3m9nv14loQa8HIISYAmDbvk99NG+zO+LvyhIb7hpiYhY/JKJqLSFoOgOEEIUADp25GLJNX+0kVxv7DNjNQOXcbNx0nZ6JFBHRMa0gaAZACJED4C+tPhSUrGmmz86HOvh4c54Omx/Lhs1MJwF8i4iatICgCQAhBL9ndxjAxAVbXdj7d3/C995daMSr0218LPwOwCQiap8iKjatACwN+/Dcpv1e/8r3Pcau/HlifBYeGWPhLs8T0XMq+h4ZWnUAQoh7AeyqPx3wzvp1iyUk8011BKx+2I5vDzbyGrmPiH6rJgRVAQghBgM4fMktjPdXOE1N7lCXXz/qaI6VsPWnDgy4Rs/7wO1EdEItCKoBEELYeMcX4E3P6Tt+NpidihPfGKDHhtkOZBnpuHQyuFJ5XmlfNQHweT5lxW7PuR2HvP2UGhTbb9JwE5YVM0dsJ6Kp3RlD7hlVAAghvgegds9R39mnt7kHyhnR1f+LJlswtSiLu0wgoj09GSvRs2oBeArAKw+tc507esbfra8fNbZwoMFVNddhB7CQiF79sgDgLK/e2SqosSmoize6dE0LfHFpj1HP0aAj0lWvJ7/NRE6Lidz2LMo16MDrYKQaWaMqM4CdEELcA6AMwDUxAPIB9Bu15DK8gY5YzAag7oVI13MAPo/59zKAXxJRbbq/viZxQKzR4XD4DQDzZABUENF8NZzVbA9IZnyvAyDt9t8E8IGS9ZlOAEKI2wCMDZcTjvXkdOjWHiAFOev5nJe+Nm9pnLx0uU7TBUAIMSG8Kb7H+6X0/u0AfhwuqKQcLKUMQApv3wVQWH2oDbvr/a6Ncxwhgw4HiIgNS9rSCKDW2SrGzf2N60LpaLNv/K2mQQA4YvxBqmFzSgCEEJMAbPL6Re7ynR68d8QXcfZPz+aeybVSY3gqFmkE4GBDY6BoyqqWyOuKR5n//YvJ1hwitAF4iIh4dihqigBI+TyntIu/uBzUlVe58Y8v/n+Q1y7Mvdg/l05mCgB7WjjQ4Fw1067vYyPOpZdJ6bRsPUEWgBAiF0AlFzMOnvDj6Wo3mj0dx62Zl+0vyNPXZxIAQ8i1UuD1Ert/5E0GhsBFlRK5ylKXAIQQQwG8K4Qo2PDnNqz6oA2J8vnqMge+3t/AAcw2mXk3JlwbGC4TBxwBsE9mnGkNjYF+0SUQ25frCT+bYPXPHM2hFT6T9oWkNcakAIQQnH297fYK29IaN/Ye9ye1SQKgaM1xJxkAisZpaAwgEYDow3cPNYplD9phMYELrbOSVZs7AZBEi5cBlJ++EKTyKhdOxRUw4y3kOJ7JK23xYXD0ucg3U9h4JvplZBQutL5R4hD5fSPpyEoAP48XXxIB2ML1+T9+4sPiHW64vAotukK72c2E5cVW3DnExBZuJaLpsaZ2ACBFVx/VHPZixU5PRLXpDY2dfPb7VjzQrkANi41a4wFwGvsxS1Z8zvdSALcR0dHoh020BPjIm7HvUx+e2eFBVL35ss4EexZhRbEVY26JLIEt4UgxKshGXEq2Cb4IYMGZiyHM39zSScWJh2HSs8atHFE6NkEh0KmoEm9B+yZoR35fPU/m1wAskt0Eo4MIIYoBrG/1wbb4neRqDve/Eo/BsUONeP4BG6zmSILEiRInTJ2aXCDEYiYnPgWb9nsDFbUe4xUSCE1taAz0TxYIlY234OE7zCyxsZ7ACRInSgmb7MSVRM3NnO7Wnw60lle5DfEChzQD6rQMhU+dD424v6I5srCjLddKeGmaDUUFEf2FFSUOhZu7WpyyAPhhKRlaAmDJJbdoLdvYEowVOjIBoLFZDJ7wctO1UedYSFk5w8ZqEktqL/BPibiqCEDMvjCREyMBZL24y9O8vc57fcweoOkMaPJgwJ3LL9/I72cBhc95szEiqfNVG8V6YkoApNlQIO0LQ39/1He26oDP8KuZtrxsC3FZTLOCSDCE78xc59RNGmGyS8IJJzy83vl+geKWMgAJAtfp40tik4no/a7enMaKUKKS2CNE1H7nJoXWLQAxS4IlME6Z+ev/L7pK9v50AZA+Aket4zJSFE0BcIeu6QTQXRvin+vRDEjViKsKgKQZPBGWtfrEgOqONMYi2oHwabyUiFpThS7XX5UZIF2B/VswBI+zTTS1+oTN4xXZwZCIRChy4mis0VlGCuX31XNF420imiXnUKr/qwXgSU4+Sta2uI79M8DSdo/a7vKcszf21emI6IYeDZTgYbUAjA9fa9lTU+fF8l2eHtlcOMhwqXKOw0qEfUTEp05amyoApGOqCsD05TvdqDncLqCk2vrYqWXX/JygwxIxc1S4nNWQ6hhy/dUEwLX5/f6gGPHoWy048nlqF8H1egpVPuZw3jJAz7cmZIMsOUeT/a8aAGkWsGb314uuUN6M1U6ca1ZeZFsxxX5h4jDjdVIR46XuOij3nKoAJAh3ANj7yb8Cph+92dLpZkgiA4tHmb3P3GflCmY1EU2Tc6In/6sOQIIwB8Da2o+8WLS9601xWL4huP5Rh9AROLn5LhH1bBeVoaMJAAnCOgCzK2o92PBhYrHh+mzClsezxbV23X+kG+Oxd4V68qGTPqslAA6C/hAMidFlG104cKLjLSmTAdgwO1sMuUHPf4wlIjl9MC1ANAMgzYI83hSdraFBJWtawFXnaGP15t7hEeHicSJanRbvFAyiKQAJwkgAH546H7SUrnXC7QVKR5vx5D1W/vstIvqJArvT1kVzABIE1ucq60766eBJP8rGWaDXESc8dxFR96KmbiLJCAAJwkIALMBwolPPFzCIiO8YaNoyBkCC8DW+Ocr7AhElv4CgIpKMAlDRL8VDfwVAMape2vG/uo8SfcLtYVIAAAAASUVORK5CYII=",this.Ut=16,this.Yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAM1JREFUeF7t27ENwjAQBdAfRUhUlDR0lGmyDyswAYOwQkaiTJeGgiJVJBSBoEKscM8b+Ots3z3JTX95vFJ4NZ8AtpvkuG9LxTDe1yzP5BtAd2gznHelAjhd59ymVQAqwBFwB7gEvQKeQX2ARkgnqBU2CxiGTIOVEjAO8wAgQoSQGBOEolSYClNhKkyFqTAVpsJUmApTYSpMhSuZaKAoFIWiUBSKQlEoCkWhKBSFolAUikJRKApFoSgUhaJQFIpWSoAK/6pw+c/TlUr/f69vr/sXn39sPMAAAAAASUVORK5CYII=",this._t=16,this.Vt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAMpJREFUeF7t27ENwjAQBdCzgpBSpKSiomUkVsg8rJCR0lJRUVIgIdChpEJZ4Z438NfZvnuSW2ZmFF5tCeD1zrg9vqViOB266Pct1gDm+ycu12epAKZxiPNxJwAV4Ai4A1yCXgHPoD5AI6QT1AqbBQxDpsFKCRiHeQAQIUJIjAlCUSpMhakwFabCVJgKU2EqTIWpMBWmwpVMNKAoFIWiUBSKQlEoCkWhKBSFolAUikJRKApFoSgUhaJQFIpWSoAK/6tw+c/TlUp/u9cfGchzX4wjIokAAAAASUVORK5CYII=",this.Jt=10,this.Zt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAYAAACqaXHeAAAAAXNSR0IArs4c6QAAAIRJREFUeF7t1wERACAMAzGmCH2YxgII+SChx5rr7HPfCr8RgB/gBHRAuAOXEqQABShAAQqEE8AgBjGIQQyGETCGMIhBDGIQgxgMJ4BBDGIQgxgMI2ANYhCDGMQgBjEYTgCDGMQgBjEYRsAaxCAGMYhBDGIwnAAGMYhBDGIwjIA1iME6gx9FmaWBniGxBgAAAABJRU5ErkJggg==",this.Ht=16,this.ut=null,this.Qt=null,this.W=null,this.K=null,this.H=[],this.Xt=[],this.X=[],this.q=null,this.zt=[],this.Kt=[],this.nt=this.nt.bind(this),this.rt=this.rt.bind(this),this.st=this.st.bind(this);t=this.F.getInteracations();this.lt={},this.lt.enableDrag=t.enableDrag,this.lt.enableRotate=t.enableRotate,this.lt.enableTilt=t.enableTilt,this.lt.enableZoom=t.enableZoom,this.Wt=null,this.ot=new Bt,this.ht=new nn,this.ct()}return t=i,(e=[{key:"operationType",get:function(){return this.Dt},set:function(t){if(this.W&&this.W.type===T.IMAGE_MARKER&&this.W.oldUrl&&(this.W.url=this.W.oldUrl),this.Dt=t,this.Qt=null,this.ut=null,"edit"!==this.Dt){for(var i=0;i<this.H.length;i++)this.H[i].remove();this.H.length=0,this.W=null}}},{key:"markers",get:function(){for(var t=[this.F.getBuilding(this.F.getMapOptions().mapID)],i=this.F.getBuildings(),e=0;e<i.length;e++)t.push(i[e]);for(var n=[],r=0;r<t.length;r++)for(var s=t[r].children,o=0;o<s.length;o++)for(var h=s[o].getLayers(T.IMAGE_MARKER|T.POLYGON_MARKER),u=0;u<h.length;u++)for(var a=h[u].children,f=0;f<a.length;f++)void 0!==a[f].operationType&&(a[f].buildingID=t[r].buildingID,a[f].markerType=a[f].type,n.push(a[f]));for(var l=this.F.getMarkerGroup().children,c=0;c<l.length;c++)l[c].type===T.LINE_MARKER&&void 0!==l[c].operationType&&(l[c].markerType=l[c].type,n.push(l[c]));return n}},{key:"setStyle",value:function(t,i){"lineStyle"===t?this.U=i:"polygonStyle"===t?this.Y=i:"pointStyle"===t?void 0!==(this.G=i).rectColor&&(this.it=i.rectColor):"centerStyle"===t?(this._=i.url,void 0!==i.size&&(this.Ut=i.size)):"editStyle"===t?(this.Yt=i.url,void 0!==i.size&&(this._t=i.size)):"pointRectColor"===t?(this.it=i,this.G.rectColor=i):"selectedURL"===t?this.Zt=i.selectedURL:"newPointStyle"===t?(this.Vt=i.url,void 0!==i.size&&(this.Jt=i.size)):"nodeStyle"===t&&(void 0!==i.editStyle&&(this.Yt=i.editStyle.url,void 0!==i.editStyle.size)&&(this._t=i.editStyle.size),void 0!==i.selectedStyle&&(this.Zt=i.selectedStyle.url,void 0!==i.selectedStyle.size)&&(this.Ht=i.selectedStyle.size),void 0!==i.newStyle)&&(this.Vt=i.newStyle.url,void 0!==i.newStyle.size)&&(this.Jt=i.newStyle.size)}},{key:"getStyle",value:function(t){return"lineStyle"===t?this.U:"polygonStyle"===t?this.Y:"pointStyle"===t?Rn(Rn({},this.G),{},{rectColor:this.it}):"centerStyle"===t?{url:this._,size:this.Ut}:"editStyle"===t?{url:this.Yt,size:this._t}:"pointRectColor"===t?this.it:"nodeStyle"===t?{editStyle:{url:this.Yt,size:this._t},selectedStyle:{url:this.Zt,size:this.Ht},newPointStyle:{url:this.Vt,size:this.Jt}}:void 0}},{key:"enable",value:function(){this.Gt=!0}},{key:"disable",value:function(){this.Gt=!1,this.cancel()}},{key:"delete",value:function(t){if(!t){if(this.deleteNode())return;if(!(t=this.W))return}this.cancel(),t.remove(),this.ht.L({type:"deleted",target:t})}},{key:"deleteNode",value:function(){for(var t=!1,i=[],e=0;e<this.H.length;e++)"point"!==this.H[e].opetype2||this.H[e].isNew||this.H[e].isSelected?this.H[e].isSelected&&(t=!0):i.push({x:this.H[e].x,y:this.H[e].y});if(0<i.length)if("addPolygon"===this.W.operationType)3<=i.length?(this.W.points=i,this.edit(this.W),this.qt(),this.ht.L({type:"edited",target:this.W})):(this.delete(this.W),this.W=null);else if("addLine"===this.W.operationType)if(i.length<2)this.delete(this.W),this.W=null;else{var n=new fengmap.FMSegment;n.points=[];for(var r=0;r<i.length;r++)n.points.push({x:i[r].x,y:i[r].y,z:this.W.height});n.level=this.W.segments[0].level,n.buildingID=this.W.segments[0].buildingID,this.W.segments=[n],this.edit(this.W),this.qt(),this.ht.L({type:"edited",target:this.W})}return t}},{key:"add",value:function(t){var i=null;if(t.markerType===T.IMAGE_MARKER){void 0===t.operationType&&(t.operationType="addPoint");var e,n=t.level,r=t.buildingID,r=(void 0===r&&(r=this.F.getMapOptions().mapID),this.F.getBuilding(r));for(e in this.G)void 0===t[e]&&(t[e]=this.G[e]);(i=new fengmap.FMImageMarker(t)).operationType=t.operationType,i.addTo(r.getFloor(n))}else if(t.markerType===T.LINE_MARKER){for(var s in void 0===t.operationType&&(t.operationType="addLine"),this.U)void 0===t[s]&&(t[s]=this.U[s]);(i=new fengmap.FMLineMarker(t)).operationType=t.operationType,i.addTo(this.F)}else if(t.markerType===T.POLYGON_MARKER){void 0===t.operationType&&(t.operationType="addPolygon");var o,r=t.level,n=t.buildingID,n=(void 0===n&&(n=this.F.getMapOptions().mapID),this.F.getBuilding(n));for(o in this.Y)void 0===t[o]&&(t[o]=this.Y[o]);(i=new fengmap.FMPolygonMarker(t)).operationType=t.operationType,i.addTo(n.getFloor(r))}return i}},{key:"edit",value:function(t){this.operationType="edit",this.W&&this.W.type===T.IMAGE_MARKER&&(this.W.url=this.W.oldUrl);for(var i,e=0;e<this.H.length;e++)this.H[e].remove();this.H.length=0,this.W=null,t&&((this.W=t).type===T.LINE_MARKER?(t.operationType||(t.operationType="addLine"),i=(i=t.segments[0].buildingID)||this.F.getMapOptions().mapID,this.yt({points:t.segments[0].points,height:t.height,info:{buildingID:i,level:t.segments[0].level}})):t.type===T.POLYGON_MARKER?(t.operationType||(t.operationType="addPolygon"),this.vt({points:t.points,height:t.height,operationType:t.operationType,info:{buildingID:t.parent.parent.parent.buildingID,level:t.level}})):t.type===T.IMAGE_MARKER&&(t.operationType||(t.operationType="addPoint"),this.q=null,this.dt(t)))}},{key:"cancel",value:function(){if("edit"===this.Dt){this.W&&this.W.type===T.IMAGE_MARKER&&this.edit(null);for(var t=0;t<this.H.length;t++)this.H[t].remove();this.H.length=0,this.W=null}else this.$t()}},{key:"dispose",value:function(){this.et.removeEventListener("mousedown",this.nt,!1),this.et.removeEventListener("mousemove",this.rt,!1),this.et.removeEventListener("mouseup",this.st,!1)}},{key:"on",value:function(t,i){this.ht.B(t,i)}}])&&Tn(t.prototype,e),n&&Tn(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n})(),Cn=(Object.assign(t.prototype,{ct:function(){this.et.addEventListener("mousedown",this.nt,!1),this.et.addEventListener("mousemove",this.rt,!1),this.et.addEventListener("mouseup",this.st,!1)},gt:function(t,i){var e=t.clientX-this.et.getBoundingClientRect().left,t=t.clientY-this.et.getBoundingClientRect().top,n=new U;n.x=e/this.et.getBoundingClientRect().width*2-1,n.y=2*-(t/this.et.getBoundingClientRect().height)+1,n.z=.5,this.ot.setFromCamera(n,this.F.camera);var r,s=null,o=Sn(this.F.getRenderManager().getRenderList());try{for(o.s();!(r=o.n()).done;)for(var h=Mn(r.value,2),u=(h[0],h[1]),a=this.ot.intersectObject(u,!0),f=0;f<a.length;f++)a[f].object.mapNode&&(s=a[f].object)}catch(t){o.e(t)}finally{o.f()}e=null;e=null!==s&&s.mapNode?s.mapNode.type!==T.LINE_MARKER?{buildingID:s.mapNode.parent.parent.parent.buildingID,level:s.mapNode.level}:{buildingID:s.selfBuildingID||this.F.getMapOptions().mapID,level:s.selfLevel}:{buildingID:this.F.getMapOptions().mapID,level:this.F.getLevel()},null===this.ut&&(this.ut=e),i&&i()},qt:function(){for(var t=0;t<this.H.length;t++)this.H[t].isNew||"point"===this.H[t].opetype2&&(this.H[t].url=this.Yt,this.H[t].size=this._t,this.H[t].isSelected=!1)},ti:function(){for(var t=[],i=null,e=0;e<this.H.length;e++)"center"===this.H[e].opetype2?i=this.H[e]:this.H[e].isNew?this.H[e].remove():(this.H[e].url=this.Yt,this.H[e].size=this._t,this.H[e].isSelected=!1,t.push(this.H[e]));for(var n=this.H.length=0;n<t.length;n++){this.H.push(t[n]);var r=0,s=0;if("addPolygon"===this.W.operationType)s=n===t.length-1?(r=(t[n].x+t[0].x)/2,(t[n].y+t[0].y)/2):(r=(t[n].x+t[n+1].x)/2,(t[n].y+t[n+1].y)/2);else if(n===t.length-1)continue;var o=0,h=null,u=(h="addPolygon"===this.W.operationType?(o=this.W.height,this.W.parent.parent):(o=this.W.height,u=(u=this.W.segments[0].buildingID)||this.F.getMapOptions().mapID,this.F.getBuilding(u).getFloor(this.W.segments[0].level)),new An({url:this.Vt,size:this.Jt,height:o,x:r,y:s,collision:!1,opetype:"point"}));u.isNew=!0,u.addTo(h),this.H.push(u)}this.H.push(i)},nt:function(h){var u=this;this.Gt&&(null===this.Dt||"delete"===this.Dt?this.Xt.length=0:this.gt(h,function(){var t=u.ut;if(2===h.button)"edit"!==u.Dt&&u.$t(),u.ut=null;else{u.Wt=(new Date).getTime();var i=h.clientX-u.et.getBoundingClientRect().left,e=h.clientY-u.et.getBoundingClientRect().top;if("edit"===u.Dt){u.Xt.length=0;var n=u.ii(i,e);if(n&&n.mapNode.visible)u.K=n.mapNode,u.St(!1),"addPolygon"!==u.W.operationType&&"addLine"!==u.W.operationType||(u.K.isNew?(u.K.isNew=!1,u.K.size=u._t,u.ti(),u.K.url=u.Zt,u.K.size=u.Ht,u.K.isSelected=!0,u.Rt(0,0)):(u.qt(),"center"!==u.K.opetype2&&(u.K.url=u.Zt,u.K.size=u.Ht,u.K.isSelected=!0)));else{n=u.ei(i,e);if(n&&n.mapNode&&n.mapNode.type===T.IMAGE_MARKER)u.K=n.mapNode,u.edit(n.mapNode),u.St(!1);else if(n&&u.W&&n.uuid===u.W.getRenderNode().uuid){u.zt.length=0,u.Kt.length=0;for(var n={x:i,y:e,buildingID:u.ut.buildingID,level:u.ut.level},r=fengmap.FMUtil.coordsScreenToMap(u.F,n),s=0;s<u.W.points.length;s++)u.zt.push({x:u.W.points[s].x-r.x,y:u.W.points[s].y-r.y});for(var o=0;o<u.H.length;o++)u.Kt.push({x:u.H[o].x-r.x,y:u.H[o].y-r.y});u.St(!1)}}u.ut=t}}}))},rt:function(t){var i,e;this.Gt&&null!==this.ut&&(t={x:t.clientX-this.et.getBoundingClientRect().left,y:t.clientY-this.et.getBoundingClientRect().top,buildingID:this.ut.buildingID,level:this.ut.level},t=fengmap.FMUtil.coordsScreenToMap(this.F,t),"edit"===this.Dt?((e=i=0)===this.zt.length?(this.K&&(i=t.x-this.K.x,e=t.y-this.K.y,this.K.moveTo({animate:!1,x:t.x,y:t.y})),this.K&&this.K.opetype2&&this.Rt(i,e)):this.ni(t),null!==this.W&&null!==this.K&&this.ht.L({type:"drawing",target:this.W})):("addLine"===this.Dt?this.Tt(t):"addPolygon"===this.Dt?this.It(t):this.ri(t),null!==this.Qt&&(this.Qt.operationType=this.Dt,this.ht.L({type:"drawing",target:this.Qt}))))},st:function(t){var i,e;this.Gt&&null!==this.ut&&(e=t.clientX-this.et.getBoundingClientRect().left,t=t.clientY-this.et.getBoundingClientRect().top,"delete"===this.Dt?(i=this.ei(e,t))&&i.mapNode&&this.delete(i.mapNode):("edit"===this.Dt?null===this.K?0!==this.zt.length?(this.zt.length=0,this.Kt.length=0,this.St(!0),this.ht.L({type:"edited",target:this.W})):(i=this.ei(e,t))&&i.mapNode?this.edit(i.mapNode):i||this.edit(null):(this.St(!0),this.K=null,this.ht.L({type:"edited",target:this.W})):null===this.Dt&&(this.St(!0),this.K=null),200<(new Date).getTime()-this.Wt?0===this.Xt.length&&(this.ut=null):"addPoint"!==this.Dt&&"addLine"!==this.Dt&&"addCircle"!==this.Dt&&"addEllipse"!==this.Dt&&"addRectangle"!==this.Dt&&"addPolygon"!==this.Dt||(i={x:e,y:t,buildingID:this.ut.buildingID,level:this.ut.level},(e=fengmap.FMUtil.coordsScreenToMap(this.F,i)).buildingID=this.ut.buildingID,e.level=this.ut.level,"addPoint"===this.Dt?(this.jt(e),this.ht.L({type:"drawn",target:this.Qt}),this.Qt=null,this.ut=null):"addLine"===this.Dt||"addPolygon"===this.Dt||0===this.Xt.length?this.Xt.push(e):(this.ri(e),this.ht.L({type:"drawn",target:this.Qt}),this.Xt.length=0,this.Qt=null,this.ut=null))))},ni:function(t){for(var i=[],e=0;e<this.zt.length;e++)i.push({x:t.x+this.zt[e].x,y:t.y+this.zt[e].y});for(var n=0;n<this.Kt.length;n++)this.H[n].moveTo({animate:!1,x:t.x+this.Kt[n].x,y:t.y+this.Kt[n].y});this.W.points=i},Rt:function(t,i){for(var e=[],n=null,r=[],s=0;s<this.H.length;s++)"center"===this.H[s].opetype2?n=this.H[s]:r.push(this.H[s]);for(var o,h,u=[],a=0;a<r.length;a++)u.push(r[a]),r[a].isNew?(h=o=0,h=a===r.length-1?(o=(r[a-1].x+r[0].x)/2,(r[a-1].y+r[0].y)/2):(o=(r[a-1].x+r[a+1].x)/2,(r[a-1].y+r[a+1].y)/2),r[a].moveTo({animate:!1,x:o,y:h})):e.push({x:r[a].x,y:r[a].y});var f=this.Ct(e).center;if("center"===this.K.opetype2){for(var l=0;l<e.length;l++)e[l].x=e[l].x+t,e[l].y=e[l].y+i;for(var c=0;c<r.length;c++)r[c].moveTo({animate:!1,x:r[c].x+t,y:r[c].y+i})}if("addLine"===this.W.operationType||"addPolygon"===this.W.operationType){var v=this.U.height;if(void 0===v&&(v=3),"addLine"===this.W.operationType)for(var y=0;y<e.length;y++)e[y].z=v;"center"!==this.K.opetype2&&n.moveTo({animate:!1,x:f.x,y:f.y}),"addLine"===this.W.operationType?((d=new fengmap.FMSegment).points=e,d.level=this.ut.level,d.buildingID=this.ut.buildingID,d=Rn(Rn({},this.U),{},{segments:[d]}),(d=new fengmap.FMLineMarker(d)).userID=this.W.userID,d.operationType=this.W.operationType,d.addTo(this.F),this.W.remove(),this.W=d):this.W.points=e}else if("addRectangle"===this.W.operationType){"center"!==this.K.opetype2&&n.moveTo({animate:!1,x:f.x,y:f.y});var d=Math.abs(r[0].x-r[1].x),b=Math.abs(r[0].y-r[1].y);this.W.points=fengmap.FMCalculator.rectangleBuilder(d,b,f)}else if("addCircle"===this.W.operationType){d=this.H[0].x-this.H[1].x,b=this.H[0].y-this.H[1].y,f=Math.sqrt(d*d+b*b);this.W.points=fengmap.FMCalculator.circleBuilder(f,{x:n.x,y:n.y},32)}else if("addEllipse"===this.W.operationType)if("center"===this.K.opetype2){d=this.Ct(this.W.points);this.W.points=this.Nt({x:n.x,y:n.y},d.xradius,d.yradius)}else{for(var p=null,m=null,w=0;w<r.length;w++)"xradius"===r[w].opetype2?p=Math.abs(r[w].x-n.x):m=Math.abs(r[w].y-n.y);null!==p&&null!==m&&(this.W.points=this.Nt({x:n.x,y:n.y},p,m))}},ii:function(t,i){for(var e=new G,n=(e.x=t/this.et.getBoundingClientRect().width*2-1,e.y=2*-(i/this.et.getBoundingClientRect().height)+1,this.ot.setFromCamera(e,this.F.camera),[]),r=0;r<this.H.length;r++)this.H[r].visible&&n.push(this.H[r].getRenderNode());t=this.ot.intersectObjects(n,!0);return 0<t.length?t[0].object:null},ei:function(h,u){var t,a=this,i=new G,e=(i.x=h/this.et.getBoundingClientRect().width*2-1,i.y=2*-(u/this.et.getBoundingClientRect().height)+1,this.ot.setFromCamera(i,this.F.camera),[]),n=Sn(this.F.getRenderManager().getRenderList());try{for(n.s();!(t=n.n()).done;){var r=Mn(t.value,2),s=r[0],o=r[1],f=s.split("%A%B%C%D")[2];if(f===""+T.LINE_MARKER||f===""+T.IMAGE_MARKER||f===""+T.POLYGON_MARKER)for(var l=o.children,c=0;c<l.length;c++){var v=l[c].mapNode;v&&void 0!==v.operationType&&e.push(l[c])}}}catch(t){n.e(t)}finally{n.f()}i=this.ot.intersectObjects(e,!0);return 0<i.length&&y(i)?y(i).object:null;function y(t){var i=fengmap.FMUtil.coordsScreenToMap(a.F,{x:h,y:u});if(1===t.length)return t[0];for(var e,n,r=null,s=null,o=0;o<t.length;o++)t[o].object.mapNode&&(n=t[o].object.mapNode.bound.center.x-i.x,e=t[o].object.mapNode.bound.center.y-i.y,0===o?(r=t[o],s=Math.sqrt(n*n+e*e)):(n=Math.sqrt(n*n+e*e))<s&&(s=n,r=t[o]));return r}},ri:function(t){"addCircle"===this.Dt?this.Et(t):"addEllipse"===this.Dt?this.xt(t):"addRectangle"===this.Dt&&this.Ot(t)},It:function(t,i){var e=[],n=null;if(i){null!==this.W&&this.W.remove();for(var r=0;r<t.length;r++)e.push({x:this.F.x+t[r].x,y:this.F.y-t[r].y})}else{if(0===this.Xt.length)return;null!==this.Qt&&(n=this.Qt.userID,this.Qt.remove());for(var s=0;s<this.Xt.length;s++)e.push({x:this.Xt[s].x,y:this.Xt[s].y});if(t)e.push({x:t.x,y:t.y});else if(2===e.length)return}var o,h=this.Y,u={};for(o in h)u[o]=h[o];u.points=e;var a,f=new fengmap.FMPolygonMarker(u);i?(a=this.F.getBuilding(this.ut.buildingID).getFloor(this.ut.level),f.addTo(a)):(a=this.F.getBuilding(this.Xt[0].buildingID).getFloor(this.Xt[0].level),f.addTo(a)),f.operationType=this.Dt,i?this.W=f:(this.Qt=f,null!==n&&(this.Qt.userID=n))},Tt:function(t,i){var e,n=new fengmap.FMSegment,r=(n.points=[],null),s={},o=this.U;for(e in o)s[e]=o[e];if(void 0===s.height&&(s.height=3),i){null!==this.W&&this.W.remove();for(var h=0;h<t.length;h++)n.points.push({x:this.F.x+t[h].x,y:this.F.y-t[h].y,z:s.height})}else{if(0===this.Xt.length)return;if(null!==this.Qt&&(r=this.Qt.userID,this.Qt.remove(),!t)&&1===this.Xt.length)return;for(var u=0;u<this.Xt.length;u++)n.points.push({x:this.Xt[u].x,y:this.Xt[u].y,z:s.height});t&&n.points.push({x:t.x,y:t.y,z:s.height})}i?(n.level=this.ut.level,n.buildingID=this.ut.buildingID):(n.level=this.Xt[0].level,n.buildingID=this.Xt[0].buildingID),s.segments=[n],s.pointSegCount=300;var a=new fengmap.FMLineMarker(s);a.operationType=this.Dt,a.addTo(this.F),i?this.W=a:(this.Qt=a,null!==r&&(this.Qt.userID=r))},Ot:function(t,i){var e=[],n=null;if(t||i){if(0===this.Xt.length)return;if(i)null!==this.W&&this.W.remove();else if(null!==this.Qt&&(n=this.Qt.userID,this.Qt.remove(),!t))return this.Xt.length=0,void(this.Qt=null);var r=this.Xt[0],e=[r,{x:t.x,y:r.y},t,{x:r.x,y:t.y}]}else if("edit"===this.Dt)e=this.q,null!==this.W&&this.W.remove();else if(null!==this.Qt)return this.Qt.remove(),this.Xt.length=0,void(this.Qt=null);if(0!==e.length){var s,o=this.Y,h={};for(s in o)h[s]=o[s];h.points=e;r=new fengmap.FMPolygonMarker(h);i?(e=this.F.getBuilding(this.ut.buildingID).getFloor(this.ut.level),r.addTo(e)):(e=this.F.getBuilding(this.Xt[0].buildingID).getFloor(this.Xt[0].level),r.addTo(e)),r.operationType=this.Dt,!t&&!i||i?this.W=r:(this.Qt=r,null!==n&&(this.Qt.userID=n))}},xt:function(t,i){var e=null,n=null;if(i)null!==this.W&&this.W.remove(),e=t;else{if(0===this.Xt.length)return;if(null!==this.Qt&&(n=this.Qt.userID,this.Qt.remove()),!t)return this.Xt.length=0,void(this.Qt=null);var r=this.Xt[0],s=Math.abs(t.x-r.x),t=Math.abs(t.y-r.y),e=t<s?this.Nt(r,s,s/2):this.Nt(r,t/2,t)}for(var o=[],h=0;h<e.length;h++)o.push({x:e[h].x,y:e[h].y});var u,a=this.Y,f={};for(u in a)f[u]=a[u];f.points=o;s=new fengmap.FMPolygonMarker(f);i?(r=this.F.getBuilding(this.ut.buildingID).getFloor(this.ut.level),s.addTo(r)):(t=this.F.getBuilding(this.Xt[0].buildingID).getFloor(this.Xt[0].level),s.addTo(t)),s.operationType=this.Dt,i?this.W=s:(this.Qt=s,null!==n&&(this.Qt.userID=n))},Nt:function(t,i,e){return new pt(t.x,t.y,i,e,0,2*Math.PI,!1,0).getPoints(32)},Et:function(t,i){if(0!==this.Xt.length){var e=null;if(i)null!==this.W&&this.W.remove();else if(null!==this.Qt&&(e=this.Qt.userID,this.Qt.remove(),!t))return this.Xt.length=0,void(this.Qt=null);var n,r=this.Xt[0],t=Math.sqrt((r.x-t.x)*(r.x-t.x)+(r.y-t.y)*(r.y-t.y)),s=this.Y,o={};for(n in s)o[n]=s[n];o.points=fengmap.FMCalculator.circleBuilder(t,this.Xt[0],32);var h,t=new fengmap.FMPolygonMarker(o);i?(h=this.F.getBuilding(this.ut.buildingID).getFloor(this.ut.level),t.addTo(h)):(h=this.F.getBuilding(r.buildingID).getFloor(r.level),t.addTo(h)),t.operationType=this.Dt,i?this.W=t:(this.Qt=t,null!==e&&(this.Qt.userID=e))}},jt:function(t){var i,e={},n=this.G;for(i in n)e[i]=n[i];e.x=t.x,e.y=t.y,e.buildingID=this.ut.buildingID;var t=this.F.getBuilding(this.ut.buildingID).getFloor(this.ut.level),r=new fengmap.FMImageMarker(e);r.addTo(t),r.operationType=this.Dt,this.Qt=r},$t:function(){var t;"addLine"===this.Dt?this.Tt():"addCircle"===this.Dt?this.Et():"addRectangle"===this.Dt?this.Ot():"addPolygon"===this.Dt?this.It():"addEllipse"===this.Dt&&this.xt(),"addLine"!==this.Dt&&"addPolygon"!==this.Dt||(t=!0,"addLine"===this.Dt?this.Xt.length<2&&(t=!1):"addPolygon"===this.Dt&&this.Xt.length<3&&(t=!1),null!==this.Qt&&(this.Qt.operationType=this.Dt,t&&(this.ht.L({type:"drawn",target:this.Qt}),this.ut=null),this.Xt.length=0,this.Qt=null))},Pt:function(t,i){for(var e=0;e<t.length;e++){var n=(n=t[e].optype)||"point",r=this.Yt,s=this._t,r=("center"===n&&(r=this._,s=this.Ut),t[e].isNew&&(r=this.Vt,s=this.Jt),new An({url:r,size:s,height:i.height,x:t[e].x,y:t[e].y,collision:!1,opetype:n})),s=this.F.getBuilding(i.info.buildingID).getFloor(i.info.level);r.isNew=t[e].isNew,r.addTo(s),void 0!==this.tt&&("move"===this.tt?"center"!==n&&(r.visible=!1):"edit"===this.tt&&"center"===n&&(r.visible=!1)),t[e].isHidden&&(r.visible=!1),this.H.push(r)}},yt:function(t){for(var i=[],e=(this.q=t.points,this.Ct(t.points).center),n=this.X.length=0;n<t.points.length;n++){i.push(t.points[n]),this.X.push({x:t.points[n].x-e.x,y:t.points[n].y-e.y});var r,s;n<t.points.length-1&&(r=(t.points[n].x+t.points[n+1].x)/2,s=(t.points[n].y+t.points[n+1].y)/2,i.push({x:r,y:s,isNew:!0}),this.X.push({x:r-e.x,y:s-e.y}))}i.push({x:e.x,y:e.y,optype:"center"}),this.Pt(i,t)},Ct:function(t){for(var i,e,o=null,h=null,u=null,a=null,f=[],n=0;n<t.length;n++)"addPolygon"!==this.W.operationType&&"addLine"!==this.W.operationType||(f.push(t[n]),"addPolygon"===this.W.operationType?(e=i=0,e=n===t.length-1?(i=(t[n].x+t[0].x)/2,(t[n].y+t[0].y)/2):(i=(t[n].x+t[n+1].x)/2,(t[n].y+t[n+1].y)/2),f.push({x:i,y:e})):n<t.length-1&&f.push({x:(t[n].x+t[n+1].x)/2,y:(t[n].y+t[n+1].y)/2})),0===n?(o=t[n].x,h=t[n].y,u=t[n].x,a=t[n].y):(o>t[n].x&&(o=t[n].x),h>t[n].y&&(h=t[n].y),u<t[n].x&&(u=t[n].x),a<t[n].y&&(a=t[n].y));return"addPolygon"!==this.W.operationType&&"addLine"!==this.W.operationType||function t(){var i={x:(o+u)/2,y:(h+a)/2};var e=!0;for(var n=0;n<f.length;n++){var r=f[n].x-i.x,s=f[n].y-i.y,r=r*r+s*s;if(r<50){e=!1;break}}e||(h-=2,t())}(),{center:{x:(o+u)/2,y:(h+a)/2},xradius:Math.abs(u-o)/2,yradius:Math.abs(a-h)/2}},vt:function(t){var i,e=[];if(void 0===t.operationType&&(t.operationType="addPolygon"),"addPolygon"===t.operationType){this.q=t.points;for(var n=this.Ct(t.points).center,r=this.X.length=0;r<t.points.length;r++){e.push(t.points[r]),this.X.push({x:t.points[r].x-n.x,y:t.points[r].y-n.y});var s=0,o=0,o=r===t.points.length-1?(s=(t.points[r].x+t.points[0].x)/2,(t.points[r].y+t.points[0].y)/2):(s=(t.points[r].x+t.points[r+1].x)/2,(t.points[r].y+t.points[r+1].y)/2);e.push({x:s,y:o,isNew:!0}),this.X.push({x:s-n.x,y:o-n.y})}e.push({x:n.x,y:n.y,optype:"center",isHidden:!0})}else"addRectangle"===t.operationType?(this.q=t.points,e.push(t.points[0]),e.push(t.points[2]),e.push({x:(t.points[0].x+t.points[2].x)/2,y:(t.points[0].y+t.points[2].y)/2,optype:"center",isHidden:!0}),this.X.length=0,this.X.push({x:Math.abs(t.points[0].x-t.points[2].x)/2,y:Math.abs(t.points[0].y-t.points[2].y)/2})):"addCircle"!==t.operationType&&"addEllipse"!==t.operationType||(i=this.Ct(t.points),this.q=i,e.push({x:i.center.x,y:i.center.y,optype:"center",isHidden:!0}),e.push({x:i.center.x,y:i.center.y+i.yradius,optype:"yradius"}),"addEllipse"===t.operationType&&e.push({x:i.center.x+i.xradius,y:i.center.y,optype:"xradius"}));this.Pt(e,t)},dt:function(i){var e,n=this;i.editUrl?(i.oldUrl=i.url,i.url=i.editUrl):((e=new Image).crossOrigin="Anonymous",e.onload=function(){var t=n.si(e).toDataURL();i.oldUrl=i.url,i.editUrl=t,i.url=t},e.src=i.url)},si:function(t){var i=document.createElement("canvas"),e=(i.width=64,i.height=64,i.getContext("2d"));return e.lineWidth="5",e.strokeStyle=this.it,e.drawImage(t,0,0,64,64),e.rect(0,0,i.width,i.height),e.stroke(),i},St:function(t){var i=this.F.getInteracations();t?(i.enableDrag=this.lt.enableDrag,i.enableRotate=this.lt.enableRotate,i.enableTilt=this.lt.enableTilt,i.enableZoom=this.lt.enableZoom):(i.enableDrag=t,i.enableRotate=t,i.enableTilt=t,i.enableZoom=t)}}),function(t,i,e){e=e||2;var n,r,s,o,h,u=i&&i.length,a=u?i[0]*e:t.length,f=Bn(t,0,a,e,!0),l=[];if(f&&f.next!==f.prev){if(u&&(f=((t,i,e,n)=>{var r,s,o,h,u=[];for(r=0,s=i.length;r<s;r++)h=i[r]*n,o=r<s-1?i[r+1]*n:t.length,(h=Bn(t,h,o,n,!1))===h.next&&(h.steiner=!0),u.push((t=>{for(var i=t,e=t;(i.x<e.x||i.x===e.x&&i.y<e.y)&&(e=i),(i=i.next)!==t;);return e})(h));for(u.sort(Pn),r=0;r<u.length;r++){{a=void 0;f=void 0;var a=u[r];var f=e;(f=((t,i)=>{var e,n=i,r=t.x,s=t.y,o=-1/0;do{if(s<=n.y&&s>=n.next.y&&n.next.y!==n.y){var h=n.x+(s-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(h<=r&&o<h){if((o=h)===r){if(s===n.y)return n;if(s===n.next.y)return n.next}e=n.x<n.next.x?n:n.next}}}while((n=n.next)!==i);if(!e)return null;if(r!==o){var u,a=e,f=e.x,l=e.y,c=1/0;for(n=e;r>=n.x&&n.x>=f&&r!==n.x&&Fn(s<l?r:o,s,f,l,s<l?o:r,s,n.x,n.y)&&(u=Math.abs(s-n.y)/(r-n.x),_n(n,t))&&(u<c||u===c&&(n.x>e.x||n.x===e.x&&((t,i)=>C(t.prev,t,i.prev)<0&&C(i.next,t,t.next)<0)(e,n)))&&(e=n,c=u),(n=n.next)!==a;);}return e})(a,f))&&(a=Vn(f,a),I(f,f.next),I(a,a.next))}e=I(e,e.next)}return e})(t,i,f,e)),t.length>80*e){for(var c=n=t[0],v=r=t[1],y=e;y<a;y+=e)(s=t[y])<c&&(c=s),(o=t[y+1])<v&&(v=o),n<s&&(n=s),r<o&&(r=o);h=0!==(h=Math.max(n-c,r-v))?1/h:0}Nn(f,l,e,c,v,h)}return l});function Bn(t,i,e,n,r){var s,o;if(r===0<((t,i,e,n)=>{for(var r=0,s=i,o=e-n;s<e;s+=n)r+=(t[o]-t[s])*(t[s+1]+t[o+1]),o=s;return r})(t,i,e,n))for(s=i;s<e;s+=n)o=Jn(s,t[s],t[s+1],o);else for(s=e-n;i<=s;s-=n)o=Jn(s,t[s],t[s+1],o);return o&&Dn(o,o.next)&&(Zn(o),o=o.next),o}function I(t,i){if(!t)return t;i=i||t;var e,n=t;do{if(e=!1,n.steiner||!Dn(n,n.next)&&0!==C(n.prev,n,n.next))n=n.next;else{if(Zn(n),(n=i=n.prev)===n.next)break;e=!0}}while(e||n!==i);return i}function Nn(t,i,e,n,r,s,o){if(t){if(!o&&s){for(var h=t,u=n,a=r,f=s,l=h;null===l.z&&(l.z=Ln(l.x,l.y,u,a,f)),l.prevZ=l.prev,l.nextZ=l.next,(l=l.next)!==h;);l.prevZ.nextZ=null,l.prevZ=null;var c,v,y,d,b,p,m,w,k=l,g=1;do{for(v=k,b=k=null,p=0;v;){for(p++,y=v,c=m=0;c<g&&(m++,y=y.nextZ);c++);for(w=g;0<m||0<w&&y;)0!==m&&(0===w||!y||v.z<=y.z)?(v=(d=v).nextZ,m--):(y=(d=y).nextZ,w--),b?b.nextZ=d:k=d,d.prevZ=b,b=d;v=y}}while(b.nextZ=null,g*=2,1<p)}for(var A,M,S=t;t.prev!==t.next;)if(A=t.prev,M=t.next,s?((t,i,e,n)=>{var r=t.prev,s=t,o=t.next;if(!(0<=C(r,s,o))){for(var h=(r.x<s.x?r.x<o.x?r:o:s.x<o.x?s:o).x,u=(r.y<s.y?r.y<o.y?r:o:s.y<o.y?s:o).y,a=(s.x<r.x?r.x>o.x?r:o:s.x>o.x?s:o).x,f=(s.y<r.y?r.y>o.y?r:o:s.y>o.y?s:o).y,l=Ln(h,u,i,e,n),c=Ln(a,f,i,e,n),v=t.prevZ,y=t.nextZ;v&&v.z>=l&&y&&y.z<=c;){if(v!==t.prev&&v!==t.next&&Fn(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&0<=C(v.prev,v,v.next))return;if(v=v.prevZ,y!==t.prev&&y!==t.next&&Fn(r.x,r.y,s.x,s.y,o.x,o.y,y.x,y.y)&&0<=C(y.prev,y,y.next))return;y=y.nextZ}for(;v&&v.z>=l;){if(v!==t.prev&&v!==t.next&&Fn(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&0<=C(v.prev,v,v.next))return;v=v.prevZ}for(;y&&y.z<=c;){if(y!==t.prev&&y!==t.next&&Fn(r.x,r.y,s.x,s.y,o.x,o.y,y.x,y.y)&&0<=C(y.prev,y,y.next))return;y=y.nextZ}return 1}})(t,n,r,s):(t=>{var i=t.prev,e=t,n=t.next;if(!(0<=C(i,e,n))){for(var r=t.next.next;r!==t.prev;){if(Fn(i.x,i.y,e.x,e.y,n.x,n.y,r.x,r.y)&&0<=C(r.prev,r,r.next))return;r=r.next}return 1}})(t))i.push(A.i/e),i.push(t.i/e),i.push(M.i/e),Zn(t),t=M.next,S=M.next;else if((t=M)===S){o?1===o?Nn(t=((t,i,e)=>{var n=t;do{var r=n.prev,s=n.next.next}while(!Dn(r,s)&&Gn(r,n,n.next,s)&&_n(r,s)&&_n(s,r)&&(i.push(r.i/e),i.push(n.i/e),i.push(s.i/e),Zn(n),Zn(n.next),n=t=s),(n=n.next)!==t);return I(n)})(I(t),i,e),i,e,n,r,s,2):2===o&&((t,i,e,n,r,s)=>{var o=t;do{for(var h,u=o.next.next;u!==o.prev;){if(o.i!==u.i&&((t,i)=>t.next.i!==i.i&&t.prev.i!==i.i&&!((t,i)=>{var e=t;do{if(e.i!==t.i&&e.next.i!==t.i&&e.i!==i.i&&e.next.i!==i.i&&Gn(e,e.next,t,i))return 1}while((e=e.next)!==t)})(t,i)&&(_n(t,i)&&_n(i,t)&&((t,i)=>{for(var e=t,n=!1,r=(t.x+i.x)/2,s=(t.y+i.y)/2;e.y>s!=e.next.y>s&&e.next.y!==e.y&&r<(e.next.x-e.x)*(s-e.y)/(e.next.y-e.y)+e.x&&(n=!n),(e=e.next)!==t;);return n})(t,i)&&(C(t.prev,t,i.prev)||C(t,i.prev,i))||Dn(t,i)&&0<C(t.prev,t,t.next)&&0<C(i.prev,i,i.next)))(o,u))return h=Vn(o,u),o=I(o,o.next),h=I(h,h.next),Nn(o,i,e,n,r,s),Nn(h,i,e,n,r,s);u=u.next}}while((o=o.next)!==t)})(t,i,e,n,r,s):Nn(I(t),i,e,n,r,s,1);break}}}function Pn(t,i){return t.x-i.x}function Ln(t,i,e,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-e)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-n)*r)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function Fn(t,i,e,n,r,s,o,h){return 0<=(r-o)*(i-h)-(t-o)*(s-h)&&0<=(t-o)*(n-h)-(e-o)*(i-h)&&0<=(e-o)*(s-h)-(r-o)*(n-h)}function C(t,i,e){return(i.y-t.y)*(e.x-i.x)-(i.x-t.x)*(e.y-i.y)}function Dn(t,i){return t.x===i.x&&t.y===i.y}function Gn(t,i,e,n){var r=Yn(C(t,i,e)),s=Yn(C(t,i,n)),o=Yn(C(e,n,t)),h=Yn(C(e,n,i));return r!==s&&o!==h||0===r&&Un(t,e,i)||0===s&&Un(t,n,i)||0===o&&Un(e,t,n)||!(0!==h||!Un(e,i,n))}function Un(t,i,e){return i.x<=Math.max(t.x,e.x)&&i.x>=Math.min(t.x,e.x)&&i.y<=Math.max(t.y,e.y)&&i.y>=Math.min(t.y,e.y)}function Yn(t){return 0<t?1:t<0?-1:0}function _n(t,i){return C(t.prev,t,t.next)<0?0<=C(t,i,t.next)&&0<=C(t,t.prev,i):C(t,i,t.prev)<0||C(t,t.next,i)<0}function Vn(t,i){var e=new Hn(t.i,t.x,t.y),n=new Hn(i.i,i.x,i.y),r=t.next,s=i.prev;return(t.next=i).prev=t,(e.next=r).prev=e,n.next=e,(s.next=e.prev=n).prev=s,n}function Jn(t,i,e,n){t=new Hn(t,i,e);return n?(t.next=n.next,(t.prev=n).next.prev=t,n.next=t):(t.prev=t).next=t,t}function Zn(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Hn(t,i,e){this.i=t,this.x=i,this.y=e,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qn(t){return(t=>{if(Array.isArray(t))return Xn(t)})(t)||(t=>{if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)})(t)||((t,i)=>{var e;if(t)return"string"==typeof t?Xn(t,i):"Map"===(e="Object"===(e={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Xn(t,i):void 0})(t)||(()=>{throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function Xn(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,n=Array(i);e<i;e++)n[e]=t[e];return n}var zn={area:function(t){for(var i=t.length,e=0,n=i-1,r=0;r<i;n=r++)e+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*e},isClockWise:function(t){return zn.area(t)<0},triangulateShape:function(t,i){var e=[],n=[],r=[],s=(Kn(t),Wn(e,t),t.length);i.forEach(Kn);for(var o=0;o<i.length;o++)n.push(s),s+=i[o].length,Wn(e,i[o]);for(var h=Cn(e,n),u=0;u<h.length;u+=3)r.push(h.slice(u,u+3));return r},triangulate:function(t){(r=[]).push.apply(r,Qn(t[0]));for(var i=[],e=1;e<t.length;e++){var n=[];n.push.apply(n,Qn(t[e])),i.push(n)}if(!zn.isClockWise(r))for(var r=r.reverse(),s=0,o=i.length;s<o;s++){var h=i[s];zn.isClockWise(h)&&(i[s]=h.reverse())}return zn.triangulateShape(r,i)}};function Kn(t){var i,e=t.length;2<e&&(e=t[e-1],i=t[0],e.x===i.x)&&e.y===i.y&&t.pop()}function Wn(t,i){for(var e=0;e<i.length;e++)t.push(i[e].x),t.push(i[e].y)}function qn(t){return(qn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $n(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=qn(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=qn(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==qn(t)?t:t+""))(n.key),n)}}function tr(t,i,e){return i&&$n(t.prototype,i),e&&$n(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t}var B=1e-5,ir=.001,er=Math.PI/180,nr=180/Math.PI,rr=tr(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")});Object.assign(rr.prototype,{oi:function(){return B},hi:function(){return er},ui:function(){return nr},ai:function(t){return t<B&&-B<t},fi:function(t){return B<t},li:function(t){return t<-B},ci:function(t,i,e){i=(t.x-e.x)*(i.y-e.y)-(i.x-e.x)*(t.y-e.y);return Math.abs(i)<B?0:i},distanceOfTwoPoints:function(t,i){return t&&i?Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)):Number.NaN},distance:function(t,i){return Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))},isPolygonContainPoint:function(t,i){for(var e=0,n=0;n<t.length;n++){var r=t[n].x,s=t[n].y,o=0,h=0,h=(n<t.length-1?(o=t[n+1].x,t[n+1]):(o=t[0].x,t[0])).y;if(r===i.x&&s===i.y||o===i.x&&h===i.y)return!0;if(h!==s){var u=r+(i.y-s)*(o-r)/(h-s);if(u===i.x)return!0;r!==o?u<=Math.max(r,o)&&u>=Math.min(r,o)&&u>i.x&&u!==r&&(u===o&&0<(s-i.y)*(h-i.y)?e+=2:e++):u<=Math.max(r,o)&&u>=Math.min(r,o)&&u>i.x&&(u===o&&0<(s-i.y)*(h-i.y)?e+=2:e++)}}return 0<e%2},isPolygonContainPoint2:function(t,i){var e=t.length;if(e<3)return!1;for(var n=e-1,r=0,s=0;s<e;s++){var o=t[s],h=t[n];o.y>i.y!=h.y>i.y&&i.x<(h.x-o.x)*(i.y-o.y)/(h.y-o.y)+o.x&&(o.y>h.y?r++:r--),n=s}return 0!=r},isPolygonInPolygon:function(t,i){var e=Object.assign([],t),n=Object.assign([],i);e.push(e[0]),n.push(n[0]);for(var r=0;r<e.length-1;r++){var s=e[r];if(!this.isPolygonContainPoint(n,s)&&!this.isPolygonContainPoint2(n,s))return!1}for(var o=0;o<e.length-1;o++)for(var h=0;h<n.length-1;h++)if(this.vi(e[o],e[o+1],n[h],n[h+1]).isintersect&&!this.yi(n[h],n[h+1],e[o])&&!this.yi(n[h],n[h+1],e[o+1]))return!1;return!0},di:function(t,i,e,n){return!(Math.max(t.x,i.x)<Math.min(e.x,n.x)||Math.max(t.y,i.y)<Math.min(e.y,n.y)||Math.max(e.x,n.x)<Math.min(t.x,i.x)||Math.max(e.y,n.y)<Math.min(t.y,i.y))},bi:function(t,i,e,n){return!(Math.max(t.x,i.x)<Math.min(e.x,n.x)||Math.max(t.y,i.y)<Math.min(e.y,n.y)||Math.max(e.x,n.x)<Math.min(t.x,i.x)||Math.max(e.y,n.y)<Math.min(t.y,i.y)||0===this.ci(e,i,t)&&0===this.ci(i,n,t)||this.ci(e,i,t)*this.ci(i,n,t)<0||this.ci(t,n,e)*this.ci(n,i,e)<0)},pi:function(t,i,e){return!(t.x<i.x||t.y<i.y||t.x>e.x||e.y<t.y)},mi:function(t,i,e){var n=Math.min(i.x,e.x),r=Math.max(i.x,e.x),s=Math.min(i.y,e.y),i=Math.max(i.y,e.y);return!(t.x<n||t.x>r||t.y<s||t.y>i)},wi:function(t,i,e){var n=Math.min(e.x,i.x),r=Math.max(e.x,i.x),s=Math.min(e.y,i.y),e=Math.max(e.y,i.y);return!(t.x<n||t.x>r||t.y<s||t.y>e)},ki:function(t,i,e){for(var n,r,s=!1,o=0;o<e;o++)n=i[o],r=i[(o+1)%e],(n.y<t.y&&r.y>=t.y||r.y<t.y&&n.y>=t.y)&&(n.x<=t.x||r.x<=t.x)&&n.x+(t.y-n.y)/(r.y-n.y)*(r.x-n.x)<t.x&&(s=!s);return s},gi:function(t,i,e){return(t.x-i.x)*(e.y-i.y)==(e.x-i.x)*(t.y-i.y)&&Math.min(i.x,e.x)<=t.x&&t.x<=Math.max(i.x,e.x)&&Math.min(i.y,e.y)<=t.y&&t.y<=Math.max(i.y,e.y)},Ai:function(t,i){return Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y))},Mi:function(t,i){return(t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)},Si:function(t,i,e){var n=i.x,i=i.y,r=e.x,e=e.y,s=t.x,t=t.y,o=r-n,h=e-i,u=o*o+h*h,a=s-n,f=t-i,l=a*a+f*f;return this.ai(u)?this.ai(l)?0:l:(u=Math.sqrt(u),f=this.fi(h=(o=o/u)*a+(a=h/u)*f)?this.li(h-u)?(f=s-(n+h*o))*f+(u=t-(i+h*a))*u:(n=s-r)*n+(o=t-e)*o:l,this.ai(f)?0:f)},ji:function(t,i,e,n){var r,s=i.x,o=i.y,h=e.x,u=e.y,a=t.x,t=t.y,f=h-s,l=u-o,c=Math.sqrt(f*f+l*l),v=a-s,y=t-o,d=Math.sqrt(v*v+y*y);return this.ai(c)?(n.x=i.x,n.y=i.y,this.ai(r=d)?0:r):(r=this.fi(l=(f=f/c)*v+(v=l/c)*y)?this.li(l-c)?(c=a-(y=s+l*f),f=t-(s=o+l*v),o=Math.sqrt(c*c+f*f),n.x=y,n.y=s,o):(l=a-h,v=t-u,c=Math.sqrt(l*l+v*v),n.x=e.x,n.y=e.y,c):(n.x=i.x,n.y=i.y,d),this.ai(r)?0:r)},Ei:function(t,i){for(var e=0,n=0,r=0,s=0;s<i;s++){var o=t[s],h=t[(s+1)%i],u=(o.x*h.y-o.y*h.x)/2;e+=u,n+=u*(o.x+h.x)/3,r+=u*(o.y+h.y)/3}return{x:n/=e,y:r/=e}},Oi:function(t){for(var i=zn.triangulate([t]),e=0,n=0,r=0,s=0;s<i.length;s++){var o=t[i[s][0]],h=t[i[s][1]],u=t[i[s][2]],a=h.x-o.x,f=h.y-o.y,l=u.x-o.x,a=(a*(u.y-o.y)-l*f)/2;e+=a,n+=(o.x+h.x+u.x)/3*a,r+=(o.y+h.y+u.y)/3*a}return{x:n/e,y:r/e}},xi:function(t,i){if(i<3)return 0;for(var e=0,n=0;n<i;++n){var r=t[n],s=t[(n+1)%i];e+=r.x*s.y-r.y*s.x}return Math.abs(e/2)},Ri:function(t,i,e,n,r){var s;return this.bi(t,i,e,n)?(s=(n.x-e.x)*(t.y-i.y)-(i.x-t.x)*(e.y-n.y),r.x=((t.y-e.y)*(i.x-t.x)*(n.x-e.x)+e.x*(n.y-e.y)*(i.x-t.x)-t.x*(i.y-t.y)*(n.x-e.x))/s,r.y=(i.y*(t.x-i.x)*(n.y-e.y)+(n.x-i.x)*(n.y-e.y)*(t.y-i.y)-n.y*(e.x-n.x)*(i.y-t.y))/(s=(t.x-i.x)*(n.y-e.y)-(i.y-t.y)*(e.x-n.x)),1):0},Ti:function(t,i,e,n,r){var s=Math.min(e.x,n.x),o=Math.max(e.x,n.x),h=Math.min(e.y,n.y),u=Math.max(e.y,n.y),a=t.x,f=t.y,l=e.x,c=e.y,v=n.x,y=n.y;if(90==i)return!(t.x<s||t.x>o||(o-s<ir?t.y>=c&&t.y<=y||t.y>=y&&t.y<=c?(r.x=t.x,r.y=t.y,0):c<y&&t.x<c?(r.x=l,r.y=c,0):!(y<c&&t.x<y)||(r.x=v,r.y=y,0):(r.y=d=(y-c)/(v-l)*(a-l)+c,r.x=a,d<f||!this.wi(r,e,n))));if(270==i)return!(t.x<s||t.x>o||(Math.abs(o-s<ir)?t.y>=c&&t.y<=y||t.y>=y&&t.y<=c?(r.x=t.x,r.y=t.y,0):c<y&&t.y>y?(r.x=v,r.y=y,0):!(y<c&&t.y>c)||(r.x=l,r.y=c,0):(r.y=d=(y-c)/(v-l)*(a-l)+c,r.x=a,f<d||!this.wi(r,e,n))));if(270!=i&&90!=i&&Math.abs(o-s<ir)){var t=s,d=Math.tan(i/180*Math.PI)*(t-a)+f;if(r.y=d,r.x=t,this.wi(r,e,n))return o=d-f,0<(s=t-a)/Math.sqrt(s*s+o*o)*Math.cos(i/180*Math.PI)}return Math.abs(u-h<=ir)?(d=h,t=1/Math.tan(i/180*Math.PI)*(d-f)+a,r.x=t,r.y=d,!!this.wi(r,e,n)&&(s=d-f,0<(o=t-a)/Math.sqrt(o*o+s*s)*Math.cos(i/180*Math.PI))):(t=f+(u=Math.tan(i/180*Math.PI))*((d=(c-f-((h=(y-c)/(v-l))*l-u*a))/(u-h))-a),r.x=d,r.y=t,!!this.wi(r,e,n)&&(o=d-a,s=t-f,Math.abs(o)<=ir&&Math.abs(s)<=ir||0<o/Math.sqrt(o*o+s*s)*Math.cos(i/180*Math.PI)))},Ii:function(t,i){return Math.abs(t.x-i.x)<B&&Math.abs(t.y-i.y)<B},Ci:function(t,i,e,n){var r,s,o,h,u=t.x,a=t.y,f=i.x,l=i.y,c=e.x,v=e.y;return this.Ii(t,i)||this.Ii(t,e)?(n.x=u,n.y=a,!0):(o=Math.min(i.x,e.x),h=Math.max(i.x,e.x),r=Math.min(i.y,e.y),s=Math.max(i.y,e.y),Math.abs(f-c)<1e-5?(n.x=f,r<=(n.y=a)&&a<=s):Math.abs(l-v)<1e-5?(n.x=u,n.y=l,o<=u&&u<=h):(h=a+(r=-1/((v-l)/(c-f)))*((o=(l-a-((s=(v-l)/(c-f))*f-r*u))/(r-s))-u),n.x=o,n.y=h,!!this.wi(n,i,e)||!(!this.Ii(t,i)&&!this.Ii(t,e))))},Bi:function(t,i){return{x:t.y*i.z-t.z*i.y,y:t.z*i.x-t.x*i.z,z:t.x*i.y-t.y*i.x}},Ni:function(t,i){return t.x*i.x+t.y*i.y+t.z*i.z},Pi:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},Li:function(t,i){return t.x*i.x+t.y*i.y},Fi:function(t,i){return t.x*i.y-t.y*i.x},Di:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},Gi:function(t,i){var e,n;return 0==t.x&&0==t.y||0==i.x&&0==i.y?0:(e={x:i.x,y:i.y,z:0},e=this.Bi({x:t.x,y:t.y,z:0},e),n=this.Li(t,i),n=Math.acos(n/(this.Di(t)*this.Di(i))),0<e.z?n/Math.PI*180:360-n/Math.PI*180)},Ui:function(t,i,e,n){for(var r=0;r<e.length;r++)if(1==this.Ri(t,i,e[r],e[(r+1)%e.length],n))return!0;return!1},Yi:function(t,i,e,n,r){var s=Math.min(t.x,e.x,n.x),o=Math.max(t.x,e.x,n.x),h=Math.min(t.y,e.y,n.y),u=Math.max(t.y,e.y,n.y),o=Math.sqrt((o-s)*(o-s)+(u-h)*(u-h)),s=i/180*Math.PI,u=o*Math.cos(s)+t.x,h=o*Math.sin(s)+t.y;return 1==this.Ri(t,{x:u,y:h},e,n,r)},_i:function(t){var i={x:null,y:null},e=0,n=0,r=t.length;1<t.length&&t[0].x===t[t.length-1].x&&t[0].y===t[t.length-1].y&&r--;for(var s=0;s<r;s++)e+=t[s].x,n+=t[s].y;return i.x=e/t.length,i.y=n/t.length,i},Vi:function(t,i,e,n){var r=[],s=t.x-i,o=t.x+i,h=t.y-i,u=t.y+i,a=Math.min(e.x,n.x),f=Math.max(e.x,n.x),l=Math.min(e.y,n.y),c=Math.max(e.y,n.y);return f<s||o<a||c<h||u<l||(o=(t=((s=n.x-e.x)*(o=t.x-e.x)+(h=n.y-e.y)*(u=t.y-e.y))/(n=s*s+h*h))*t-(o*o+u*u-i*i)/n)<0||(u=Math.sqrt(o),n={x:e.x-s*(i=-t+u),y:e.y-h*i},s={x:e.x-s*(o=-t-u),y:e.y-h*o},i!==o&&(a<=n.x&&n.x<=f&&l<=n.y&&n.y<=c&&r.push(n),a<=s.x)&&s.x<=f&&l<=s.y&&s.y<=c&&r.push(s)),r},Ji:function(t,i){return Math.abs(t.x-i.x)<=B&&Math.abs(t.y-i.y)<=B},Zi:function(t,i,e){var n,r={};if(t.x!=i.x)return n=i=(i.y-t.y)/(i.x-t.x),r.x=(+e.x- -1*n*e.y-n*(i=t.y-i*t.x))/(n*n+1),r.y=(n*n*e.y- -1*n*e.x- -1*i)/(n*n+1),r;r.x=t.x,r.y=e.y},vi:function(t,i,e,n){var r,s,o,h,u={point:null,isintersect:!1};return this.distanceOfTwoPoints(t,e)<.001||this.distanceOfTwoPoints(t,n)<.001?(u.isintersect=!0,u.point=t):this.distanceOfTwoPoints(i,e)<.001||this.distanceOfTwoPoints(i,n)<.001?(u.isintersect=!0,u.point=i):(r={x:i.x-t.x,y:i.y-t.y},s={x:n.x-e.x,y:n.y-e.y},n={x:n.x-t.x,y:n.y-t.y},i={x:i.x-e.x,y:i.y-e.y},o={x:-(e={x:e.x-t.x,y:e.y-t.y}).x,y:-e.y},h=this.Fi(s,r),Math.abs(h)<=1e-5||this.Fi(e,r)*this.Fi(n,r)<=-5e-4&&this.Fi(o,s)*this.Fi(i,s)<-5e-4&&(n=this.Fi(s,e)/h,u.point={x:t.x+r.x*n,y:t.y+r.y*n},u.isintersect=!0)),u},Hi:function(t,i,e){return t.x===i.x&&(i.x=i.x+1),t.y===i.y&&(i.y=i.y+1),i.x===e.x&&(e.x=e.x+1),i.y===e.y&&(e.y=e.y+1),!(0<(i.x-t.x)*(e.y-i.y)-(i.y-t.y)*(e.x-i.x))},getAngle:function(t){var i=t.p1,t=t.p2,e=t.x-i.x,t=t.y-i.y,i=Math.sqrt(e*e+t*t),i=Math.asin(Math.abs(t)/i);return 0<e&&0<t?i:e<0&&0<t?Math.PI-i:e<0&&t<0?Math.PI+i:0<e&&t<0?2*Math.PI-i:0==e&&0<t?i:0==e&&t<0?3*Math.PI/2:0<e&&0==t?i:e<0&&0==t?Math.PI:null},Qi:function(t){var i=this.distanceOfTwoPoints(t[0],t[1]),e=this.distanceOfTwoPoints(t[1],t[2]),t=this.distanceOfTwoPoints(t[0],t[2]),n=(i+e+t)/2;return Math.sqrt(n*(n-i)*(n-e)*(n-t))},Xi:function(t,i){var e,n,r,s,o;return this.ji(t,i[0],i[1],{})<1e-4||this.ji(t,i[0],i[2],{})<1e-4||this.ji(t,i[1],i[2],{})<1e-4||(s={x:i[1].x-i[0].x,y:i[1].y-i[0].y},e={x:i[0].x-i[2].x,y:i[0].y-i[2].y},n={x:i[2].x-i[1].x,y:i[2].y-i[1].y},o={x:t.x-i[0].x,y:t.y-i[0].y},r={x:t.x-i[1].x,y:t.y-i[1].y},t={x:t.x-i[2].x,y:t.y-i[2].y},i=this.Fi(s,o),s=this.Fi(n,r),o=this.Fi(e,t),B<i*s&&B<s*o)},zi:function(t,i,e){var n=e.length,r={isintersect:!1,start:null,end:null,type:0,outer:null},s=[];if(this.Xi(t,e)&&(r.start=t),this.Xi(i,e)&&(r.end=i),null!=r.start&&null!=r.end)r.isintersect=!0,r.type=1;else{for(var o=(e[1].x+e[2].x)/2,h=(e[1].y+e[2].y)/2,u=1;u<n;u++){var a,f=this.vi(t,i,e[u-1],e[u]);if(f.isintersect){if(null!=r.start)return r.end=f.point,r.isintersect=!0,r.outer="end",a=this.Gi({x:o-e[0].x,y:h-e[0].y},{x:i.x-e[0].x,y:i.y-e[0].y}),r.type=0<(a=a<180?a:a-360)?2:3,r;if(null!=r.end)return r.start=f.point,r.isintersect=!0,r.outer="start",a=this.Gi({x:o-e[0].x,y:h-e[0].y},{x:t.x-e[0].x,y:t.y-e[0].y}),r.type=0<(a=a<180?a:a-360)?2:3,r;s.push(f)}}var l,c=this.vi(t,i,e[0],e[n-1]);if(c.isintersect){if(null!=r.start)return r.end=c.point,r.isintersect=!0,r.outer="end",l=this.Gi({x:o-e[0].x,y:h-e[0].y},{x:i.x-e[0].x,y:i.y-e[0].y}),r.type=0<(l=l<180?l:l-360)?2:3,r;if(null!=r.end)return r.start=c.point,r.isintersect=!0,r.outer="start",l=this.Gi({x:o-e[0].x,y:h-e[0].y},{x:t.x-e[0].x,y:t.y-e[0].y}),r.type=0<(l=l<180?l:l-360)?2:3,r;s.push(c)}2!=s.length||this.distanceOfTwoPoints(s[0].point,s[1].point)<.01||(this.distanceOfTwoPoints(s[0].point,t)<=this.distanceOfTwoPoints(s[0].point,i)?(r.start=s[0].point,r.end=s[1].point):(r.start=s[1].point,r.end=s[0].point),r.isintersect=!0,r.type=4)}return r},Ki:function(t,i,e){var n=e.length,r={isintersect:!1,start:null,end:null},s=[];if(this.Xi(t,e)&&(r.start=t),this.Xi(i,e)&&(r.end=i),null!=r.start&&null!=r.end)r.isintersect=!0;else{for(var o=1;o<n;o++){var h=this.vi(t,i,e[o-1],e[o]);if(h.isintersect){if(null!=r.start)return r.end=h.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;s.push(h)}}var u=this.vi(t,i,e[0],e[n-1]);if(u.isintersect){if(null!=r.start)return r.end=u.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;s.push(u)}2==s.length&&(r.start=(this.distanceOfTwoPoints(s[0].point,t)<=this.distanceOfTwoPoints(s[0].point,i)?s[0]:s[1]).point,r.end=(this.distanceOfTwoPoints(s[0].point,t)>this.distanceOfTwoPoints(s[0].point,i)?s[0]:s[1]).point,r.isintersect=!0)}return r},Wi:function(r,t){if(0==t.length)return[r];for(var i,e,n=this.qi(t),s=[],o=(n.sort(function(t,i){var e=(t.$i.x-r.$i.x)*(t.$i.x-r.$i.x)+(t.$i.y-r.$i.y)*(t.$i.y-r.$i.y),n=(i.$i.x-r.$i.x)*(i.$i.x-r.$i.x)+(i.$i.y-r.$i.y)*(i.$i.y-r.$i.y),t=(t.te.x-r.$i.x)*(t.te.x-r.$i.x)+(t.te.y-r.$i.y)*(t.te.y-r.$i.y),i=(i.te.x-r.$i.x)*(i.te.x-r.$i.x)+(i.te.y-r.$i.y)*(i.te.y-r.$i.y);return(e<t?e:t)<(n<i?n:i)}),0),o=0;o<n.length;o++)this.distanceOfTwoPoints(n[o].$i,n[o].te)<.01||(i=this.distanceOfTwoPoints(n[o].$i,r.$i),e=this.distanceOfTwoPoints(n[o].te,r.$i),i<.01?r.$i=n[o].te:e<.01?r.$i=n[o].$i:i<e?.1<this.distanceOfTwoPoints(r.$i,n[o].$i)&&(s.push({ie:r.ie,$i:r.$i,te:n[o].$i,Ai:r.Ai,ee:r.ee}),r.$i=n[o].te):.1<this.distanceOfTwoPoints(r.$i,n[o].te)&&(s.push({ie:r.ie,$i:r.$i,te:n[o].te,Ai:r.Ai,ee:r.ee}),r.$i=n[o].$i),n.splice(o,1));return.1<this.distanceOfTwoPoints(r.$i,r.te)&&s.push(r),s},qi:function(t){var i=[];if(1==t.length)return t;for(var e=t[0],n=1;0<t.length;){if(t.length<=n){if(i.push(e),t.splice(0,1),t.length<1)break;e=t[0],n=1}if(1===t.length){i.push(e);break}this.yi(e.$i,e.te,t[n].$i)?(this.yi(e.$i,e.te,t[n].te)||(e.te=t[n].te),t.splice(n,1)):this.yi(e.$i,e.te,t[n].te)?(e.$i=t[n].$i,t.splice(n,1)):this.yi(t[n].$i,t[n].te,e.$i)?(e=(this.yi(t[n].$i,t[n].te,e.te)||(t[n].te=e.te),t[n]),t.splice(n,1)):this.yi(t[n].$i,t[n].te,e.te)?(t[n].$i=e.$i,e=t[n],t.splice(n,1)):n++}return i},yi:function(t,i,e){var n=t.x-e.x,r=t.y-e.y,s=i.x-e.x,o=i.y-e.y,h=this.distanceOfTwoPoints(t,e),e=this.distanceOfTwoPoints(i,e),t=this.distanceOfTwoPoints(t,i);return n*o-r*s<1e-5&&h+e-t<.001},ne:function(t,i,e){var n=i.x-t.x,t=i.y-t.y,r=Math.sqrt(n*n+t*t);return{x:i.x+n/r*e,y:i.y+t/r*e}},re:function(t){for(var i=null,e=0,n=0,r=0,s=0;s<t.length;s++)(null===i||t[s].x>i)&&(i=t[s].x,e=s);var o=new U(t[e].x,t[e].y,0),n=0===e?t.length-1:e-1,r=e===t.length-1?0:e+1,n=new U(t[n].x,t[n].y,0),r=new U(t[r].x,t[r].y,0),n=(new U).copy(o).sub(n),r=(new U).copy(r).sub(o);return 0<n.cross(r).z}});var sr=new rr;function or(t){return(or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function hr(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=or(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=or(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==or(t)?t:t+""))(n.key),n)}}rr=(()=>{function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.F=t,this.et=this.F.getContainer(),this.se={border:"border:2px solid #0000FF",backgroundColor:null,opacity:null},this.lt={},this.oe=[T.MODEL,T.FACILITY,T.LABEL,T.EXTERNAL_MODEL],this.he=0,this.ue=!1,this.nt=this.nt.bind(this),this.rt=this.rt.bind(this),this.st=this.st.bind(this),this.ae=null,this.fe=null,this.ht=new nn,this.le=new fengmap.FMSearchAnalyser({map:this.F}),this.ct()}return t=i,(e=[{key:"dispose",value:function(){this.et.removeEventListener("mousedown",this.nt,!1),document.removeEventListener("mousemove",this.rt,!1),document.removeEventListener("mouseup",this.st,!1),this.le.dispose()}},{key:"boxStyle",get:function(){return this.se},set:function(t){this.se=t}},{key:"enable",get:function(){return this.ue},set:function(t){this.ue=t}},{key:"mouseKey",get:function(){return 0===this.he?"left":"right"},set:function(t){this.he="left"===t?0:2}},{key:"types",get:function(){return this.oe},set:function(t){this.oe=t}},{key:"on",value:function(t,i){this.ht.B(t,i)}}])&&hr(t.prototype,e),n&&hr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n})(),Object.assign(rr.prototype,{ct:function(){this.F.getRenderManager().renderer.domElement.style.left="0px",this.et.addEventListener("mousedown",this.nt,!1),document.addEventListener("mousemove",this.rt,!1),document.addEventListener("mouseup",this.st,!1)},ce:function(t){return{x:t.getBoundingClientRect().left,y:t.getBoundingClientRect().top}},nt:function(t){var i,e;this.ue&&t.button===this.he&&(this.ae&&this.ae.parentNode&&(this.ae.parentNode.removeChild(this.ae),this.ae=null),i=this.ce(this.F.getRenderManager().renderer.domElement),e=t.clientX-i.x,this.fe={x:e,y:t=t.clientY-i.y},this.St(!1),this.ae=document.createElement("div"),this.ae.style.cssText="position:absolute;top:"+t+"px;left:"+e+"px;width:0px;height:0px;"+this.se.border+";",this.et.appendChild(this.ae),this.se.backgroundColor&&(this.ae.style.backgroundColor=this.se.backgroundColor),null!=this.se.opacity)&&(this.ae.style.opacity=this.se.opacity)},rt:function(t){var i,e;this.ue&&null!==this.fe&&(i=this.ce(this.F.getRenderManager().renderer.domElement),e=t.clientX-i.x,t=t.clientY-i.y,e<this.fe.x&&(this.ae.style.left=e+"px"),t<this.fe.y&&(this.ae.style.top=t+"px"),this.ae.style.width=Math.abs(e-this.fe.x)+"px",this.ae.style.height=Math.abs(t-this.fe.y)+"px")},st:function(t){var m=this;if(this.ue&&null!==this.ae&&t.button===this.he){this.St(!0);var w=this.ve(),n=[],i=this.F.getMapOptions(),e=[],r=[];if(i.buildings&&0<i.buildings.length)for(var s=0;s<i.buildings.length;s++)(t=>{for(var i=(t=m.F.getBuilding(t).bound).min,t=t.max,e=[{x:i.x,y:i.y},{x:i.x,y:t.y},{x:t.x,y:t.y},{x:t.x,y:i.y}],n=0;n<e.length;n++)if(sr.ki(e[n],w,w.length))return 1;for(var r=0;r<w.length;r++)if(sr.ki(w[r],e,e.length))return 1;for(var s=0;s<w.length-1;s++){for(var o=w[s],h=w[s+1],u=0;u<e.length-1;u++){var a=e[u],f=e[u+1];if(sr.bi(o,h,a,f))return 1}var l=e[e.length-1],c=e[0];if(sr.bi(o,h,c,l))return 1}for(var v=w[0],y=w[w.length-1],d=0;d<e.length-1;d++){var b=e[d],p=e[d+1];if(sr.bi(v,y,b,p))return 1}return t=e[e.length-1],i=e[0],!!sr.bi(v,y,i,t)})(i.buildings[s].bid)&&(e.push(i.buildings[s].mid),r.push(i.buildings[s].bid));for(var o=[],h=0;h<this.oe.length;h++){for(var u=new fengmap.FMSearchRequest,a=(u.levels=[this.F.getBuilding(i.buildingID).level],u.type=this.oe[h],u.addCondition({polygon:w}),[]),f=0;f<r.length;f++)a.push({buildingID:r[f],levels:[this.F.getBuilding(r[f]).level]});0<a.length&&(u.buildings=a),o.push(u)}this.fe=null,this.ae.parentNode&&this.ae.parentNode.removeChild(this.ae),this.ae=null;var l,c=0;l=null,function i(){var e;c<o.length?(e=o[c],m.le.query(e,function(t){n.push({type:e.type,children:t}),c++,l=setTimeout(i(),1)})):(null!==l&&clearTimeout(l),m.ht.L({type:"boxselected",targets:n,coords:w}))}()}},St:function(t){var i=this.F.getInteracations();t?(i.enableDrag=this.lt.enableDrag,i.enableRotate=this.lt.enableRotate,i.enableTilt=this.lt.enableTilt,i.enableZoom=this.lt.enableZoom):(this.lt.enableDrag=i.enableDrag,this.lt.enableRotate=i.enableRotate,this.lt.enableTilt=i.enableTilt,this.lt.enableZoom=i.enableZoom,i.enableDrag=t,i.enableRotate=t,i.enableTilt=t,i.enableZoom=t)},ve:function(){for(var t=[],i=this.ae.getBoundingClientRect(),e=this.ce(this.F.getRenderManager().renderer.domElement),n=e.x,e=e.y,r=(t.push({x:i.left-n,y:i.top-e}),t.push({x:i.right-n,y:i.top-e}),t.push({x:i.right-n,y:i.bottom-e}),t.push({x:i.left-n,y:i.bottom-e}),[]),s=0;s<t.length;s++){var o=fengmap.FMUtil.coordsScreenToMap(this.F,t[s]);r.push(o)}return r}});function ur(t){return(ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function ar(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=ur(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=ur(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==ur(t)?t:t+""))(n.key),n)}}function fr(t,i,e){i=vr(i);var n=t,i=lr()?Reflect.construct(i,e||[],vr(t).constructor):i.apply(t,e);if(!i||"object"!=ur(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=n))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function lr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(lr=function(){return!!t})()}function cr(){return(cr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,e){var n=((t,i)=>{for(;!{}.hasOwnProperty.call(t,i)&&null!==(t=vr(t)););return t})(t,i);if(n)return(n=Object.getOwnPropertyDescriptor(n,i)).get?n.get.call(arguments.length<3?t:e):n.value}).apply(null,arguments)}function vr(t){return(vr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function yr(t,i){return(yr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}var dr=(t=>{function s(t){var i;if(this instanceof s)return(i=fr(this,s,[t])).info2=t,i.shapetype2="polygon",i.id=""+yn.generateUUID(),t.shapetype&&(i.shapetype2=t.shapetype),i.mapEdit=null,i;throw new TypeError("Cannot call a class as a function")}var i,e=s;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");return e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&yr(e,t),e=s,(t=[{key:"info",get:function(){return this.info2.id=this.id,this.info2.shapetype=this.shapetype2,this.info2.level=this.level,this.info2.buildingID=this.parent.parent.parent.buildingID,this.info2}},{key:"shapetype",get:function(){return this.shapetype2}},{key:"deleteMarker",value:function(){var t,i,e,n,r;t=s,i="remove",e=this,r=cr(vr(1&(n=3)?t.prototype:t),i,e),(2&n&&"function"==typeof r?function(t){return r.apply(e,t)}:r)([]),null!==this.mapEdit&&this.mapEdit.Ft(this.id)}}])&&ar(e.prototype,t),i&&ar(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e})(fengmap.FMPolygonMarker);function br(t){return(br="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function pr(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=br(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=br(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==br(t)?t:t+""))(n.key),n)}}function mr(t,i,e){i=gr(i);var n=t,i=wr()?Reflect.construct(i,e||[],gr(t).constructor):i.apply(t,e);if(!i||"object"!=br(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=n))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function wr(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(wr=function(){return!!t})()}function kr(){return(kr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,e){var n=((t,i)=>{for(;!{}.hasOwnProperty.call(t,i)&&null!==(t=gr(t)););return t})(t,i);if(n)return(n=Object.getOwnPropertyDescriptor(n,i)).get?n.get.call(arguments.length<3?t:e):n.value}).apply(null,arguments)}function gr(t){return(gr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ar(t,i){return(Ar=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}var Mr=(()=>{function s(t){var i;if(this instanceof s)return(i=mr(this,s,[t])).shapetype2="line",i.info2=t,i.id=""+yn.generateUUID(),i.mapEdit=null,i;throw new TypeError("Cannot call a class as a function")}var t,i=s,e=fengmap.FMLineMarker;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");return i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&Ar(i,e),i=s,(e=[{key:"info",get:function(){return this.info2.id=this.id,this.info2.points=this.points,this.info2.shapetype=this.shapetype,this.info2.level=this.segments[0].level,this.info2.buildingID=this.segments[0].buildingID,this.info2}},{key:"points",get:function(){return 0===this.segments.length?[]:this.segments[0].points}},{key:"shapetype",get:function(){return this.shapetype2}},{key:"deleteMarker",value:function(){var t,i,e,n,r;t=s,i="remove",e=this,r=kr(gr(1&(n=3)?t.prototype:t),i,e),(2&n&&"function"==typeof r?function(t){return r.apply(e,t)}:r)([]),null!==this.mapEdit&&this.mapEdit.Ft(this.id)}}])&&pr(i.prototype,e),t&&pr(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i})();function Sr(t){return(Sr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function jr(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=Sr(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Sr(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Sr(t)?t:t+""))(n.key),n)}}var Er=(()=>{function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.F=t.map,this.et=this.F.getContainer(),this.ye=t.highlightColor,void 0===this.ye&&(this.ye="#FF0000"),this.de=t.radius,void 0===this.de&&(this.de=1),this.rt=this.rt.bind(this),this.ot=new Bt,this.ot.params.Line.threshold=this.de,this.ht=new nn,this.be=[],this.pe={},this.ct()}return t=i,(e=[{key:"removeTargets",value:function(){for(var t=0;t<this.be.length;t++)this.be[t].parent.remove(this.be[t]);this.pe={},this.be.length=0}},{key:"addTargets",value:function(t){this.removeTargets();for(var i=0;i<t.length;i++)if(t[i].type===T.LINE_MARKER){for(var e=t[i].segments[0].points,n=[],r=0;r<e.length;r++)n.push(new U(e[r].x-this.F.x,e[r].z,-e[r].y+this.F.y));var s=new Le({visible:!1}),o=(new ke).setFromPoints(n),o=new We(o,s);o.myobject=t[i],o.mapNode=t[i],t[i].parent.scene.add(o),this.be.push(o)}else if(t[i].type===T.POLYGON_MARKER&&t[i].getRenderNode()){this.pe[""+t[i].id]={borderColor:t[i].borderColor,color:t[i].color};for(var h=t[i].points,u=[],a=0;a<h.length;a++)u.push(new U(h[a].x-this.F.x,t[i].height,-h[a].y+this.F.y));var s=new Le({visible:!1}),o=(new ke).setFromPoints(u),f=new We(o,s);f.myobject=t[i],f.mapNode=t[i],t[i].getRenderNode().parent.add(f),this.be.push(f)}}},{key:"dispose",value:function(){this.removeTargets(),this.be.length=0,this.et.removeEventListener("mousemove",this.rt,!1)}},{key:"radius",get:function(){return this.de},set:function(t){this.de=t,this.ot.params.Line.threshold=this.de}},{key:"on",value:function(t,i){this.ht.B(t,i)}}])&&jr(t.prototype,e),n&&jr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n})();Object.assign(Er.prototype,{ct:function(){this.et.addEventListener("mousemove",this.rt,!1)},rt:function(t){if(0!==this.be.length){for(var e=this,i=new G,n=this.et.getBoundingClientRect(),i=(i.x=(t.clientX-n.left)/n.width*2-1,i.y=-(t.clientY-n.top)/n.height*2+1,this.ot.setFromCamera(i,this.F.camera),t.clientX-n.left),t=t.clientY-n.top,n=fengmap.FMUtil.coordsScreenToMap(this.F,{x:i,y:t}),r=this.ot.intersectObjects((()=>{for(var t=[],i=0;i<e.be.length;i++)e.be[i].mapNode&&e.be[i].mapNode.level&&e.be[i].mapNode.level===e.F.getLevel()&&t.push(e.be[i]);return t})(this.be),!0),s=[],o=[],h=0;h<r.length;h++)((t,i)=>{for(var e=!0,n=0;n<t.length;n++)if(t[n].uuid===i.uuid){e=!1;break}return e})(s,r[h].object)&&(s.push(r[h].object),o.push(r[h].point));var u=[],a=[];if(0<s.length){for(var f=0;f<s.length;f++){u.push(s[f].myobject);var l=o[f];a.push({x:l.x+this.F.x,y:this.F.y-l.z})}for(var c=n,v=u,y=a,d=0;d<v.length-1;d++)for(var b=0;b<v.length-1-d;b++){var p=Math.sqrt((v[b].x-c.x)*(v[b].x-c.x)+(v[b].y-c.y)*(v[b].y-c.y));Math.sqrt((v[b+1].x-c.x)*(v[b+1].x-c.x)+(v[b+1].y-c.y)*(v[b+1].y-c.y))<p&&(p=v[b],v[b]=v[b+1],v[b+1]=p,p=y[b],y[b]=y[b+1],y[b+1]=p)}}0===u.length&&(a=u=null);for(var m=0;m<this.be.length;m++){var w=this.pe[""+this.be[m].myobject.id];w&&(this.be[m].myobject.color=w.color,this.be[m].myobject.borderColor=w.borderColor)}null!==u&&u[0].type===T.POLYGON_MARKER&&(u[0].color=this.ye,u[0].borderColor=this.ye),this.ht.L({type:"snap",coords:n,targets:u,targetsCoords:a,level:this.F.getLevel()})}}});function Or(t){return(Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function xr(t,i){return(t=>{if(Array.isArray(t))return t})(t)||((t,i)=>{var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var n,r,s,o,h=[],u=!0,a=!1;try{if(s=(e=e.call(t)).next,0===i){if(Object(e)!==e)return;u=!1}else for(;!(u=(n=s.call(e)).done)&&(h.push(n.value),h.length!==i);u=!0);}catch(t){a=!0,r=t}finally{try{if(!u&&null!=e.return&&(o=e.return(),Object(o)!==o))return}finally{if(a)throw r}}return h}})(t,i)||Tr(t,i)||(()=>{throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function Rr(t,i){var e,n,r,s,o="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(o)return r=!(n=!0),{s:function(){o=o.call(t)},n:function(){var t=o.next();return n=t.done,t},e:function(t){r=!0,e=t},f:function(){try{n||null==o.return||o.return()}finally{if(r)throw e}}};if(Array.isArray(t)||(o=Tr(t))||i&&t&&"number"==typeof t.length)return o&&(t=o),s=0,{s:i=function(){},n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:i};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function Tr(t,i){var e;if(t)return"string"==typeof t?Ir(t,i):"Map"===(e="Object"===(e={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Ir(t,i):void 0}function Ir(t,i){(null==i||i>t.length)&&(i=t.length);for(var e=0,n=Array(i);e<i;e++)n[e]=t[e];return n}function Cr(t,i){for(var e=0;e<i.length;e++){var n=i[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=Or(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0===e)return("string"===i?String:Number)(t);if("object"!=Or(e=e.call(t,i||"default")))return e;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==Or(t)?t:t+""))(n.key),n)}}var Br=(()=>{function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.F=t.map,this.me=t.defaultStyle,this.we=t.isdirect,this.ke=new Map,this.ge=new Map,this.Ae=new Map,this.Me=this.Me.bind(this),this.F.on("beforeRender",this.Me)}return t=i,(e=[{key:"add",value:function(t){var i=this;if(void 0===t.buildingID&&(t.buildingID=this.F.getMapOptions().mapID),void 0===t.type&&(t.type=1),void 0===t.levels){t.levels=[];for(var e=this.F.getBuilding(t.buildingID).getFloorInfos(),n=0;n<e.length;n++)t.levels.push(e[n].level)}for(var r=t.result,s=t.levels,o=t.roadRanks,h=0;h<s.length;h++)for(var u=0;u<o.length;u++)for(var a=((t,i,e)=>{for(var n=[],r=0;r<t.length;r++)if(""+t[r].level==""+i)for(var s=t[r].roadVector,o=0;o<s.length;o++)""+s[o].roadRank==""+e&&n.push(s[o]);return n})(r,s[h],o[u]),f=(p=b=d=y=v=c=l=f=void 0,t.type),l=s[h],c=t.height,v=o[u],y=a,d=t.zoomRange,b=i.Se(v),p=0;p<y.length;p++)y[p].buildingID||(y[p].buildingID=i.F.getMapOptions().mapID),""+f=="1"?(i.je(b,l,c,v,y[p].startPoint,y[p].startId,d,y[p].buildingID),i.je(b,l,c,v,y[p].endPoint,y[p].endId,d,y[p].buildingID),i.Ee(b,l,c,v,y[p].startPoint,y[p].endPoint,d,y[p].buildingID,y[p].roadEntry)):""+f=="2"?i.Ee(b,l,c,v,y[p].startPoint,y[p].endPoint,d,y[p].buildingID,y[p].roadEntry):""+f=="3"&&(i.je(b,l,c,v,y[p].startPoint,y[p].startId,d,y[p].buildingID),i.je(b,l,c,v,y[p].endPoint,y[p].endId,d,y[p].buildingID))}},{key:"getNaviLineByRanks",value:function(t){return this.Oe(t,this.ge)}},{key:"getNaviNodeByRanks",value:function(t){return this.Oe(t,this.ke)}},{key:"remove",value:function(s){for(var o=this,t=(void 0===s.buildingID&&(s.buildingID=this.F.getMapOptions().mapID),s.type),i=(void 0===t&&(t=1),s.levels),e=s.roadRanks,n=0;n<i.length;n++)for(var r=0;r<e.length;r++)""+t=="1"?(h(i[n],e[r]),u(i[n],e[r])):""+t=="2"?h(i[n],e[r]):""+t=="3"&&u(i[n],e[r]);function h(t,i){for(var e=o.ge.get(s.buildingID+""+t),n=a(e,i);-1!==n;)e[n].object.remove(),e.splice(n,1),n=a(e,i);var r=o.Ae.get(s.buildingID+""+t);if(r)for(n=a(r,i);-1!==n;)r[n].object.remove(),r.splice(n,1),n=a(r,i)}function u(t,i){for(var e=o.ke.get(s.buildingID+""+t),n=a(e,i);-1!==n;)e[n].object.remove(),e.splice(n,1),n=a(e,i)}function a(t,i){for(var e=-1,n=0;n<t.length;n++)if(""+t[n].roadRank==""+i){e=n;break}return e}}},{key:"changeVisible",value:function(t){}},{key:"dispose",value:function(){var t,i=Rr(this.ke);try{for(i.s();!(t=i.n()).done;){for(var e=xr(t.value,2),n=(e[0],e[1]),r=0;r<n.length;r++)n[r].object.remove();n.length=0}}catch(t){i.e(t)}finally{i.f()}var s,o=Rr(this.ge);try{for(o.s();!(s=o.n()).done;){for(var h=xr(s.value,2),u=(h[0],h[1]),a=0;a<u.length;a++)u[a].object.remove();u.length=0}}catch(t){o.e(t)}finally{o.f()}var f,l=Rr(this.Ae);try{for(l.s();!(f=l.n()).done;){for(var c=xr(f.value,2),v=(c[0],c[1]),y=0;y<v.length;y++)v[y].object.remove();v.length=0}}catch(t){l.e(t)}finally{l.f()}this.Ae.clear(),this.ge.clear(),this.ke.clear(),this.F.on("beforeRender",this.Me)}}])&&Cr(t.prototype,e),n&&Cr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n})(),Nr=(Object.assign(Br.prototype,{Se:function(t){for(var i=null,e=0;e<this.me.length;e++)if(""+this.me[e].roadRank==""+t){i=this.me[e];break}return i},Ee:function(n,r,s,o,t,i,e,h,u){var a=this,f=new fengmap.FMSegment,f=(f.points=[{x:t.x,y:t.y,z:s},{x:i.x,y:i.y,z:s}],f.level=r,f.buildingID=h,new fengmap.FMLineMarker({segments:[f],width:n.lineWidth,color:n.lineColor,type:fengmap.FMLineType.FULL})),l=(f.addTo(this.F),this.ge.get(h+""+r));function c(t,i){var e=new fengmap.FMSegment,i=(e.points=[{x:t.p1.x,y:t.p1.y,z:s},{x:i.x,y:i.y,z:s},{x:t.p2.x,y:t.p2.y,z:s}],e.level=r,e.buildingID=h,new fengmap.FMLineMarker({segments:[e],width:n.lineWidth,color:n.lineColor,type:fengmap.FMLineType.FULL,smooth:!1})),t=(i.addTo(a.F),a.Ae.get(h+""+r));t?t.push({roadRank:o,object:i}):a.Ae.set(h+""+r,[{roadRank:o,object:i}])}function v(t,i){var e=(t.x+i.x)/2,t=(t.y+i.y)/2,n=Math.PI/4;return{p1:{x:(e-i.x)*Math.cos(n)-(t-i.y)*Math.sin(n)+i.x,y:(t-i.y)*Math.cos(n)+(e-i.x)*Math.sin(n)+i.y},p2:{x:(e-i.x)*Math.cos(2*Math.PI-n)-(t-i.y)*Math.sin(2*Math.PI-n)+i.x,y:(t-i.y)*Math.cos(2*Math.PI-n)+(e-i.x)*Math.sin(2*Math.PI-n)+i.y}}}l?l.push({roadRank:o,object:f,zoomRange:e}):this.ge.set(h+""+r,[{roadRank:o,object:f,zoomRange:e}]),this.we&&(l={x:(t.x+i.x)/2,y:(t.y+i.y)/2},f={x:(t.x+l.x)/2,y:(t.y+l.y)/2},e={x:(i.x+l.x)/2,y:(i.y+l.y)/2},""+u=="1"?c(v(f,l),l):""+u=="2"?c(v(e,l),l):""+u=="3"&&(c(v(f,l),l),c(v(e,l),l)))},je:function(t,i,e,n,r,s,o,h){var u;this.xe(h+""+i,s)&&(u={x:r.x,y:r.y},u={points:fengmap.FMCalculator.rectangleBuilder(t.pointSize,t.pointSize,u),x:r.x,y:r.y,height:e,color:t.pointColor,borderWidth:0,opacity:1},r=this.F.getBuilding(h).getFloor(i),(e=new fengmap.FMPolygonMarker(u)).addTo(r),e.id=s,(t=this.ke.get(h+""+i))?t.push({roadRank:n,object:e,zoomRange:o}):this.ke.set(h+""+i,[{roadRank:n,object:e,zoomRange:o}]))},xe:function(t,i){var e,n=!0,r=Rr(this.ke);try{for(r.s();!(e=r.n()).done;){var s=xr(e.value,2),o=s[0],h=s[1];if(""+o==""+t)for(var u=0;u<h.length;u++)if(""+h[u].object.id==""+i){n=!1;break}if(!n)break}}catch(t){r.e(t)}finally{r.f()}return n},Re:function(t,i){for(var e=!1,n=0;n<i.length;n++)if(""+i[n]==""+t){e=!0;break}return e},Me:function(){for(var t=this.F.camera,i=this.F.getVisibleLevels(),e=this.F.getZoom(),n=0;n<i.length;n++){var r=this.F.getFloor(i[n]),s=this.ge.get(""+i[n]);if(s)for(var o,h,u=0;u<s.length;u++)e<s[u].zoomRange[0]||e>s[u].zoomRange[1]?s[u].object.parent&&s[u].object.remove():(h=s[u].object.segments[0].points,o=new U(h[0].x-this.F.x,h[0].z+r.height,-h[0].y+this.F.y),h=new U(h[1].x-this.F.x,h[1].z+r.height,-h[1].y+this.F.y),o=o.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix),h=h.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix),!(1<Math.abs(o.x)||1<Math.abs(o.y)||1<Math.abs(o.z))||!(1<Math.abs(h.x)||1<Math.abs(h.y)||1<Math.abs(h.z))?s[u].object.parent||s[u].object.addTo(this.F):s[u].object.parent&&s[u].object.remove());var a=this.ke.get(""+i[n]);if(a)for(var f=0;f<a.length;f++){var l,c=a[f].object;e<a[f].zoomRange[0]||e>a[f].zoomRange[1]?c.parent&&c.remove():(l=new U(c.x-this.F.x,c.height+r.height,-c.y+this.F.y).applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix),1<Math.abs(l.x)||1<Math.abs(l.y)||1<Math.abs(l.z)?c.parent&&c.remove():c.parent||c.addTo(r))}}this.F.enableUpdateRender()},Oe:function(t,i){var e=t.roadRanks,n=t.levels;if(void 0===t.buildingID&&(t.buildingID=this.F.getMapOptions().mapID),void 0===n)for(var n=[],r=this.F.getBuilding(t.buildingID).getFloorInfos(),s=0;s<r.length;s++)n.push(r[s].level);for(var o=[],h=0;h<n.length;h++){var u=i.get(t.buildingID+""+n[h]);if(u)for(var a=0;a<u.length;a++)this.Re(u[a].roadRank,e)&&o.push(u[a].object)}return o}}),"v3.1.10"),Pr=237,e=window.fengmap||{};e.VERSION=Nr,e.BUILD=Pr,e.FMMapEditor=i,e.FMMarkerEditor=t,e.FMBoxSelectTool=rr,e.FMImageMarkerEdit=An,e.FMPolygonMarkerEdit=dr,e.FMLineMarkerEdit=Mr,e.FMSnapCtrl=Er,e.FMNaviPathLineTool=Br,P.default=e}],n={},r.m=e,r.c=n,r.d=function(t,i,e){r.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"Te",{value:!0})},r.t=function(i,t){if(1&t&&(i=r(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.Te)return i;var e=Object.create(null);if(r.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var n in i)r.d(e,n,function(t){return i[t]}.bind(null,n));return e},r.n=function(t){var i=t&&t.Te?function(){return t.default}:function(){return t};return r.d(i,"a",i),i},r.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},r.p="",r(r.s=0).default;function r(t){var i;return(n[t]||(i=n[t]={i:t,l:!1,exports:{}},e[t].call(i.exports,i,i.exports,r),i.l=!0,i)).exports}var e,n});