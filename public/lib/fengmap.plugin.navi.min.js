/**Released Version v3.1.10,BUILD 237,Time 1749031855592. Fengmap Javascript SDK , see: https://www.fengmap.com for details**/
((t,i)=>{"object"==typeof exports&&"object"==typeof module?module.exports=i():"function"==typeof define&&define.amd?define([],i):"object"==typeof exports?exports.fengmap=i():t.fengmap=i()})(this,function(){return n=[function(n,F,t){t.r(F);var D={MODULE_SHORTEST:1,MODULE_BEST:2},Y={PRIORITY_DEFAULT:1,PRIORITY_LIFTFIRST:2,PRIORITY_ESCALATORFIRST:3,PRIORITY_STAIRFIRST:4,PRIORITY_LIFTONLY:5,PRIORITY_ESCALATORONLY:6,PRIORITY_STAIRONLY:7,PRIORITY_ACCESSIBLEONLY:8,PRIORITY_LIFTFIRST1:9,PRIORITY_ESCALATORFIRST1:10,PRIORITY_STAIRFIRST1:11},V={ZH:"zh",EN:"en"},h={Auto:1,SpecifiedDistance:2};function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Z(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=r(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==r(t)?t:t+""))(e.key),e)}}function X(t,i,n){return i&&Z(t.prototype,i),n&&Z(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var t=X(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")}),B=(Object.assign(t.prototype,{h:function(t,i){void 0===this.u&&(this.u={});var n=this.u;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(i)&&n[t].push(i)},v:function(t,i){var n;return void 0!==this.u&&void 0!==(n=this.u)[t]&&-1!==n[t].indexOf(i)},M:function(t,i){var n;void 0!==this.u&&void 0!==(t=this.u[t])&&-1!==(n=t.indexOf(i))&&t.splice(n,1)},k:function(t){if(void 0!==this.u){var i=this.u[t.type];if(void 0!==i)for(var n=i.slice(0),e=0,r=n.length;e<r;e++)n[e].call(this,t)}}}),t);function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function z(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=s(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=s(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==s(t)?t:t+""))(e.key),e)}}var G=(()=>{function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return t=i,(n=[{key:"start",value:function(){this.startTime=H(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var t,i=0;return this.autoStart&&!this.running?(this.start(),0):(this.running&&(i=((t=H())-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=i),i)}}])&&z(t.prototype,n),e&&z(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e})();function H(){return("undefined"==typeof performance?Date:performance).now()}for(var o=[],i=0;i<256;i++)o[i]=(i<16?"0":"")+i.toString(16);var U=1234567,e={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,e=4294967295*Math.random()|0;return(o[255&t]+o[t>>8&255]+o[t>>16&255]+o[t>>24&255]+"-"+o[255&i]+o[i>>8&255]+"-"+o[i>>16&15|64]+o[i>>24&255]+"-"+o[63&n|128]+o[n>>8&255]+"-"+o[n>>16&255]+o[n>>24&255]+o[255&e]+o[e>>8&255]+o[e>>16&255]+o[e>>24&255]).toUpperCase()},clamp:function(t,i,n){return Math.max(i,Math.min(n,t))},euclideanModulo:function(t,i){return(t%i+i)%i},mapLinear:function(t,i,n,e,r){return e+(t-i)*(r-e)/(n-i)},lerp:function(t,i,n){return(1-n)*t+n*i},smoothstep:function(t,i,n){return t<=i?0:n<=t?1:(t=(t-i)/(n-i))*t*(3-2*t)},smootherstep:function(t,i,n){return t<=i?0:n<=t?1:(t=(t-i)/(n-i))*t*t*(t*(6*t-15)+10)},randInt:function(t,i){return t+Math.floor(Math.random()*(i-t+1))},randFloat:function(t,i){return t+Math.random()*(i-t)},randFloatSpread:function(t){return t*(.5-Math.random())},seededRandom:function(t){return((U=16807*(U=void 0!==t?t%2147483647:U)%2147483647)-1)/2147483646},degToRad:function(t){return t*e.DEG2RAD},radToDeg:function(t){return t*e.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,i,n,e,r){var s=Math.cos,h=Math.sin,o=s(n/2),u=h(n/2),a=s((i+e)/2),f=h((i+e)/2),c=s((i-e)/2),l=h((i-e)/2),v=s((e-i)/2),y=h((e-i)/2);switch(r){case"XYX":t.set(o*f,u*c,u*l,o*a);break;case"YZY":t.set(u*l,o*f,u*c,o*a);break;case"ZXZ":t.set(u*c,u*l,o*f,o*a);break;case"XZX":t.set(o*f,u*y,u*v,o*a);break;case"YXY":t.set(u*v,o*f,u*y,o*a);break;case"ZYZ":t.set(u*y,u*v,o*f,o*a);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+r)}}};function u(t){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function q(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=u(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=u(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==u(t)?t:t+""))(e.key),e)}}t=(()=>{return t=function t(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=this,h=t;if(!(s instanceof h))throw new TypeError("Cannot call a class as a function");Object.defineProperty(this,"isQuaternion",{value:!0}),this.g=i,this._=n,this.S=e,this.O=r},n=[{key:"slerp",value:function(t,i,n,e){return n.copy(t).slerp(i,e)}},{key:"slerpFlat",value:function(t,i,n,e,r,s,h){var o,u,a,f=n[e+0],c=n[e+1],l=n[e+2],n=n[e+3],e=r[s+0],v=r[s+1],y=r[s+2],r=r[s+3];n===r&&f===e&&c===v&&l===y||(s=1-h,o=0<=(u=f*e+c*v+l*y+n*r)?1:-1,(a=1-u*u)>Number.EPSILON&&(a=Math.sqrt(a),u=Math.atan2(a,u*o),s=Math.sin(s*u)/a,h=Math.sin(h*u)/a),f=f*s+e*(u=h*o),c=c*s+v*u,l=l*s+y*u,n=n*s+r*u,s===1-h&&(f*=a=1/Math.sqrt(f*f+c*c+l*l+n*n),c*=a,l*=a,n*=a)),t[i]=f,t[i+1]=c,t[i+2]=l,t[i+3]=n}},{key:"multiplyQuaternionsFlat",value:function(t,i,n,e,r,s){var h=n[e],o=n[e+1],u=n[e+2],n=n[e+3],e=r[s],a=r[s+1],f=r[s+2],r=r[s+3];return t[i]=h*r+n*e+o*f-u*a,t[i+1]=o*r+n*a+u*e-h*f,t[i+2]=u*r+n*f+h*a-o*e,t[i+3]=n*r-h*e-o*a-u*f,t}}],(i=[{key:"x",get:function(){return this.g},set:function(t){this.g=t,this.j()}},{key:"y",get:function(){return this._},set:function(t){this._=t,this.j()}},{key:"z",get:function(){return this.S},set:function(t){this.S=t,this.j()}},{key:"w",get:function(){return this.O},set:function(t){this.O=t,this.j()}},{key:"set",value:function(t,i,n,e){return this.g=t,this._=i,this.S=n,this.O=e,this.j(),this}},{key:"clone",value:function(){return new this.constructor(this.g,this._,this.S,this.O)}},{key:"copy",value:function(t){return this.g=t.x,this._=t.y,this.S=t.z,this.O=t.w,this.j(),this}},{key:"setFromEuler",value:function(t,i){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t.g,e=t._,r=t.S,s=t._order,t=Math.cos,h=Math.sin,o=t(n/2),u=t(e/2),a=t(r/2),f=h(n/2),c=h(e/2),l=h(r/2);switch(s){case"XYZ":this.g=f*u*a+o*c*l,this._=o*c*a-f*u*l,this.S=o*u*l+f*c*a,this.O=o*u*a-f*c*l;break;case"YXZ":this.g=f*u*a+o*c*l,this._=o*c*a-f*u*l,this.S=o*u*l-f*c*a,this.O=o*u*a+f*c*l;break;case"ZXY":this.g=f*u*a-o*c*l,this._=o*c*a+f*u*l,this.S=o*u*l+f*c*a,this.O=o*u*a-f*c*l;break;case"ZYX":this.g=f*u*a-o*c*l,this._=o*c*a+f*u*l,this.S=o*u*l-f*c*a,this.O=o*u*a+f*c*l;break;case"YZX":this.g=f*u*a+o*c*l,this._=o*c*a+f*u*l,this.S=o*u*l-f*c*a,this.O=o*u*a-f*c*l;break;case"XZY":this.g=f*u*a-o*c*l,this._=o*c*a-f*u*l,this.S=o*u*l+f*c*a,this.O=o*u*a+f*c*l;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!1!==i&&this.j(),this}},{key:"setFromAxisAngle",value:function(t,i){var i=i/2,n=Math.sin(i);return this.g=t.x*n,this._=t.y*n,this.S=t.z*n,this.O=Math.cos(i),this.j(),this}},{key:"setFromRotationMatrix",value:function(t){var t=t.elements,i=t[0],n=t[4],e=t[8],r=t[1],s=t[5],h=t[9],o=t[2],u=t[6],t=t[10],a=i+s+t;return 0<a?(a=.5/Math.sqrt(a+1),this.O=.25/a,this.g=(u-h)*a,this._=(e-o)*a,this.S=(r-n)*a):s<i&&t<i?(a=2*Math.sqrt(1+i-s-t),this.O=(u-h)/a,this.g=.25*a,this._=(n+r)/a,this.S=(e+o)/a):t<s?(a=2*Math.sqrt(1+s-i-t),this.O=(e-o)/a,this.g=(n+r)/a,this._=.25*a,this.S=(h+u)/a):(a=2*Math.sqrt(1+t-i-s),this.O=(r-n)/a,this.g=(e+o)/a,this._=(h+u)/a,this.S=.25*a),this.j(),this}},{key:"setFromUnitVectors",value:function(t,i){var n=t.dot(i)+1;return n<1e-6?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this.g=-t.y,this._=t.x,this.S=0):(this.g=0,this._=-t.z,this.S=t.y)):(this.g=t.y*i.z-t.z*i.y,this._=t.z*i.x-t.x*i.z,this.S=t.x*i.y-t.y*i.x),this.O=n,this.normalize()}},{key:"angleTo",value:function(t){return 2*Math.acos(Math.abs(e.clamp(this.dot(t),-1,1)))}},{key:"rotateTowards",value:function(t,i){var n=this.angleTo(t);return 0!==n&&(i=Math.min(1,i/n),this.slerp(t,i)),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this.g*=-1,this._*=-1,this.S*=-1,this.j(),this}},{key:"dot",value:function(t){return this.g*t.g+this._*t._+this.S*t.S+this.O*t.O}},{key:"lengthSq",value:function(){return this.g*this.g+this._*this._+this.S*this.S+this.O*this.O}},{key:"length",value:function(){return Math.sqrt(this.g*this.g+this._*this._+this.S*this.S+this.O*this.O)}},{key:"normalize",value:function(){var t=this.length();return 0===t?(this.g=0,this._=0,this.S=0,this.O=1):(this.g=this.g*(t=1/t),this._=this._*t,this.S=this.S*t,this.O=this.O*t),this.j(),this}},{key:"multiply",value:function(t,i){return void 0!==i?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,i)):this.multiplyQuaternions(this,t)}},{key:"premultiply",value:function(t){return this.multiplyQuaternions(t,this)}},{key:"multiplyQuaternions",value:function(t,i){var n=t.g,e=t._,r=t.S,t=t.O,s=i.g,h=i._,o=i.S,i=i.O;return this.g=n*i+t*s+e*o-r*h,this._=e*i+t*h+r*s-n*o,this.S=r*i+t*o+n*h-e*s,this.O=t*i-n*s-e*h-r*o,this.j(),this}},{key:"slerp",value:function(t,i){if(0!==i){if(1===i)return this.copy(t);var n,e=this.g,r=this._,s=this.S,h=this.O,o=h*t.O+e*t.g+r*t._+s*t.S;o<0?(this.O=-t.O,this.g=-t.g,this._=-t._,this.S=-t.S,o=-o):this.copy(t),1<=o?(this.O=h,this.g=e,this._=r,this.S=s):((t=1-o*o)<=Number.EPSILON?(this.O=(n=1-i)*h+i*this.O,this.g=n*e+i*this.g,this._=n*r+i*this._,this.S=n*s+i*this.S,this.normalize()):(n=Math.sqrt(t),t=Math.atan2(n,o),o=Math.sin((1-i)*t)/n,i=Math.sin(i*t)/n,this.O=h*o+this.O*i,this.g=e*o+this.g*i,this._=r*o+this._*i,this.S=s*o+this.S*i),this.j())}return this}},{key:"equals",value:function(t){return t.g===this.g&&t._===this._&&t.S===this.S&&t.O===this.O}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.g=t[i],this._=t[i+1],this.S=t[i+2],this.O=t[i+3],this.j(),this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.g,t[i+1]=this._,t[i+2]=this.S,t[i+3]=this.O,t}},{key:"fromBufferAttribute",value:function(t,i){return this.g=t.getX(i),this._=t.getY(i),this.S=t.getZ(i),this.O=t.getW(i),this}},{key:"onChange",value:function(t){return this.j=t,this}},{key:"_onChangeCallback",value:function(){}}])&&q(t.prototype,i),n&&q(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,n})();function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function K(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=a(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=a(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==a(t)?t:t+""))(e.key),e)}}var c=(()=>{return t=function t(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=this,s=t;if(!(r instanceof s))throw new TypeError("Cannot call a class as a function");Object.defineProperty(this,"isVector3",{value:!0}),this.x=i,this.y=n,this.z=e},(i=[{key:"set",value:function(t,i,n){return void 0===n&&(n=this.z),this.x=t,this.y=i,this.z=n,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this.z=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setZ",value:function(t){return this.z=t,this}},{key:"setComponent",value:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"add",value:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this}},{key:"addVectors",value:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this}},{key:"addScaledVector",value:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this}},{key:"sub",value:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this.z-=t,this}},{key:"subVectors",value:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this}},{key:"multiply",value:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,i)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"multiplyVectors",value:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this}},{key:"applyEuler",value:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(W.setFromEuler(t))}},{key:"applyAxisAngle",value:function(t,i){return this.applyQuaternion(W.setFromAxisAngle(t,i))}},{key:"applyMatrix3",value:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements;return this.x=t[0]*i+t[3]*n+t[6]*e,this.y=t[1]*i+t[4]*n+t[7]*e,this.z=t[2]*i+t[5]*n+t[8]*e,this}},{key:"applyNormalMatrix",value:function(t){return this.applyMatrix3(t).normalize()}},{key:"applyMatrix4",value:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements,r=1/(t[3]*i+t[7]*n+t[11]*e+t[15]);return this.x=(t[0]*i+t[4]*n+t[8]*e+t[12])*r,this.y=(t[1]*i+t[5]*n+t[9]*e+t[13])*r,this.z=(t[2]*i+t[6]*n+t[10]*e+t[14])*r,this}},{key:"applyQuaternion",value:function(t){var i=this.x,n=this.y,e=this.z,r=t.x,s=t.y,h=t.z,t=t.w,o=t*i+s*e-h*n,u=t*n+h*i-r*e,a=t*e+r*n-s*i,i=-r*i-s*n-h*e;return this.x=o*t+i*-r+u*-h-a*-s,this.y=u*t+i*-s+a*-r-o*-h,this.z=a*t+i*-h+o*-s-u*-r,this}},{key:"project",value:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}},{key:"unproject",value:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}},{key:"transformDirection",value:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements;return this.x=t[0]*i+t[4]*n+t[8]*e,this.y=t[1]*i+t[5]*n+t[9]*e,this.z=t[2]*i+t[6]*n+t[10]*e,this.normalize()}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}},{key:"clamp",value:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this}},{key:"clampScalar",value:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this}},{key:"clampLength",value:function(t,i){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this}},{key:"lerpVectors",value:function(t,i,n){return this.x=t.x+(i.x-t.x)*n,this.y=t.y+(i.y-t.y)*n,this.z=t.z+(i.z-t.z)*n,this}},{key:"cross",value:function(t,i){return void 0!==i?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,i)):this.crossVectors(this,t)}},{key:"crossVectors",value:function(t,i){var n=t.x,e=t.y,t=t.z,r=i.x,s=i.y,i=i.z;return this.x=e*i-t*s,this.y=t*r-n*i,this.z=n*s-e*r,this}},{key:"projectOnVector",value:function(t){var i=t.lengthSq();return 0===i?this.set(0,0,0):(i=t.dot(this)/i,this.copy(t).multiplyScalar(i))}},{key:"projectOnPlane",value:function(t){return Q.copy(this).projectOnVector(t),this.sub(Q)}},{key:"reflect",value:function(t){return this.sub(Q.copy(t).multiplyScalar(2*this.dot(t)))}},{key:"angleTo",value:function(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===i?Math.PI/2:(t=this.dot(t)/i,Math.acos(e.clamp(t,-1,1)))}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var i=this.x-t.x,n=this.y-t.y,t=this.z-t.z;return i*i+n*n+t*t}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}},{key:"setFromSpherical",value:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}},{key:"setFromSphericalCoords",value:function(t,i,n){var e=Math.sin(i)*t;return this.x=e*Math.sin(n),this.y=Math.cos(i)*t,this.z=e*Math.cos(n),this}},{key:"setFromCylindrical",value:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}},{key:"setFromCylindricalCoords",value:function(t,i,n){return this.x=t*Math.sin(i),this.y=n,this.z=t*Math.cos(i),this}},{key:"setFromMatrixPosition",value:function(t){t=t.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(t){var i=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),t=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=n,this.z=t,this}},{key:"setFromMatrixColumn",value:function(t,i){return this.fromArray(t.elements,4*i)}},{key:"setFromMatrix3Column",value:function(t,i){return this.fromArray(t.elements,3*i)}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t}},{key:"fromBufferAttribute",value:function(t,i,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}])&&K(t.prototype,i),n&&K(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,n})(),Q=new c,W=new t;function f(t){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function $(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=f(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=f(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==f(t)?t:t+""))(e.key),e)}}var t=(()=>{function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function");this.T={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.R={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}return i=t,(n=[{key:"min",get:function(){return this.T}},{key:"max",get:function(){return this.R}},{key:"center",get:function(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=(this.min.x+this.max.x)/2,t.y=(this.min.y+this.max.y)/2),t}},{key:"size",get:function(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=this.max.x-this.min.x,t.y=this.max.y-this.min.y),t}},{key:"copy",value:function(t){return this.R.x=t.max.x,this.R.y=t.max.y,this.T.x=t.min.x,this.T.y=t.min.y,this}},{key:"clone",value:function(){return(new t).copy(this)}},{key:"reset",value:function(){this.T={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.R={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}},{key:"toObject",value:function(){return{min:this.min,max:this.max,center:this.center,size:this.size}}},{key:"expand",value:function(t){this.L(t)}},{key:"expandByCoords",value:function(t){this.A(t)}},{key:"valid",value:function(){return this.I()}},{key:"isCross",value:function(t){var i=!0;return t.max.x<this.min.x&&(i=!1),t.min.x>this.max.x&&(i=!1),t.max.y<this.min.y&&(i=!1),i=t.min.y>this.max.y?!1:i}}])&&$(i.prototype,n),e&&$(i,e),Object.defineProperty(i,"prototype",{writable:!1}),i;var i,n,e})(),J=(Object.assign(t.prototype,{I:function(){return!(this.min.x>this.max.x||this.min.y>this.max.y)},L:function(t){t&&t.valid()&&(t.min.x<this.min.x&&(this.min.x=t.min.x),t.min.y<this.min.y&&(this.min.y=t.min.y),t.max.x>this.max.x&&(this.max.x=t.max.x),t.max.y>this.max.y)&&(this.max.y=t.max.y)},A:function(t){var i=this;t&&0!=t.length&&t.forEach(function(t){t.x<i.min.x&&(i.min.x=t.x),t.y<i.min.y&&(i.min.y=t.y),t.x>i.max.x&&(i.max.x=t.x),t.y>i.max.y&&(i.max.y=t.y)})}}),t),tt=function(t,i,n){n=n||2;var e,r,s,h,o,u=i&&i.length,a=u?i[0]*n:t.length,f=it(t,0,a,n,!0),c=[];if(f&&f.next!==f.prev){if(u&&(f=((t,i,n,e)=>{var r,s,h,o,u=[];for(r=0,s=i.length;r<s;r++)o=i[r]*e,h=r<s-1?i[r+1]*e:t.length,(o=it(t,o,h,e,!1))===o.next&&(o.steiner=!0),u.push((t=>{for(var i=t,n=t;(i.x<n.x||i.x===n.x&&i.y<n.y)&&(n=i),(i=i.next)!==t;);return n})(o));for(u.sort(nt),r=0;r<u.length;r++){{a=void 0;f=void 0;var a=u[r];var f=n;(f=((t,i)=>{var n,e=i,r=t.x,s=t.y,h=-1/0;do{if(s<=e.y&&s>=e.next.y&&e.next.y!==e.y){var o=e.x+(s-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(o<=r&&h<o){if((h=o)===r){if(s===e.y)return e;if(s===e.next.y)return e.next}n=e.x<e.next.x?e:e.next}}}while((e=e.next)!==i);if(!n)return null;if(r!==h){var u,a=n,f=n.x,c=n.y,l=1/0;for(e=n;r>=e.x&&e.x>=f&&r!==e.x&&E(s<c?r:h,s,f,c,s<c?h:r,s,e.x,e.y)&&(u=Math.abs(s-e.y)/(r-e.x),R(e,t))&&(u<l||u===l&&(e.x>n.x||e.x===n.x&&((t,i)=>T(t.prev,t,i.prev)<0&&T(i.next,t,t.next)<0)(n,e)))&&(n=e,l=u),(e=e.next)!==a;);}return n})(a,f))&&(a=st(f,a),O(f,f.next),O(a,a.next))}n=O(n,n.next)}return n})(t,i,f,n)),t.length>80*n){for(var l=e=t[0],v=r=t[1],y=n;y<a;y+=n)(s=t[y])<l&&(l=s),(h=t[y+1])<v&&(v=h),e<s&&(e=s),r<h&&(r=h);o=0!==(o=Math.max(e-l,r-v))?1/o:0}j(f,c,n,l,v,o)}return c};function it(t,i,n,e,r){var s,h;if(r===0<((t,i,n,e)=>{for(var r=0,s=i,h=n-e;s<n;s+=e)r+=(t[h]-t[s])*(t[s+1]+t[h+1]),h=s;return r})(t,i,n,e))for(s=i;s<n;s+=e)h=ht(s,t[s],t[s+1],h);else for(s=n-e;i<=s;s-=e)h=ht(s,t[s],t[s+1],h);return h&&x(h,h.next)&&(L(h),h=h.next),h}function O(t,i){if(!t)return t;i=i||t;var n,e=t;do{if(n=!1,e.steiner||!x(e,e.next)&&0!==T(e.prev,e,e.next))e=e.next;else{if(L(e),(e=i=e.prev)===e.next)break;n=!0}}while(n||e!==i);return i}function j(t,i,n,e,r,s,h){if(t){if(!h&&s){for(var o=t,u=e,a=r,f=s,c=o;null===c.z&&(c.z=et(c.x,c.y,u,a,f)),c.prevZ=c.prev,c.nextZ=c.next,(c=c.next)!==o;);c.prevZ.nextZ=null,c.prevZ=null;var l,v,y,d,b,m,p,M,k=c,w=1;do{for(v=k,b=k=null,m=0;v;){for(m++,y=v,l=p=0;l<w&&(p++,y=y.nextZ);l++);for(M=w;0<p||0<M&&y;)0!==p&&(0===M||!y||v.z<=y.z)?(v=(d=v).nextZ,p--):(y=(d=y).nextZ,M--),b?b.nextZ=d:k=d,d.prevZ=b,b=d;v=y}}while(b.nextZ=null,w*=2,1<m)}for(var g,_,S=t;t.prev!==t.next;)if(g=t.prev,_=t.next,s?((t,i,n,e)=>{var r=t.prev,s=t,h=t.next;if(!(0<=T(r,s,h))){for(var o=(r.x<s.x?r.x<h.x?r:h:s.x<h.x?s:h).x,u=(r.y<s.y?r.y<h.y?r:h:s.y<h.y?s:h).y,a=(s.x<r.x?r.x>h.x?r:h:s.x>h.x?s:h).x,f=(s.y<r.y?r.y>h.y?r:h:s.y>h.y?s:h).y,c=et(o,u,i,n,e),l=et(a,f,i,n,e),v=t.prevZ,y=t.nextZ;v&&v.z>=c&&y&&y.z<=l;){if(v!==t.prev&&v!==t.next&&E(r.x,r.y,s.x,s.y,h.x,h.y,v.x,v.y)&&0<=T(v.prev,v,v.next))return;if(v=v.prevZ,y!==t.prev&&y!==t.next&&E(r.x,r.y,s.x,s.y,h.x,h.y,y.x,y.y)&&0<=T(y.prev,y,y.next))return;y=y.nextZ}for(;v&&v.z>=c;){if(v!==t.prev&&v!==t.next&&E(r.x,r.y,s.x,s.y,h.x,h.y,v.x,v.y)&&0<=T(v.prev,v,v.next))return;v=v.prevZ}for(;y&&y.z<=l;){if(y!==t.prev&&y!==t.next&&E(r.x,r.y,s.x,s.y,h.x,h.y,y.x,y.y)&&0<=T(y.prev,y,y.next))return;y=y.nextZ}return 1}})(t,e,r,s):(t=>{var i=t.prev,n=t,e=t.next;if(!(0<=T(i,n,e))){for(var r=t.next.next;r!==t.prev;){if(E(i.x,i.y,n.x,n.y,e.x,e.y,r.x,r.y)&&0<=T(r.prev,r,r.next))return;r=r.next}return 1}})(t))i.push(g.i/n),i.push(t.i/n),i.push(_.i/n),L(t),t=_.next,S=_.next;else if((t=_)===S){h?1===h?j(t=((t,i,n)=>{var e=t;do{var r=e.prev,s=e.next.next}while(!x(r,s)&&rt(r,e,e.next,s)&&R(r,s)&&R(s,r)&&(i.push(r.i/n),i.push(e.i/n),i.push(s.i/n),L(e),L(e.next),e=t=s),(e=e.next)!==t);return O(e)})(O(t),i,n),i,n,e,r,s,2):2===h&&((t,i,n,e,r,s)=>{var h=t;do{for(var o,u=h.next.next;u!==h.prev;){if(h.i!==u.i&&((t,i)=>t.next.i!==i.i&&t.prev.i!==i.i&&!((t,i)=>{var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==i.i&&n.next.i!==i.i&&rt(n,n.next,t,i))return 1}while((n=n.next)!==t)})(t,i)&&(R(t,i)&&R(i,t)&&((t,i)=>{for(var n=t,e=!1,r=(t.x+i.x)/2,s=(t.y+i.y)/2;n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(e=!e),(n=n.next)!==t;);return e})(t,i)&&(T(t.prev,t,i.prev)||T(t,i.prev,i))||x(t,i)&&0<T(t.prev,t,t.next)&&0<T(i.prev,i,i.next)))(h,u))return o=st(h,u),h=O(h,h.next),o=O(o,o.next),j(h,i,n,e,r,s),j(o,i,n,e,r,s);u=u.next}}while((h=h.next)!==t)})(t,i,n,e,r,s):j(O(t),i,n,e,r,s,1);break}}}function nt(t,i){return t.x-i.x}function et(t,i,n,e,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-e)*r)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function E(t,i,n,e,r,s,h,o){return 0<=(r-h)*(i-o)-(t-h)*(s-o)&&0<=(t-h)*(e-o)-(n-h)*(i-o)&&0<=(n-h)*(s-o)-(r-h)*(e-o)}function T(t,i,n){return(i.y-t.y)*(n.x-i.x)-(i.x-t.x)*(n.y-i.y)}function x(t,i){return t.x===i.x&&t.y===i.y}function rt(t,i,n,e){var r=v(T(t,i,n)),s=v(T(t,i,e)),h=v(T(n,e,t)),o=v(T(n,e,i));return r!==s&&h!==o||0===r&&l(t,n,i)||0===s&&l(t,e,i)||0===h&&l(n,t,e)||!(0!==o||!l(n,i,e))}function l(t,i,n){return i.x<=Math.max(t.x,n.x)&&i.x>=Math.min(t.x,n.x)&&i.y<=Math.max(t.y,n.y)&&i.y>=Math.min(t.y,n.y)}function v(t){return 0<t?1:t<0?-1:0}function R(t,i){return T(t.prev,t,t.next)<0?0<=T(t,i,t.next)&&0<=T(t,t.prev,i):T(t,i,t.prev)<0||T(t,t.next,i)<0}function st(t,i){var n=new ot(t.i,t.x,t.y),e=new ot(i.i,i.x,i.y),r=t.next,s=i.prev;return(t.next=i).prev=t,(n.next=r).prev=n,e.next=n,(s.next=n.prev=e).prev=s,e}function ht(t,i,n,e){t=new ot(t,i,n);return e?(t.next=e.next,(t.prev=e).next.prev=t,e.next=t):(t.prev=t).next=t,t}function L(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ot(t,i,n){this.i=t,this.x=i,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function ut(t){return(t=>{if(Array.isArray(t))return at(t)})(t)||(t=>{if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)})(t)||((t,i)=>{var n;if(t)return"string"==typeof t?at(t,i):"Map"===(n="Object"===(n={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?at(t,i):void 0})(t)||(()=>{throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function at(t,i){(null==i||i>t.length)&&(i=t.length);for(var n=0,e=Array(i);n<i;n++)e[n]=t[n];return e}var y={area:function(t){for(var i=t.length,n=0,e=i-1,r=0;r<i;e=r++)n+=t[e].x*t[r].y-t[r].x*t[e].y;return.5*n},isClockWise:function(t){return y.area(t)<0},triangulateShape:function(t,i){var n=[],e=[],r=[],s=(ft(t),ct(n,t),t.length);i.forEach(ft);for(var h=0;h<i.length;h++)e.push(s),s+=i[h].length,ct(n,i[h]);for(var o=tt(n,e),u=0;u<o.length;u+=3)r.push(o.slice(u,u+3));return r},triangulate:function(t){(r=[]).push.apply(r,ut(t[0]));for(var i=[],n=1;n<t.length;n++){var e=[];e.push.apply(e,ut(t[n])),i.push(e)}if(!y.isClockWise(r))for(var r=r.reverse(),s=0,h=i.length;s<h;s++){var o=i[s];y.isClockWise(o)&&(i[s]=o.reverse())}return y.triangulateShape(r,i)}};function ft(t){var i,n=t.length;2<n&&(n=t[n-1],i=t[0],n.x===i.x)&&n.y===i.y&&t.pop()}function ct(t,i){for(var n=0;n<i.length;n++)t.push(i[n].x),t.push(i[n].y)}Math.PI;function lt(t,i,n){return Math.max(i,Math.min(n,t))}function A(t){return(A="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vt(){vt=function(){return h};var u,h={},t=Object.prototype,a=t.hasOwnProperty,f=Object.defineProperty||function(t,i,n){t[i]=n.value},i="function"==typeof Symbol?Symbol:{},e=i.iterator||"@@iterator",n=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function s(t,i,n){return Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[i]}try{s({},"")}catch(u){s=function(t,i,n){return t[i]=n}}function o(t,i,n,e){var r,s,h,o,i=i&&i.prototype instanceof m?i:m,i=Object.create(i.prototype),e=new j(e||[]);return f(i,"_invoke",{value:(r=t,s=n,h=e,o=l,function(t,i){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===t)throw i;return{value:u,done:!0}}for(h.method=t,h.arg=i;;){var n=h.delegate;if(n){n=function t(i,n){var e=n.method,r=i.iterator[e];if(r===u)return n.delegate=null,"throw"===e&&i.iterator.return&&(n.method="return",n.arg=u,t(i,n),"throw"===n.method)||"return"!==e&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+e+"' method")),b;e=c(r,i.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,b;r=e.arg;return r?r.done?(n[i.resultName]=r.value,n.next=i.nextLoc,"return"!==n.method&&(n.method="next",n.arg=u),n.delegate=null,b):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}(n,h);if(n){if(n===b)continue;return n}}if("next"===h.method)h.sent=h.P=h.arg;else if("throw"===h.method){if(o===l)throw o=d,h.arg;h.dispatchException(h.arg)}else"return"===h.method&&h.abrupt("return",h.arg);o=y;n=c(r,s,h);if("normal"===n.type){if(o=h.done?d:v,n.arg===b)continue;return{value:n.arg,done:h.done}}"throw"===n.type&&(o=d,h.method="throw",h.arg=n.arg)}})}),i}function c(t,i,n){try{return{type:"normal",arg:t.call(i,n)}}catch(t){return{type:"throw",arg:t}}}h.wrap=o;var l="suspendedStart",v="suspendedYield",y="executing",d="completed",b={};function m(){}function p(){}function M(){}var i={},k=(s(i,e,function(){return this}),Object.getPrototypeOf),k=k&&k(k(E([]))),w=(k&&k!==t&&a.call(k,e)&&(i=k),M.prototype=m.prototype=Object.create(i));function g(t){["next","throw","return"].forEach(function(i){s(t,i,function(t){return this._invoke(i,t)})})}function _(h,o){var i;f(this,"_invoke",{value:function(n,e){function t(){return new o(function(t,i){!function i(t,n,e,r){var s,t=c(h[t],h,n);if("throw"!==t.type)return(n=(s=t.arg).value)&&"object"==A(n)&&a.call(n,"__await")?o.resolve(n.N).then(function(t){i("next",t,e,r)},function(t){i("throw",t,e,r)}):o.resolve(n).then(function(t){s.value=t,e(s)},function(t){return i("throw",t,e,r)});r(t.arg)}(n,e,t,i)})}return i=i?i.then(t,t):t()}})}function S(t){var i={tryLoc:t[0]};1 in t&&(i.catchLoc=t[1]),2 in t&&(i.finallyLoc=t[2],i.afterLoc=t[3]),this.tryEntries.push(i)}function O(t){var i=t.completion||{};i.type="normal",delete i.arg,t.completion=i}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function E(i){if(i||""===i){var n,t=i[e];if(t)return t.call(i);if("function"==typeof i.next)return i;if(!isNaN(i.length))return n=-1,(t=function t(){for(;++n<i.length;)if(a.call(i,n))return t.value=i[n],t.done=!1,t;return t.value=u,t.done=!0,t}).next=t}throw new TypeError(A(i)+" is not iterable")}return f(w,"constructor",{value:p.prototype=M,configurable:!0}),f(M,"constructor",{value:p,configurable:!0}),p.displayName=s(M,r,"GeneratorFunction"),h.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},h.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,M):(t.__proto__=M,s(t,r,"GeneratorFunction")),t.prototype=Object.create(w),t},h.awrap=function(t){return{N:t}},g(_.prototype),s(_.prototype,n,function(){return this}),h.AsyncIterator=_,h.async=function(t,i,n,e,r){void 0===r&&(r=Promise);var s=new _(o(t,i,n,e),r);return h.isGeneratorFunction(i)?s:s.next().then(function(t){return t.done?t.value:s.next()})},g(w),s(w,r,"Generator"),s(w,e,function(){return this}),s(w,"toString",function(){return"[object Generator]"}),h.keys=function(t){var i,n=Object(t),e=[];for(i in n)e.push(i);return e.reverse(),function t(){for(;e.length;){var i=e.pop();if(i in n)return t.value=i,t.done=!1,t}return t.done=!0,t}},h.values=E,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this.P=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(O),!t)for(var i in this)"t"===i.charAt(0)&&a.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var e=this;function t(t,i){return s.type="throw",s.arg=n,e.next=t,i&&(e.method="next",e.arg=u),!!i}for(var i=this.tryEntries.length-1;0<=i;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var h=a.call(r,"catchLoc"),o=a.call(r,"finallyLoc");if(h&&o){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(h){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!o)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,i){for(var n=this.tryEntries.length-1;0<=n;--n){var e=this.tryEntries[n];if(e.tryLoc<=this.prev&&a.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var r=e;break}}var s=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=i&&i<=r.finallyLoc?null:r)?r.completion:{};return s.type=t,s.arg=i,r?(this.method="next",this.next=r.finallyLoc,b):this.complete(s)},complete:function(t,i){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&i&&(this.next=i),b},finish:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var n=this.tryEntries[i];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),b}},catch:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var n,e,r=this.tryEntries[i];if(r.tryLoc===t)return"throw"===(n=r.completion).type&&(e=n.arg,O(r)),e}throw Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:E(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=u),b}},h}function yt(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=A(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=A(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==A(t)?t:t+""))(e.key),e)}}t=(()=>{return t=function t(){var i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:1,s=this,h=t;if(!(s instanceof h))throw new TypeError("Cannot call a class as a function");this.isQuaternion=!0,this.g=i,this._=n,this.S=e,this.O=r},i=[{key:"x",get:function(){return this.g},set:function(t){this.g=t,this.j()}},{key:"y",get:function(){return this._},set:function(t){this._=t,this.j()}},{key:"z",get:function(){return this.S},set:function(t){this.S=t,this.j()}},{key:"w",get:function(){return this.O},set:function(t){this.O=t,this.j()}},{key:"set",value:function(t,i,n,e){return this.g=t,this._=i,this.S=n,this.O=e,this.j(),this}},{key:"clone",value:function(){return new this.constructor(this.g,this._,this.S,this.O)}},{key:"copy",value:function(t){return this.g=t.x,this._=t.y,this.S=t.z,this.O=t.w,this.j(),this}},{key:"setFromEuler",value:function(t){var i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=t.g,e=t._,r=t.S,s=t._order,t=Math.cos,h=Math.sin,o=t(n/2),u=t(e/2),a=t(r/2),f=h(n/2),c=h(e/2),l=h(r/2);switch(s){case"XYZ":this.g=f*u*a+o*c*l,this._=o*c*a-f*u*l,this.S=o*u*l+f*c*a,this.O=o*u*a-f*c*l;break;case"YXZ":this.g=f*u*a+o*c*l,this._=o*c*a-f*u*l,this.S=o*u*l-f*c*a,this.O=o*u*a+f*c*l;break;case"ZXY":this.g=f*u*a-o*c*l,this._=o*c*a+f*u*l,this.S=o*u*l+f*c*a,this.O=o*u*a-f*c*l;break;case"ZYX":this.g=f*u*a-o*c*l,this._=o*c*a+f*u*l,this.S=o*u*l-f*c*a,this.O=o*u*a+f*c*l;break;case"YZX":this.g=f*u*a+o*c*l,this._=o*c*a+f*u*l,this.S=o*u*l-f*c*a,this.O=o*u*a-f*c*l;break;case"XZY":this.g=f*u*a-o*c*l,this._=o*c*a-f*u*l,this.S=o*u*l+f*c*a,this.O=o*u*a+f*c*l;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+s)}return!0===i&&this.j(),this}},{key:"setFromAxisAngle",value:function(t,i){var i=i/2,n=Math.sin(i);return this.g=t.x*n,this._=t.y*n,this.S=t.z*n,this.O=Math.cos(i),this.j(),this}},{key:"setFromRotationMatrix",value:function(t){var t=t.elements,i=t[0],n=t[4],e=t[8],r=t[1],s=t[5],h=t[9],o=t[2],u=t[6],t=t[10],a=i+s+t;return 0<a?(a=.5/Math.sqrt(a+1),this.O=.25/a,this.g=(u-h)*a,this._=(e-o)*a,this.S=(r-n)*a):s<i&&t<i?(a=2*Math.sqrt(1+i-s-t),this.O=(u-h)/a,this.g=.25*a,this._=(n+r)/a,this.S=(e+o)/a):t<s?(a=2*Math.sqrt(1+s-i-t),this.O=(e-o)/a,this.g=(n+r)/a,this._=.25*a,this.S=(h+u)/a):(a=2*Math.sqrt(1+t-i-s),this.O=(r-n)/a,this.g=(e+o)/a,this._=(h+u)/a,this.S=.25*a),this.j(),this}},{key:"setFromUnitVectors",value:function(t,i){var n=t.dot(i)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this.g=-t.y,this._=t.x,this.S=0):(this.g=0,this._=-t.z,this.S=t.y)):(this.g=t.y*i.z-t.z*i.y,this._=t.z*i.x-t.x*i.z,this.S=t.x*i.y-t.y*i.x),this.O=n,this.normalize()}},{key:"angleTo",value:function(t){return 2*Math.acos(Math.abs(lt(this.dot(t),-1,1)))}},{key:"rotateTowards",value:function(t,i){var n=this.angleTo(t);return 0!==n&&(i=Math.min(1,i/n),this.slerp(t,i)),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this.g*=-1,this._*=-1,this.S*=-1,this.j(),this}},{key:"dot",value:function(t){return this.g*t.g+this._*t._+this.S*t.S+this.O*t.O}},{key:"lengthSq",value:function(){return this.g*this.g+this._*this._+this.S*this.S+this.O*this.O}},{key:"length",value:function(){return Math.sqrt(this.g*this.g+this._*this._+this.S*this.S+this.O*this.O)}},{key:"normalize",value:function(){var t=this.length();return 0===t?(this.g=0,this._=0,this.S=0,this.O=1):(this.g=this.g*(t=1/t),this._=this._*t,this.S=this.S*t,this.O=this.O*t),this.j(),this}},{key:"multiply",value:function(t){return this.multiplyQuaternions(this,t)}},{key:"premultiply",value:function(t){return this.multiplyQuaternions(t,this)}},{key:"multiplyQuaternions",value:function(t,i){var n=t.g,e=t._,r=t.S,t=t.O,s=i.g,h=i._,o=i.S,i=i.O;return this.g=n*i+t*s+e*o-r*h,this._=e*i+t*h+r*s-n*o,this.S=r*i+t*o+n*h-e*s,this.O=t*i-n*s-e*h-r*o,this.j(),this}},{key:"slerp",value:function(t,i){if(0!==i){if(1===i)return this.copy(t);var n,e=this.g,r=this._,s=this.S,h=this.O,o=h*t.O+e*t.g+r*t._+s*t.S;o<0?(this.O=-t.O,this.g=-t.g,this._=-t._,this.S=-t.S,o=-o):this.copy(t),1<=o?(this.O=h,this.g=e,this._=r,this.S=s):(t=1-o*o)<=Number.EPSILON?(this.O=(n=1-i)*h+i*this.O,this.g=n*e+i*this.g,this._=n*r+i*this._,this.S=n*s+i*this.S,this.normalize()):(n=Math.sqrt(t),t=Math.atan2(n,o),o=Math.sin((1-i)*t)/n,i=Math.sin(i*t)/n,this.O=h*o+this.O*i,this.g=e*o+this.g*i,this._=r*o+this._*i,this.S=s*o+this.S*i,this.j())}return this}},{key:"slerpQuaternions",value:function(t,i,n){return this.copy(t).slerp(i,n)}},{key:"random",value:function(){var t=2*Math.PI*Math.random(),i=2*Math.PI*Math.random(),n=Math.random(),e=Math.sqrt(1-n),n=Math.sqrt(n);return this.set(e*Math.sin(t),e*Math.cos(t),n*Math.sin(i),n*Math.cos(i))}},{key:"equals",value:function(t){return t.g===this.g&&t._===this._&&t.S===this.S&&t.O===this.O}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.g=t[i],this._=t[i+1],this.S=t[i+2],this.O=t[i+3],this.j(),this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.g,t[i+1]=this._,t[i+2]=this.S,t[i+3]=this.O,t}},{key:"fromBufferAttribute",value:function(t,i){return this.g=t.getX(i),this._=t.getY(i),this.S=t.getZ(i),this.O=t.getW(i),this.j(),this}},{key:"toJSON",value:function(){return this.toArray()}},{key:"_onChange",value:function(t){return this.j=t,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:vt().mark(function t(){return vt().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.g;case 2:return t.next=4,this._;case 4:return t.next=6,this.S;case 6:return t.next=8,this.O;case 8:case"end":return t.stop()}},t,this)})}],n=[{key:"slerpFlat",value:function(t,i,n,e,r,s,h){var o,u,a,f=n[e+0],c=n[e+1],l=n[e+2],n=n[e+3],e=r[s+0],v=r[s+1],y=r[s+2],r=r[s+3];0===h?(t[i+0]=f,t[i+1]=c,t[i+2]=l,t[i+3]=n):1===h?(t[i+0]=e,t[i+1]=v,t[i+2]=y,t[i+3]=r):(n===r&&f===e&&c===v&&l===y||(s=1-h,o=0<=(u=f*e+c*v+l*y+n*r)?1:-1,(a=1-u*u)>Number.EPSILON&&(a=Math.sqrt(a),u=Math.atan2(a,u*o),s=Math.sin(s*u)/a,h=Math.sin(h*u)/a),f=f*s+e*(u=h*o),c=c*s+v*u,l=l*s+y*u,n=n*s+r*u,s===1-h&&(f*=a=1/Math.sqrt(f*f+c*c+l*l+n*n),c*=a,l*=a,n*=a)),t[i]=f,t[i+1]=c,t[i+2]=l,t[i+3]=n)}},{key:"multiplyQuaternionsFlat",value:function(t,i,n,e,r,s){var h=n[e],o=n[e+1],u=n[e+2],n=n[e+3],e=r[s],a=r[s+1],f=r[s+2],r=r[s+3];return t[i]=h*r+n*e+o*f-u*a,t[i+1]=o*r+n*a+u*e-h*f,t[i+2]=u*r+n*f+h*a-o*e,t[i+3]=n*r-h*e-o*a-u*f,t}}],i&&yt(t.prototype,i),n&&yt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,n})();function I(t){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function dt(){dt=function(){return h};var u,h={},t=Object.prototype,a=t.hasOwnProperty,f=Object.defineProperty||function(t,i,n){t[i]=n.value},i="function"==typeof Symbol?Symbol:{},e=i.iterator||"@@iterator",n=i.asyncIterator||"@@asyncIterator",r=i.toStringTag||"@@toStringTag";function s(t,i,n){return Object.defineProperty(t,i,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[i]}try{s({},"")}catch(u){s=function(t,i,n){return t[i]=n}}function o(t,i,n,e){var r,s,h,o,i=i&&i.prototype instanceof m?i:m,i=Object.create(i.prototype),e=new j(e||[]);return f(i,"_invoke",{value:(r=t,s=n,h=e,o=l,function(t,i){if(o===y)throw Error("Generator is already running");if(o===d){if("throw"===t)throw i;return{value:u,done:!0}}for(h.method=t,h.arg=i;;){var n=h.delegate;if(n){n=function t(i,n){var e=n.method,r=i.iterator[e];if(r===u)return n.delegate=null,"throw"===e&&i.iterator.return&&(n.method="return",n.arg=u,t(i,n),"throw"===n.method)||"return"!==e&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+e+"' method")),b;e=c(r,i.iterator,n.arg);if("throw"===e.type)return n.method="throw",n.arg=e.arg,n.delegate=null,b;r=e.arg;return r?r.done?(n[i.resultName]=r.value,n.next=i.nextLoc,"return"!==n.method&&(n.method="next",n.arg=u),n.delegate=null,b):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,b)}(n,h);if(n){if(n===b)continue;return n}}if("next"===h.method)h.sent=h.P=h.arg;else if("throw"===h.method){if(o===l)throw o=d,h.arg;h.dispatchException(h.arg)}else"return"===h.method&&h.abrupt("return",h.arg);o=y;n=c(r,s,h);if("normal"===n.type){if(o=h.done?d:v,n.arg===b)continue;return{value:n.arg,done:h.done}}"throw"===n.type&&(o=d,h.method="throw",h.arg=n.arg)}})}),i}function c(t,i,n){try{return{type:"normal",arg:t.call(i,n)}}catch(t){return{type:"throw",arg:t}}}h.wrap=o;var l="suspendedStart",v="suspendedYield",y="executing",d="completed",b={};function m(){}function p(){}function M(){}var i={},k=(s(i,e,function(){return this}),Object.getPrototypeOf),k=k&&k(k(E([]))),w=(k&&k!==t&&a.call(k,e)&&(i=k),M.prototype=m.prototype=Object.create(i));function g(t){["next","throw","return"].forEach(function(i){s(t,i,function(t){return this._invoke(i,t)})})}function _(h,o){var i;f(this,"_invoke",{value:function(n,e){function t(){return new o(function(t,i){!function i(t,n,e,r){var s,t=c(h[t],h,n);if("throw"!==t.type)return(n=(s=t.arg).value)&&"object"==I(n)&&a.call(n,"__await")?o.resolve(n.N).then(function(t){i("next",t,e,r)},function(t){i("throw",t,e,r)}):o.resolve(n).then(function(t){s.value=t,e(s)},function(t){return i("throw",t,e,r)});r(t.arg)}(n,e,t,i)})}return i=i?i.then(t,t):t()}})}function S(t){var i={tryLoc:t[0]};1 in t&&(i.catchLoc=t[1]),2 in t&&(i.finallyLoc=t[2],i.afterLoc=t[3]),this.tryEntries.push(i)}function O(t){var i=t.completion||{};i.type="normal",delete i.arg,t.completion=i}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(S,this),this.reset(!0)}function E(i){if(i||""===i){var n,t=i[e];if(t)return t.call(i);if("function"==typeof i.next)return i;if(!isNaN(i.length))return n=-1,(t=function t(){for(;++n<i.length;)if(a.call(i,n))return t.value=i[n],t.done=!1,t;return t.value=u,t.done=!0,t}).next=t}throw new TypeError(I(i)+" is not iterable")}return f(w,"constructor",{value:p.prototype=M,configurable:!0}),f(M,"constructor",{value:p,configurable:!0}),p.displayName=s(M,r,"GeneratorFunction"),h.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))},h.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,M):(t.__proto__=M,s(t,r,"GeneratorFunction")),t.prototype=Object.create(w),t},h.awrap=function(t){return{N:t}},g(_.prototype),s(_.prototype,n,function(){return this}),h.AsyncIterator=_,h.async=function(t,i,n,e,r){void 0===r&&(r=Promise);var s=new _(o(t,i,n,e),r);return h.isGeneratorFunction(i)?s:s.next().then(function(t){return t.done?t.value:s.next()})},g(w),s(w,r,"Generator"),s(w,e,function(){return this}),s(w,"toString",function(){return"[object Generator]"}),h.keys=function(t){var i,n=Object(t),e=[];for(i in n)e.push(i);return e.reverse(),function t(){for(;e.length;){var i=e.pop();if(i in n)return t.value=i,t.done=!1,t}return t.done=!0,t}},h.values=E,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this.P=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(O),!t)for(var i in this)"t"===i.charAt(0)&&a.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(n){if(this.done)throw n;var e=this;function t(t,i){return s.type="throw",s.arg=n,e.next=t,i&&(e.method="next",e.arg=u),!!i}for(var i=this.tryEntries.length-1;0<=i;--i){var r=this.tryEntries[i],s=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var h=a.call(r,"catchLoc"),o=a.call(r,"finallyLoc");if(h&&o){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(h){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!o)throw Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(t,i){for(var n=this.tryEntries.length-1;0<=n;--n){var e=this.tryEntries[n];if(e.tryLoc<=this.prev&&a.call(e,"finallyLoc")&&this.prev<e.finallyLoc){var r=e;break}}var s=(r=r&&("break"===t||"continue"===t)&&r.tryLoc<=i&&i<=r.finallyLoc?null:r)?r.completion:{};return s.type=t,s.arg=i,r?(this.method="next",this.next=r.finallyLoc,b):this.complete(s)},complete:function(t,i){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&i&&(this.next=i),b},finish:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var n=this.tryEntries[i];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),O(n),b}},catch:function(t){for(var i=this.tryEntries.length-1;0<=i;--i){var n,e,r=this.tryEntries[i];if(r.tryLoc===t)return"throw"===(n=r.completion).type&&(e=n.arg,O(r)),e}throw Error("illegal catch attempt")},delegateYield:function(t,i,n){return this.delegate={iterator:E(t),resultName:i,nextLoc:n},"next"===this.method&&(this.arg=u),b}},h}function bt(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=I(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=I(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==I(t)?t:t+""))(e.key),e)}}var d=(()=>{function s(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0,e=this,r=s;if(!(e instanceof r))throw new TypeError("Cannot call a class as a function");s.prototype.isVector3=!0,this.x=t,this.y=i,this.z=n}return t=s,(i=[{key:"set",value:function(t,i,n){return void 0===n&&(n=this.z),this.x=t,this.y=i,this.z=n,this}},{key:"setScalar",value:function(t){return this.x=t,this.y=t,this.z=t,this}},{key:"setX",value:function(t){return this.x=t,this}},{key:"setY",value:function(t){return this.y=t,this}},{key:"setZ",value:function(t){return this.z=t,this}},{key:"setComponent",value:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw new Error("index is out of range: "+t)}return this}},{key:"getComponent",value:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}},{key:"add",value:function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}},{key:"addScalar",value:function(t){return this.x+=t,this.y+=t,this.z+=t,this}},{key:"addVectors",value:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this}},{key:"addScaledVector",value:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this}},{key:"sub",value:function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}},{key:"subScalar",value:function(t){return this.x-=t,this.y-=t,this.z-=t,this}},{key:"subVectors",value:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this}},{key:"multiply",value:function(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}},{key:"multiplyScalar",value:function(t){return this.x*=t,this.y*=t,this.z*=t,this}},{key:"multiplyVectors",value:function(t,i){return this.x=t.x*i.x,this.y=t.y*i.y,this.z=t.z*i.z,this}},{key:"applyEuler",value:function(t){return this.applyQuaternion(pt.setFromEuler(t))}},{key:"applyAxisAngle",value:function(t,i){return this.applyQuaternion(pt.setFromAxisAngle(t,i))}},{key:"applyMatrix3",value:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements;return this.x=t[0]*i+t[3]*n+t[6]*e,this.y=t[1]*i+t[4]*n+t[7]*e,this.z=t[2]*i+t[5]*n+t[8]*e,this}},{key:"applyNormalMatrix",value:function(t){return this.applyMatrix3(t).normalize()}},{key:"applyMatrix4",value:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements,r=1/(t[3]*i+t[7]*n+t[11]*e+t[15]);return this.x=(t[0]*i+t[4]*n+t[8]*e+t[12])*r,this.y=(t[1]*i+t[5]*n+t[9]*e+t[13])*r,this.z=(t[2]*i+t[6]*n+t[10]*e+t[14])*r,this}},{key:"applyQuaternion",value:function(t){var i=this.x,n=this.y,e=this.z,r=t.x,s=t.y,h=t.z,t=t.w,o=2*(s*e-h*n),u=2*(h*i-r*e),a=2*(r*n-s*i);return this.x=i+t*o+s*a-h*u,this.y=n+t*u+h*o-r*a,this.z=e+t*a+r*u-s*o,this}},{key:"project",value:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}},{key:"unproject",value:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}},{key:"transformDirection",value:function(t){var i=this.x,n=this.y,e=this.z,t=t.elements;return this.x=t[0]*i+t[4]*n+t[8]*e,this.y=t[1]*i+t[5]*n+t[9]*e,this.z=t[2]*i+t[6]*n+t[10]*e,this.normalize()}},{key:"divide",value:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}},{key:"divideScalar",value:function(t){return this.multiplyScalar(1/t)}},{key:"min",value:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}},{key:"max",value:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}},{key:"clamp",value:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this}},{key:"clampScalar",value:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this}},{key:"clampLength",value:function(t,i){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(t){return this.x*t.x+this.y*t.y+this.z*t.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(t){return this.normalize().multiplyScalar(t)}},{key:"lerp",value:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this}},{key:"lerpVectors",value:function(t,i,n){return this.x=t.x+(i.x-t.x)*n,this.y=t.y+(i.y-t.y)*n,this.z=t.z+(i.z-t.z)*n,this}},{key:"cross",value:function(t){return this.crossVectors(this,t)}},{key:"crossVectors",value:function(t,i){var n=t.x,e=t.y,t=t.z,r=i.x,s=i.y,i=i.z;return this.x=e*i-t*s,this.y=t*r-n*i,this.z=n*s-e*r,this}},{key:"projectOnVector",value:function(t){var i=t.lengthSq();return 0===i?this.set(0,0,0):(i=t.dot(this)/i,this.copy(t).multiplyScalar(i))}},{key:"projectOnPlane",value:function(t){return mt.copy(this).projectOnVector(t),this.sub(mt)}},{key:"reflect",value:function(t){return this.sub(mt.copy(t).multiplyScalar(2*this.dot(t)))}},{key:"angleTo",value:function(t){var i=Math.sqrt(this.lengthSq()*t.lengthSq());return 0===i?Math.PI/2:(t=this.dot(t)/i,Math.acos(lt(t,-1,1)))}},{key:"distanceTo",value:function(t){return Math.sqrt(this.distanceToSquared(t))}},{key:"distanceToSquared",value:function(t){var i=this.x-t.x,n=this.y-t.y,t=this.z-t.z;return i*i+n*n+t*t}},{key:"manhattanDistanceTo",value:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}},{key:"setFromSpherical",value:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}},{key:"setFromSphericalCoords",value:function(t,i,n){var e=Math.sin(i)*t;return this.x=e*Math.sin(n),this.y=Math.cos(i)*t,this.z=e*Math.cos(n),this}},{key:"setFromCylindrical",value:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}},{key:"setFromCylindricalCoords",value:function(t,i,n){return this.x=t*Math.sin(i),this.y=n,this.z=t*Math.cos(i),this}},{key:"setFromMatrixPosition",value:function(t){t=t.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(t){var i=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),t=this.setFromMatrixColumn(t,2).length();return this.x=i,this.y=n,this.z=t,this}},{key:"setFromMatrixColumn",value:function(t,i){return this.fromArray(t.elements,4*i)}},{key:"setFromMatrix3Column",value:function(t,i){return this.fromArray(t.elements,3*i)}},{key:"setFromEuler",value:function(t){return this.x=t.g,this.y=t._,this.z=t.S,this}},{key:"setFromColor",value:function(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}},{key:"equals",value:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}},{key:"fromArray",value:function(t){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return this.x=t[i],this.y=t[i+1],this.z=t[i+2],this}},{key:"toArray",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;return t[i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t}},{key:"fromBufferAttribute",value:function(t,i){return this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomDirection",value:function(){var t=Math.random()*Math.PI*2,i=2*Math.random()-1,n=Math.sqrt(1-i*i);return this.x=n*Math.cos(t),this.y=i,this.z=n*Math.sin(t),this}},{key:Symbol.iterator,value:dt().mark(function t(){return dt().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.x;case 2:return t.next=4,this.y;case 4:return t.next=6,this.z;case 6:case"end":return t.stop()}},t,this)})}])&&bt(t.prototype,i),n&&bt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,i,n})(),mt=new d,pt=new t;function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Mt(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=b(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=b(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==b(t)?t:t+""))(e.key),e)}}function kt(t,i,n){return i&&Mt(t.prototype,i),n&&Mt(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}var m=1e-5,p=.001,wt=Math.PI/180,gt=180/Math.PI,t=kt(function t(){if(!(this instanceof t))throw new TypeError("Cannot call a class as a function")});Object.assign(t.prototype,{C:function(){return m},F:function(){return wt},D:function(){return gt},Y:function(t){return t<m&&-m<t},V:function(t){return m<t},Z:function(t){return t<-m},X:function(t,i,n){i=(t.x-n.x)*(i.y-n.y)-(i.x-n.x)*(t.y-n.y);return Math.abs(i)<m?0:i},distanceOfTwoPoints:function(t,i){return t&&i?Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)):Number.NaN},distance:function(t,i){return Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))},isPolygonContainPoint:function(t,i){for(var n=0,e=0;e<t.length;e++){var r=t[e].x,s=t[e].y,h=0,o=0,o=(e<t.length-1?(h=t[e+1].x,t[e+1]):(h=t[0].x,t[0])).y;if(r===i.x&&s===i.y||h===i.x&&o===i.y)return!0;if(o!==s){var u=r+(i.y-s)*(h-r)/(o-s);if(u===i.x)return!0;r!==h?u<=Math.max(r,h)&&u>=Math.min(r,h)&&u>i.x&&u!==r&&(u===h&&0<(s-i.y)*(o-i.y)?n+=2:n++):u<=Math.max(r,h)&&u>=Math.min(r,h)&&u>i.x&&(u===h&&0<(s-i.y)*(o-i.y)?n+=2:n++)}}return 0<n%2},isPolygonContainPoint2:function(t,i){var n=t.length;if(n<3)return!1;for(var e=n-1,r=0,s=0;s<n;s++){var h=t[s],o=t[e];h.y>i.y!=o.y>i.y&&i.x<(o.x-h.x)*(i.y-h.y)/(o.y-h.y)+h.x&&(h.y>o.y?r++:r--),e=s}return 0!=r},isPolygonInPolygon:function(t,i){var n=Object.assign([],t),e=Object.assign([],i);n.push(n[0]),e.push(e[0]);for(var r=0;r<n.length-1;r++){var s=n[r];if(!this.isPolygonContainPoint(e,s)&&!this.isPolygonContainPoint2(e,s))return!1}for(var h=0;h<n.length-1;h++)for(var o=0;o<e.length-1;o++)if(this.B(n[h],n[h+1],e[o],e[o+1]).isintersect&&!this.G(e[o],e[o+1],n[h])&&!this.G(e[o],e[o+1],n[h+1]))return!1;return!0},H:function(t,i,n,e){return!(Math.max(t.x,i.x)<Math.min(n.x,e.x)||Math.max(t.y,i.y)<Math.min(n.y,e.y)||Math.max(n.x,e.x)<Math.min(t.x,i.x)||Math.max(n.y,e.y)<Math.min(t.y,i.y))},U:function(t,i,n,e){return!(Math.max(t.x,i.x)<Math.min(n.x,e.x)||Math.max(t.y,i.y)<Math.min(n.y,e.y)||Math.max(n.x,e.x)<Math.min(t.x,i.x)||Math.max(n.y,e.y)<Math.min(t.y,i.y)||0===this.X(n,i,t)&&0===this.X(i,e,t)||this.X(n,i,t)*this.X(i,e,t)<0||this.X(t,e,n)*this.X(e,i,n)<0)},q:function(t,i,n){return!(t.x<i.x||t.y<i.y||t.x>n.x||n.y<t.y)},K:function(t,i,n){var e=Math.min(i.x,n.x),r=Math.max(i.x,n.x),s=Math.min(i.y,n.y),i=Math.max(i.y,n.y);return!(t.x<e||t.x>r||t.y<s||t.y>i)},W:function(t,i,n){var e=Math.min(n.x,i.x),r=Math.max(n.x,i.x),s=Math.min(n.y,i.y),n=Math.max(n.y,i.y);return!(t.x<e||t.x>r||t.y<s||t.y>n)},$:function(t,i,n){for(var e,r,s=!1,h=0;h<n;h++)e=i[h],r=i[(h+1)%n],(e.y<t.y&&r.y>=t.y||r.y<t.y&&e.y>=t.y)&&(e.x<=t.x||r.x<=t.x)&&e.x+(t.y-e.y)/(r.y-e.y)*(r.x-e.x)<t.x&&(s=!s);return s},J:function(t,i,n){return(t.x-i.x)*(n.y-i.y)==(n.x-i.x)*(t.y-i.y)&&Math.min(i.x,n.x)<=t.x&&t.x<=Math.max(i.x,n.x)&&Math.min(i.y,n.y)<=t.y&&t.y<=Math.max(i.y,n.y)},tt:function(t,i){return Math.sqrt((t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y))},it:function(t,i){return(t.x-i.x)*(t.x-i.x)+(t.y-i.y)*(t.y-i.y)},nt:function(t,i,n){var e=i.x,i=i.y,r=n.x,n=n.y,s=t.x,t=t.y,h=r-e,o=n-i,u=h*h+o*o,a=s-e,f=t-i,c=a*a+f*f;return this.Y(u)?this.Y(c)?0:c:(u=Math.sqrt(u),f=this.V(o=(h=h/u)*a+(a=o/u)*f)?this.Z(o-u)?(f=s-(e+o*h))*f+(u=t-(i+o*a))*u:(e=s-r)*e+(h=t-n)*h:c,this.Y(f)?0:f)},et:function(t,i,n,e){var r,s=i.x,h=i.y,o=n.x,u=n.y,a=t.x,t=t.y,f=o-s,c=u-h,l=Math.sqrt(f*f+c*c),v=a-s,y=t-h,d=Math.sqrt(v*v+y*y);return this.Y(l)?(e.x=i.x,e.y=i.y,this.Y(r=d)?0:r):(r=this.V(c=(f=f/l)*v+(v=c/l)*y)?this.Z(c-l)?(l=a-(y=s+c*f),f=t-(s=h+c*v),h=Math.sqrt(l*l+f*f),e.x=y,e.y=s,h):(c=a-o,v=t-u,l=Math.sqrt(c*c+v*v),e.x=n.x,e.y=n.y,l):(e.x=i.x,e.y=i.y,d),this.Y(r)?0:r)},rt:function(t,i){for(var n=0,e=0,r=0,s=0;s<i;s++){var h=t[s],o=t[(s+1)%i],u=(h.x*o.y-h.y*o.x)/2;n+=u,e+=u*(h.x+o.x)/3,r+=u*(h.y+o.y)/3}return{x:e/=n,y:r/=n}},st:function(t){for(var i=y.triangulate([t]),n=0,e=0,r=0,s=0;s<i.length;s++){var h=t[i[s][0]],o=t[i[s][1]],u=t[i[s][2]],a=o.x-h.x,f=o.y-h.y,c=u.x-h.x,a=(a*(u.y-h.y)-c*f)/2;n+=a,e+=(h.x+o.x+u.x)/3*a,r+=(h.y+o.y+u.y)/3*a}return{x:e/n,y:r/n}},ht:function(t,i){if(i<3)return 0;for(var n=0,e=0;e<i;++e){var r=t[e],s=t[(e+1)%i];n+=r.x*s.y-r.y*s.x}return Math.abs(n/2)},ot:function(t,i,n,e,r){var s;return this.U(t,i,n,e)?(s=(e.x-n.x)*(t.y-i.y)-(i.x-t.x)*(n.y-e.y),r.x=((t.y-n.y)*(i.x-t.x)*(e.x-n.x)+n.x*(e.y-n.y)*(i.x-t.x)-t.x*(i.y-t.y)*(e.x-n.x))/s,r.y=(i.y*(t.x-i.x)*(e.y-n.y)+(e.x-i.x)*(e.y-n.y)*(t.y-i.y)-e.y*(n.x-e.x)*(i.y-t.y))/(s=(t.x-i.x)*(e.y-n.y)-(i.y-t.y)*(n.x-e.x)),1):0},ut:function(t,i,n,e,r){var s=Math.min(n.x,e.x),h=Math.max(n.x,e.x),o=Math.min(n.y,e.y),u=Math.max(n.y,e.y),a=t.x,f=t.y,c=n.x,l=n.y,v=e.x,y=e.y;if(90==i)return!(t.x<s||t.x>h||(h-s<p?t.y>=l&&t.y<=y||t.y>=y&&t.y<=l?(r.x=t.x,r.y=t.y,0):l<y&&t.x<l?(r.x=c,r.y=l,0):!(y<l&&t.x<y)||(r.x=v,r.y=y,0):(r.y=d=(y-l)/(v-c)*(a-c)+l,r.x=a,d<f||!this.W(r,n,e))));if(270==i)return!(t.x<s||t.x>h||(Math.abs(h-s<p)?t.y>=l&&t.y<=y||t.y>=y&&t.y<=l?(r.x=t.x,r.y=t.y,0):l<y&&t.y>y?(r.x=v,r.y=y,0):!(y<l&&t.y>l)||(r.x=c,r.y=l,0):(r.y=d=(y-l)/(v-c)*(a-c)+l,r.x=a,f<d||!this.W(r,n,e))));if(270!=i&&90!=i&&Math.abs(h-s<p)){var t=s,d=Math.tan(i/180*Math.PI)*(t-a)+f;if(r.y=d,r.x=t,this.W(r,n,e))return h=d-f,0<(s=t-a)/Math.sqrt(s*s+h*h)*Math.cos(i/180*Math.PI)}return Math.abs(u-o<=p)?(d=o,t=1/Math.tan(i/180*Math.PI)*(d-f)+a,r.x=t,r.y=d,!!this.W(r,n,e)&&(s=d-f,0<(h=t-a)/Math.sqrt(h*h+s*s)*Math.cos(i/180*Math.PI))):(t=f+(u=Math.tan(i/180*Math.PI))*((d=(l-f-((o=(y-l)/(v-c))*c-u*a))/(u-o))-a),r.x=d,r.y=t,!!this.W(r,n,e)&&(h=d-a,s=t-f,Math.abs(h)<=p&&Math.abs(s)<=p||0<h/Math.sqrt(h*h+s*s)*Math.cos(i/180*Math.PI)))},ft:function(t,i){return Math.abs(t.x-i.x)<m&&Math.abs(t.y-i.y)<m},ct:function(t,i,n,e){var r,s,h,o,u=t.x,a=t.y,f=i.x,c=i.y,l=n.x,v=n.y;return this.ft(t,i)||this.ft(t,n)?(e.x=u,e.y=a,!0):(h=Math.min(i.x,n.x),o=Math.max(i.x,n.x),r=Math.min(i.y,n.y),s=Math.max(i.y,n.y),Math.abs(f-l)<1e-5?(e.x=f,r<=(e.y=a)&&a<=s):Math.abs(c-v)<1e-5?(e.x=u,e.y=c,h<=u&&u<=o):(o=a+(r=-1/((v-c)/(l-f)))*((h=(c-a-((s=(v-c)/(l-f))*f-r*u))/(r-s))-u),e.x=h,e.y=o,!!this.W(e,i,n)||!(!this.ft(t,i)&&!this.ft(t,n))))},lt:function(t,i){return{x:t.y*i.z-t.z*i.y,y:t.z*i.x-t.x*i.z,z:t.x*i.y-t.y*i.x}},vt:function(t,i){return t.x*i.x+t.y*i.y+t.z*i.z},yt:function(t){return Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)},dt:function(t,i){return t.x*i.x+t.y*i.y},bt:function(t,i){return t.x*i.y-t.y*i.x},Mt:function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},kt:function(t,i){var n,e;return 0==t.x&&0==t.y||0==i.x&&0==i.y?0:(n={x:i.x,y:i.y,z:0},n=this.lt({x:t.x,y:t.y,z:0},n),e=this.dt(t,i),e=Math.acos(e/(this.Mt(t)*this.Mt(i))),0<n.z?e/Math.PI*180:360-e/Math.PI*180)},wt:function(t,i,n,e){for(var r=0;r<n.length;r++)if(1==this.ot(t,i,n[r],n[(r+1)%n.length],e))return!0;return!1},gt:function(t,i,n,e,r){var s=Math.min(t.x,n.x,e.x),h=Math.max(t.x,n.x,e.x),o=Math.min(t.y,n.y,e.y),u=Math.max(t.y,n.y,e.y),h=Math.sqrt((h-s)*(h-s)+(u-o)*(u-o)),s=i/180*Math.PI,u=h*Math.cos(s)+t.x,o=h*Math.sin(s)+t.y;return 1==this.ot(t,{x:u,y:o},n,e,r)},_t:function(t){var i={x:null,y:null},n=0,e=0,r=t.length;1<t.length&&t[0].x===t[t.length-1].x&&t[0].y===t[t.length-1].y&&r--;for(var s=0;s<r;s++)n+=t[s].x,e+=t[s].y;return i.x=n/t.length,i.y=e/t.length,i},St:function(t,i,n,e){var r=[],s=t.x-i,h=t.x+i,o=t.y-i,u=t.y+i,a=Math.min(n.x,e.x),f=Math.max(n.x,e.x),c=Math.min(n.y,e.y),l=Math.max(n.y,e.y);return f<s||h<a||l<o||u<c||(h=(t=((s=e.x-n.x)*(h=t.x-n.x)+(o=e.y-n.y)*(u=t.y-n.y))/(e=s*s+o*o))*t-(h*h+u*u-i*i)/e)<0||(u=Math.sqrt(h),e={x:n.x-s*(i=-t+u),y:n.y-o*i},s={x:n.x-s*(h=-t-u),y:n.y-o*h},i!==h&&(a<=e.x&&e.x<=f&&c<=e.y&&e.y<=l&&r.push(e),a<=s.x)&&s.x<=f&&c<=s.y&&s.y<=l&&r.push(s)),r},Ot:function(t,i){return Math.abs(t.x-i.x)<=m&&Math.abs(t.y-i.y)<=m},jt:function(t,i,n){var e,r={};if(t.x!=i.x)return e=i=(i.y-t.y)/(i.x-t.x),r.x=(+n.x- -1*e*n.y-e*(i=t.y-i*t.x))/(e*e+1),r.y=(e*e*n.y- -1*e*n.x- -1*i)/(e*e+1),r;r.x=t.x,r.y=n.y},B:function(t,i,n,e){var r,s,h,o,u={point:null,isintersect:!1};return this.distanceOfTwoPoints(t,n)<.001||this.distanceOfTwoPoints(t,e)<.001?(u.isintersect=!0,u.point=t):this.distanceOfTwoPoints(i,n)<.001||this.distanceOfTwoPoints(i,e)<.001?(u.isintersect=!0,u.point=i):(r={x:i.x-t.x,y:i.y-t.y},s={x:e.x-n.x,y:e.y-n.y},e={x:e.x-t.x,y:e.y-t.y},i={x:i.x-n.x,y:i.y-n.y},h={x:-(n={x:n.x-t.x,y:n.y-t.y}).x,y:-n.y},o=this.bt(s,r),Math.abs(o)<=1e-5||this.bt(n,r)*this.bt(e,r)<=-5e-4&&this.bt(h,s)*this.bt(i,s)<-5e-4&&(e=this.bt(s,n)/o,u.point={x:t.x+r.x*e,y:t.y+r.y*e},u.isintersect=!0)),u},Et:function(t,i,n){return t.x===i.x&&(i.x=i.x+1),t.y===i.y&&(i.y=i.y+1),i.x===n.x&&(n.x=n.x+1),i.y===n.y&&(n.y=n.y+1),!(0<(i.x-t.x)*(n.y-i.y)-(i.y-t.y)*(n.x-i.x))},getAngle:function(t){var i=t.p1,t=t.p2,n=t.x-i.x,t=t.y-i.y,i=Math.sqrt(n*n+t*t),i=Math.asin(Math.abs(t)/i);return 0<n&&0<t?i:n<0&&0<t?Math.PI-i:n<0&&t<0?Math.PI+i:0<n&&t<0?2*Math.PI-i:0==n&&0<t?i:0==n&&t<0?3*Math.PI/2:0<n&&0==t?i:n<0&&0==t?Math.PI:null},Tt:function(t){var i=this.distanceOfTwoPoints(t[0],t[1]),n=this.distanceOfTwoPoints(t[1],t[2]),t=this.distanceOfTwoPoints(t[0],t[2]),e=(i+n+t)/2;return Math.sqrt(e*(e-i)*(e-n)*(e-t))},xt:function(t,i){var n,e,r,s,h;return this.et(t,i[0],i[1],{})<1e-4||this.et(t,i[0],i[2],{})<1e-4||this.et(t,i[1],i[2],{})<1e-4||(s={x:i[1].x-i[0].x,y:i[1].y-i[0].y},n={x:i[0].x-i[2].x,y:i[0].y-i[2].y},e={x:i[2].x-i[1].x,y:i[2].y-i[1].y},h={x:t.x-i[0].x,y:t.y-i[0].y},r={x:t.x-i[1].x,y:t.y-i[1].y},t={x:t.x-i[2].x,y:t.y-i[2].y},i=this.bt(s,h),s=this.bt(e,r),h=this.bt(n,t),m<i*s&&m<s*h)},Rt:function(t,i,n){var e=n.length,r={isintersect:!1,start:null,end:null,type:0,outer:null},s=[];if(this.xt(t,n)&&(r.start=t),this.xt(i,n)&&(r.end=i),null!=r.start&&null!=r.end)r.isintersect=!0,r.type=1;else{for(var h=(n[1].x+n[2].x)/2,o=(n[1].y+n[2].y)/2,u=1;u<e;u++){var a,f=this.B(t,i,n[u-1],n[u]);if(f.isintersect){if(null!=r.start)return r.end=f.point,r.isintersect=!0,r.outer="end",a=this.kt({x:h-n[0].x,y:o-n[0].y},{x:i.x-n[0].x,y:i.y-n[0].y}),r.type=0<(a=a<180?a:a-360)?2:3,r;if(null!=r.end)return r.start=f.point,r.isintersect=!0,r.outer="start",a=this.kt({x:h-n[0].x,y:o-n[0].y},{x:t.x-n[0].x,y:t.y-n[0].y}),r.type=0<(a=a<180?a:a-360)?2:3,r;s.push(f)}}var c,l=this.B(t,i,n[0],n[e-1]);if(l.isintersect){if(null!=r.start)return r.end=l.point,r.isintersect=!0,r.outer="end",c=this.kt({x:h-n[0].x,y:o-n[0].y},{x:i.x-n[0].x,y:i.y-n[0].y}),r.type=0<(c=c<180?c:c-360)?2:3,r;if(null!=r.end)return r.start=l.point,r.isintersect=!0,r.outer="start",c=this.kt({x:h-n[0].x,y:o-n[0].y},{x:t.x-n[0].x,y:t.y-n[0].y}),r.type=0<(c=c<180?c:c-360)?2:3,r;s.push(l)}2!=s.length||this.distanceOfTwoPoints(s[0].point,s[1].point)<.01||(this.distanceOfTwoPoints(s[0].point,t)<=this.distanceOfTwoPoints(s[0].point,i)?(r.start=s[0].point,r.end=s[1].point):(r.start=s[1].point,r.end=s[0].point),r.isintersect=!0,r.type=4)}return r},Lt:function(t,i,n){var e=n.length,r={isintersect:!1,start:null,end:null},s=[];if(this.xt(t,n)&&(r.start=t),this.xt(i,n)&&(r.end=i),null!=r.start&&null!=r.end)r.isintersect=!0;else{for(var h=1;h<e;h++){var o=this.B(t,i,n[h-1],n[h]);if(o.isintersect){if(null!=r.start)return r.end=o.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;s.push(o)}}var u=this.B(t,i,n[0],n[e-1]);if(u.isintersect){if(null!=r.start)return r.end=u.point,r.isintersect=!0,r;if(null!=r.end)return r.start=t,r.isintersect=!0,r;s.push(u)}2==s.length&&(r.start=(this.distanceOfTwoPoints(s[0].point,t)<=this.distanceOfTwoPoints(s[0].point,i)?s[0]:s[1]).point,r.end=(this.distanceOfTwoPoints(s[0].point,t)>this.distanceOfTwoPoints(s[0].point,i)?s[0]:s[1]).point,r.isintersect=!0)}return r},At:function(r,t){if(0==t.length)return[r];for(var i,n,e=this.It(t),s=[],h=(e.sort(function(t,i){var n=(t.Pt.x-r.Pt.x)*(t.Pt.x-r.Pt.x)+(t.Pt.y-r.Pt.y)*(t.Pt.y-r.Pt.y),e=(i.Pt.x-r.Pt.x)*(i.Pt.x-r.Pt.x)+(i.Pt.y-r.Pt.y)*(i.Pt.y-r.Pt.y),t=(t.Nt.x-r.Pt.x)*(t.Nt.x-r.Pt.x)+(t.Nt.y-r.Pt.y)*(t.Nt.y-r.Pt.y),i=(i.Nt.x-r.Pt.x)*(i.Nt.x-r.Pt.x)+(i.Nt.y-r.Pt.y)*(i.Nt.y-r.Pt.y);return(n<t?n:t)<(e<i?e:i)}),0),h=0;h<e.length;h++)this.distanceOfTwoPoints(e[h].Pt,e[h].Nt)<.01||(i=this.distanceOfTwoPoints(e[h].Pt,r.Pt),n=this.distanceOfTwoPoints(e[h].Nt,r.Pt),i<.01?r.Pt=e[h].Nt:n<.01?r.Pt=e[h].Pt:i<n?.1<this.distanceOfTwoPoints(r.Pt,e[h].Pt)&&(s.push({Ct:r.Ct,Pt:r.Pt,Nt:e[h].Pt,tt:r.tt,Ft:r.Ft}),r.Pt=e[h].Nt):.1<this.distanceOfTwoPoints(r.Pt,e[h].Nt)&&(s.push({Ct:r.Ct,Pt:r.Pt,Nt:e[h].Nt,tt:r.tt,Ft:r.Ft}),r.Pt=e[h].Pt),e.splice(h,1));return.1<this.distanceOfTwoPoints(r.Pt,r.Nt)&&s.push(r),s},It:function(t){var i=[];if(1==t.length)return t;for(var n=t[0],e=1;0<t.length;){if(t.length<=e){if(i.push(n),t.splice(0,1),t.length<1)break;n=t[0],e=1}if(1===t.length){i.push(n);break}this.G(n.Pt,n.Nt,t[e].Pt)?(this.G(n.Pt,n.Nt,t[e].Nt)||(n.Nt=t[e].Nt),t.splice(e,1)):this.G(n.Pt,n.Nt,t[e].Nt)?(n.Pt=t[e].Pt,t.splice(e,1)):this.G(t[e].Pt,t[e].Nt,n.Pt)?(n=(this.G(t[e].Pt,t[e].Nt,n.Nt)||(t[e].Nt=n.Nt),t[e]),t.splice(e,1)):this.G(t[e].Pt,t[e].Nt,n.Nt)?(t[e].Pt=n.Pt,n=t[e],t.splice(e,1)):e++}return i},G:function(t,i,n){var e=t.x-n.x,r=t.y-n.y,s=i.x-n.x,h=i.y-n.y,o=this.distanceOfTwoPoints(t,n),n=this.distanceOfTwoPoints(i,n),t=this.distanceOfTwoPoints(t,i);return e*h-r*s<1e-5&&o+n-t<.001},Dt:function(t,i,n){var e=i.x-t.x,t=i.y-t.y,r=Math.sqrt(e*e+t*t);return{x:i.x+e/r*n,y:i.y+t/r*n}},Yt:function(t){for(var i=null,n=0,e=0,r=0,s=0;s<t.length;s++)(null===i||t[s].x>i)&&(i=t[s].x,n=s);var h=new d(t[n].x,t[n].y,0),e=0===n?t.length-1:n-1,r=n===t.length-1?0:n+1,e=new d(t[e].x,t[e].y,0),r=new d(t[r].x,t[r].y,0),e=(new d).copy(h).sub(e),r=(new d).copy(r).sub(h);return 0<e.cross(r).z}});var g=new t,_t={Drive:1,Walk:0},t={BROWSER:0,WX:1},St=(Object.freeze(t),{document:"undefined"!=typeof document?document:{},window:"undefined"!=typeof window?window:{},environment:t.BROWSER,XMLHttpRequest:"undefined"!=typeof XMLHttpRequest?XMLHttpRequest:{}}),t={RIGHT:2,LEFT:4,BOTTOM:8,TOP:16,RIGHT_BOTTOM:32,LEFT_BOTTOM:64,RIGHT_TOP:128,LEFT_TOP:256,CENTER:512},Ot=(Object.freeze(t),t),t={NONE:0,EXTRUDE_MARKER:2,FM3DTILE_LAYER:4,IMAGE_MARKER:8,LOCATION_MARKER:16,POLYGON_MARKER:32,TEXT_MARKER:64,LINE_MARKER:128,LINE3D_MARKER:256,HEAT_MAP_MARKER:512,EXTENT:1024,EXTERNAL_MODEL:2048,MODEL:4096,FACILITY:8192,LABEL:16384,DYNAMIC_MODEL_MARKER:32768,DOM_MARKER:65536,SPHERE_MARKER:1<<17,CAD_LAYER:1<<18,EXTENT_LAYER:1<<20,EXTERNAL_MODEL_LAYER:1<<21,MODEL_LAYER:1<<22,FACILITY_LAYER:1<<23,LABEL_LAYER:1<<24,MARKER_GROUP:1<<25,FLOW_LINE_LAYER:1<<27,FLOW_LINE_MARKER:1<<27,FIRE_MARKER:1<<28,WALL_MARKER:1<<29,TUBE_MARKER:1<<30},jt=(t.LAYER_NODE_TYPE=new Map,t.LAYER_NODE_TYPE.set(t.EXTENT_LAYER,t.EXTENT),t.LAYER_NODE_TYPE.set(t.EXTERNAL_MODEL_LAYER,t.EXTERNAL_MODEL),t.LAYER_NODE_TYPE.set(t.MODEL_LAYER,t.MODEL),t.LAYER_NODE_TYPE.set(t.FACILITY_LAYER,t.FACILITY),t.LAYER_NODE_TYPE.set(t.LABEL_LAYER,t.LABEL),t.LAYER_NODE_TYPE.set(t.DOM_MARKER,t.DOM_MARKER),t.LAYER_NODE_TYPE.set(t.DYNAMIC_MODEL_MARKER,t.DYNAMIC_MODEL_MARKER),t.LAYER_NODE_TYPE.set(t.EXTRUDE_MARKER,t.EXTRUDE_MARKER),t.LAYER_NODE_TYPE.set(t.HEAT_MAP_MARKER,t.HEAT_MAP_MARKER),t.LAYER_NODE_TYPE.set(t.LINE_MARKER,t.LINE_MARKER),t.LAYER_NODE_TYPE.set(t.LOCATION_MARKER,t.LOCATION_MARKER),t.LAYER_NODE_TYPE.set(t.POLYGON_MARKER,t.POLYGON_MARKER),t.LAYER_NODE_TYPE.set(t.TEXT_MARKER,t.TEXT_MARKER),t.LAYER_NODE_TYPE.set(t.IMAGE_MARKER,t.IMAGE_MARKER),t.LAYER_NODE_TYPE.set(t.FLOW_LINE_LAYER,t.FLOW_LINE_MARKER),t.LAYER_NODE_TYPE.set(t.FIRE_MARKER,t.FIRE_MARKER),t.LAYER_NODE_TYPE.set(t.WALL_MARKER,t.WALL_MARKER),t.LAYER_NODE_TYPE.set(t.TUBE_MARKER,t.TUBE_MARKER),t.LAYER_NODE_TYPE.set(t.LINE3D_MARKER,t.LINE3D_MARKER),t.LAYER_NODE_TYPE.set(t.SPHERE_MARKER,t.SPHERE_MARKER),t.LAYER_NODE_TYPE.set(t.CAD_LAYER,t.CAD_LAYER),t);function Et(i,t){var n,e=Object.keys(i);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(i),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})),e.push.apply(e,n)),e}function Tt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Et(Object(r),!0).forEach(function(t){var i,n;i=e,n=r[t=t],(t=Pt(t))in i?Object.defineProperty(i,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[t]=n}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Et(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function xt(t,i){var n,e,r,s,h="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(h)return r=!(e=!0),{s:function(){h=h.call(t)},n:function(){var t=h.next();return e=t.done,t},e:function(t){r=!0,n=t},f:function(){try{e||null==h.return||h.return()}finally{if(r)throw n}}};if(Array.isArray(t)||(h=Lt(t))||i&&t&&"number"==typeof t.length)return h&&(t=h),s=0,{s:i=function(){},n:function(){return s>=t.length?{done:!0}:{done:!1,value:t[s++]}},e:function(t){throw t},f:i};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function M(t){return(M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Rt(t){return(t=>{if(Array.isArray(t))return At(t)})(t)||(t=>{if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)})(t)||Lt(t)||(()=>{throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")})()}function Lt(t,i){var n;if(t)return"string"==typeof t?At(t,i):"Map"===(n="Object"===(n={}.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?At(t,i):void 0}function At(t,i){(null==i||i>t.length)&&(i=t.length);for(var n=0,e=Array(i);n<i;n++)e[n]=t[n];return e}function It(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,Pt(e.key),e)}}function Pt(t){t=((t,i)=>{if("object"!=M(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=M(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string");return"symbol"==M(t)?t:t+""}var t=(()=>{function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");this.Vt=t.type,this.stepLength=.7,this.Zt=180/Math.PI,this.Xt=[295829355.45,147914677.73,73957338.86,36978669.43,18489334.72,9244667.36,4622333.68,2311166.84,1155583.42,577791.71,288895.85,144447.93,72223.96,36111.98,18056,9028,4514,2257,1128,564,282,141,70,35,17,8,4,2,1],this.Bt=null,this.zt=null,this.Gt=5,this.Ht=!0,this.Ut=.2,this.qt=!1,this.Kt=!0,this.Qt=!1,this.Wt=1.2,this.$t=80,this.Jt=30,this.ti=21,this.ii=!0,this.ni=22,this.ei=1.3,this.ri=null,this.si="",this.hi=100,this.oi=3,this.ui=1,this.ai=6,this.fi=10,this.ci=5,this.li=0,this.vi=!1,this.yi=!1,this.di=0,this.bi=null,this.mi=!1,this.pi=!1,this.Mi=0,this.ki=0,this.wi=0,this.gi=0,this._i=null,this.Si=null,this.Oi=!1,this.ji=null,this.Ei=null,this.Ti=!1,this.xi=!1,this.Ri=null,this.Li=0,this.Ai=V.ZH,this.Ii=D.MODULE_SHORTEST,this.Pi=Y.PRIORITY_DEFAULT,this.Ni=!1,this.Ci=!1,this.Fi=!0,this.Di=[],this.Yi=!1,this.Vi=!1,this.Zi=10,this.Xi=new Map,this.Bi=!0,this.crossCircles,this.zi=h.Auto,this.Gi={radius:.5,dash:{size:4,gap:2}},this.Hi="#002FA7",this.Ui=!0,this.qi=0,this.Ki=new G,this.Qi=new B,this.Wi=(window&&"undefined"!==window.fengmap?window:getApp().globalData).fengmap,this.on=this.on.bind(this),this.$i(t),this.Ji()}return t=i,(n=[{key:"locationMarker",get:function(){return this.tn},set:function(t){this.tn=t}},{key:"lineFillMode",get:function(){return this.zi},set:function(t){this.zi=t}},{key:"naviResult",get:function(){return this.nn}},{key:"followPosition",get:function(){return this.Ht},set:function(t){this.Ht=t}},{key:"followAngle",get:function(){return this.qt},set:function(t){this.qt=t}},{key:"on",value:function(t,i){this.Qi.h(t,i)}},{key:"off",value:function(t,i){this.Qi.M(t,i)}},{key:"dispose",value:function(){this.stop(),this.Bt=null,this.zt&&(this.zt.dispose(),this.zt=null)}},{key:"setLanguage",value:function(t){this.Ai!=t&&(this.Ai=t,this.en())}},{key:"setObstructions",value:function(t){this.zt.setObstructions(t)}},{key:"setStartPoint",value:function(t,i){this.rn=Object.assign({},this.rn,t,{x:t.x,y:t.y,level:t.level,buildingID:t.buildingID,height:"number"==typeof t.height?t.height:this.ai});var n=null;return n=t.url&&!i?this.sn(this.rn,!0):n}},{key:"setDestPoint",value:function(t,i){this.hn=Object.assign({},this.hn,t,{x:t.x,y:t.y,level:t.level,buildingID:t.buildingID,height:"number"==typeof t.height?t.height:this.ai});var n=null;return n=t.url&&!i?this.sn(this.hn,!1):n}},{key:"route",value:function(t,i,n){this.Ci=t.fromDoor,this.Ni=t.toDoors,this.$i(t),this.un(),this.an({mode:t.mode,priority:t.priority,fromDoor:t.fromDoor,toDoors:t.toDoors,obstruct:this.Fi,viapoints:t.viapoints,barrierFree:t.barrierFree,turnCost:t.turnCost},i,n)}},{key:"naviConstraint",value:function(t,i){if(this.rn&&this.hn){null==this.fn&&this.cn(),t.buildingID=void 0!==t.buildingID?t.buildingID:null;var n={},e=[],r=Number.MAX_VALUE,s=0,h={index:-1,coords:{level:t.level,buildingID:t.buildingID},angle:null,distance:Number.MAX_VALUE,distanceToNext:Number.MAX_VALUE,remain:this.ln,relDirection:1,time:null,dots:[],insertIndex:-1,toNext:null,buildingIndex:-1};this.vn&&this.vn.coords.buildingID!==t.buildingID&&(this.vn.insertIndex=-1);for(var o=0;o<this.fn.length;o++){if(this.fn[o].bid!==t.buildingID);else for(var u=this.fn[o].naviPoints,a=1;a<u.length;a++){var f,c,l=u[a-1],v=u[a],y=l.index-s;this.vn&&this.vn.index>l.index||(y=this.yn[o].result.naviDescriptionsData[y].endPoint,l.level===t.level&&v.level===t.level&&(f=g.et(t,l,v,n))<r&&(1===a||null===this.vn||this.vn&&this.vn.coords.buildingID===t.buildingID&&this.vn&&this.vn.insertIndex<=a)&&(i&&i!==l.index||(null!=this.dn&&(c=(t.x-this.dn.x)*(v.x-l.x)+(t.y-this.dn.y)*(v.y-l.y),0===Math.abs(c)&&null!=this.vn?h.relDirection=this.vn.relDirection:c<0&&(h.relDirection=-1)),h.distance=f,Object.assign(h.coords,n),h.angle=this.bn(l,v),h.index=l.index,h.distanceToNext=g.tt(n,y),h.insertIndex=a,h.toNext=g.tt(n,v),h.buildingIndex=o,this.mn(h),e.push(Object.assign({},h)),r=f)))}s+=this.yn[o].result.naviDescriptionsData.length}var d=h;if(this.vn)for(var b=e.length-2;0<=b;b--)e[b].remain>=d.remain&&e[b].remain<this.vn.remain&&(e[b].distance<=d.distance||Math.abs(4<=d.insertIndex-this.vn.insertIndex)&&d.buildingIndex==this.vn.buildingIndex)&&(d=e[b]);return d.time=t.time,this.dn=t,d.remain<.5?this.vn=null:this.vn=d,d}}},{key:"pathConstraint",value:function(t,i){return this.zt?this.zt.pathConstraint(t,i):null}},{key:"locate",value:function(t,i){this.yi&&this.stop(),this.pn(t,i),this.dn=t}},{key:"locateNoConstraint",value:function(t,i){this.yi&&this.stop(),this.Mn(t,i),this.dn=t}},{key:"clearLocationMarker",value:function(){this.tn&&(this.tn.remove(),this.tn=null)}},{key:"clearMarkers",value:function(){this.kn&&(this.kn.remove(),this.kn=null,this.rn=null),this.wn&&(this.wn.remove(),this.wn=null,this.hn=null)}},{key:"drawNaviLine",value:function(t){if(this.rn&&this.hn)return this.gn=this._n(this.Sn,t),this.gn}},{key:"clearNaviLine",value:function(){this.gn&&(this.gn.remove(),this.gn=null)}},{key:"clearAll",value:function(){this.clearMarkers(),this.clearNaviLine(),this.clearLocationMarker()}},{key:"overview",value:function(t,i){var n=this;if(0!==this.Sn.length){for(var e=new J,r={},s=0;s<this.Sn.length;s++)(()=>{var t=null===n.Sn[s].bid?"null":n.Sn[s].bid,i=[Number.MAX_VALUE,-Number.MAX_VALUE];t in r&&(i=r[t]),n.Sn[s].resultbuild.forEach(function(t){i[0]=Math.min(i[0],t.level),i[1]=Math.max(i[1],t.level),e.A(t.pointList)}),r[t]=i})();this.On(t,e,r,i)}}},{key:"focusNaviLineSegment",value:function(t,i,n){if(0!=this.yn.length){for(var e,r,s,h=null,o=null,u=0;u<this.yn.length;u++){var a=this.yn[u].result.naviDescriptionsData;if(t-a.length<0){h=a[t],o=this.yn[u].bid;break}t-=a.length}o&&h&&((e=new J).A([h.startPoint,h.endPoint]),(r={})[o]=[Math.min(h.startLevel,h.endLevel),Math.max(h.startLevel,h.endLevel)],s=this.Bt.getBuilding(o),this.On(i,e,r,s,n))}}},{key:"simulate",value:function(t){var i,n,e=this;this.rn&&this.hn&&0!==this.Sn.length&&(this.yi&&this.stop(),this.yi=!0,this.$i(t),i={},this.Oi=!1,this.ji=this.Bt.getRotation(),n=i.Wt||this.Wt,i.ti=i.ti||this.ti||0,this.jn(),this.tn.rotateTo({heading:-this.ji}),this.Ht?this.En(this.rn.level,this.rn.buildingID,n,function(){e.yi&&e.Tn(e.rn,n,function(){var t;e.yi&&(t=i.ti>e.ni?e.ni:i.ti,e.ii?e.xn(e.$t,n,function(){e.yi&&e.Rn(t,n,function(){e.yi&&e.Ln()})}):e.Rn(t,n,function(){e.yi&&e.Ln()}))})}):this.yi&&this.Ln())}},{key:"pause",value:function(){this.pi=!0}},{key:"resume",value:function(){this.pi=!1}},{key:"stop",value:function(){this.vi=!0,this.Ki.stop(),this.An&&this.Bt.off("update",this.An),this.pi=!1,this.Si=null,this.Ei=null,this.wi=0,this.Oi=!1,this.Ri=null,this.Li=0,this.Ti=!1,this.xi=!1,this.An=null,this.yi=!1,this.mi=!1,this.Mi=0,this.ki=0,this._i=null,this.vn=null,0!==this.di&&(this.di=2,null!==this.bi)&&(this.Bt.getMapOptions().screenLockCoords=void 0,this.Bt.getInteracations().controls.isScreenLock=!1)}},{key:"getSpeed",value:function(){return this.Gt}},{key:"setSpeed",value:function(t){this.Gt=t}},{key:"addZoomCircle",value:function(t){if(0!=t.length){var i,n=null==t[0].buildingID?null:t[0].buildingID;this.Xi.has(n)?i=this.Xi.get(n):(i=new Map,this.Xi.set(n,i));for(var e,r=0;r<t.length;r++)i.has(t[r].level)||i.set(t[r].level,[]),(e=i.get(t[r].level)).push.apply(e,Rt(t[r].circle))}}},{key:"stopZoomCircle",value:function(){this.Bi=!1}},{key:"constraintTrack",value:function(t){return this.zt.constraintTrack(t)}},{key:"setLineFillMode",value:function(t){this.zi=t}},{key:"setPassedLineDistance",value:function(t){this.gn&&this.zi==h.SpecifiedDistance&&this.gn.moveProportion(t/this.ln)}},{key:"real",value:function(t,i){var n,e,r=this;this.rn&&this.hn&&(this.$i(t),this.ji=this.Bt.getRotation(),e=(n={}).Wt||this.Wt,n.ti=n.ti||this.ti||0,this.jn(),this.tn.rotateTo({heading:-this.ji}),this.di=1,null!==this.bi&&this.Ht&&(this.Bt.getMapOptions().screenLockCoords=this.bi,this.Bt.getInteracations().controls.isScreenLock=!0),this.En(this.rn.level,this.rn.buildingID,e,function(){r.Tn(r.rn,e,function(){var t=n.ti>r.ni?r.ni:n.ti;r.ii?r.xn(r.$t,e,function(){r.Rn(t,e,function(){i&&i()})}):r.Rn(t,e,function(){i&&i()})})}))}}])&&It(t.prototype,n),e&&It(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e})(),Nt=(Object.assign(t.prototype,{$i:function(t){t&&(void 0!==t.map&&(this.Bt=t.map),void 0!==t.analyser&&(this.zt=t.analyser),void 0!==t.speed&&(this.Gt=t.speed),void 0!==t.followSpeed&&(this.Ut=t.followSpeed),void 0!==t.followPosition&&(this.Ht=t.followPosition),void 0!==t.followAngle&&(this.qt=t.followAngle),void 0!==t.locationMarkerFollowAngle&&(this.Kt=t.locationMarkerFollowAngle),void 0!==t.isMultiLevels&&(this.Qt=t.isMultiLevels),void 0!==t.inTime&&(this.Wt=t.inTime),void 0!==t.tiltAngle&&(this.$t=t.tiltAngle),void 0!==t.changeFloorTiltAngle&&(this.Jt=t.changeFloorTiltAngle),void 0!==t.changeTiltAngle&&(this.ii=t.changeTiltAngle),void 0!==t.zoom&&(this.ti=t.zoom),void 0!==t.maxZoom&&(this.ni=t.maxZoom),void 0!==t.extendScale&&(this.ei=t.extendScale),void 0!==t.locationMarker&&(this.ri=t.locationMarker),void 0!==t.locationMarkerUrl&&(this.si=t.locationMarkerUrl),void 0!==t.locationMarkerSize&&(this.hi=t.locationMarkerSize),void 0!==t.locationMarkerHeight&&(this.oi=t.locationMarkerHeight),void 0!==t.lineMarkerHeight&&(this.ui=t.lineMarkerHeight),void 0!==t.imageMarkerHeight&&(this.ai=t.imageMarkerHeight),void 0!==t.directionAssert&&(this.fi=t.directionAssert),void 0!==t.combineAsset&&(this.ci=t.combineAsset),void 0!==t.completeDistance&&(this.li=t.completeDistance),void 0!==t.Ai&&(this.fi=t.directionAssert),void 0!==t.mode&&(this.Ii=t.mode),void 0!==t.priority&&(this.Pi=t.priority),void 0!==t.toDoors&&(this.Ni=t.toDoors),void 0!==t.fromDoor&&(this.Ci=t.fromDoor),void 0!==t.obstruct&&(this.Fi=t.obstruct),void 0!==t.viapoints&&(this.Di=t.viapoints),void 0!==t.barrierFree&&(this.Yi=t.barrierFree),void 0!==t.lineStyle&&Object.assign(this.Gi,t.lineStyle),void 0!==t.linePassed&&(this.Ui=t.linePassed),void 0!==t.lineFillMode&&(this.zi=t.lineFillMode),void 0!==t.maxOffsetDis&&(this.Zi=t.maxOffsetDis),void 0!==t.screenPosition)&&(this.bi=t.screenPosition)},Ji:function(){1===this.Vt?this.In=void 0!==this.Wi.FMNaviDriveAnalyser&&this.zt instanceof this.Wi.FMNaviDriveAnalyser:this.In=void 0!==this.Wi.FMNaviAnalyser&&(this.zt instanceof this.Wi.FMNaviAnalyser||this.zt instanceof this.Wi.FMNaviWalkAnalyser),this.rn=null,this.hn=null,this.kn=null,this.wn=null,this.tn=null,this.An=null,this.un()},Pn:function(t){t=(this.Bt.getBuilding(t.buildingID)||this.Bt).getFloor(t.level);this.tn.addTo(t)},jn:function(){var t,i=this.rn;this.Ci&&0<(null==(t=this.fn)?void 0:t.length)&&this.fn[0].naviPoints&&0<this.fn[0].naviPoints.length&&(t=this.fn[0].naviPoints[0],i.x=t.x,i.y=t.y),!this.tn&&this.ri?this.tn=this.ri:this.tn||this.ri||(this.tn=new this.Wi.FMLocationMarker({id:"location",buildingID:this.rn.buildingID,level:i.level,x:i.x,y:i.y,url:this.si||"",size:this.hi,height:this.oi})),this.tn instanceof this.Wi.FMLocationMarker?this.tn.addTo(this.Bt):this.tn.type==jt.DYNAMIC_MODEL_MARKER&&this.Pn(i),this.tn.moveTo({buildingID:i.buildingID,level:i.level,x:i.x,y:i.y})},Nn:function(t){for(var i,n=arguments.length<=1?0:arguments.length-1,e=0;e<n;e++){var r=e+1<1||arguments.length<=e+1?void 0:arguments[e+1];if(t[r])return t[r]}return(i=(arguments.length<=1?0:arguments.length-1)-1+1)<1||arguments.length<=i?void 0:arguments[i]},Cn:function(t){if(this.rn&&this.hn)return t==this.rn.level||t==this._detData.level},un:function(){this.nn=null,this.Fn=[],this.Dn=[],this.Sn=[],this.Yn=[],this.yn=[],this.fn=[],this.Vn=[],this.Zn=[],this.ln=0,this.Xn=[],this.vn=null,this.dn=null},sn:function(t,i){if(t.level){var n=t.url||(i?"image/small/marker/nav_location_start.png":"image/small/marker/nav_location_dest.png"),e=i?this.kn:this.wn,r=(e&&e.remove(),(null!=t.buildingID?this.Bt.getBuilding(t.buildingID):this.Bt).getFloor(t.level));if(r)return(e=new this.Wi.FMImageMarker(Object.assign({map:this.Bt,url:n,callback:function(){t.callback&&t.callback(e)},anchor:Ot.BOTTOM,depth:!1,collision:!1},t))).addTo(r),i?this.kn=e:this.wn=e,e}},an:function(t,i,n){var e=this;this.rn&&this.hn&&(t=Object.assign({start:Object.assign({},this.rn),dest:Object.assign({},this.hn)},t),this.Bn(t,function(t){e.nn=t,e.zn(),e.crossCircles=e.Gn(e.Sn,e.Xi),e.Hn(),e.Un(),e.qn(),e.cn(),i&&i(t)},function(t){n&&n(t)}))},zn:function(){if(this.nn&&this.nn.subs&&0!=this.nn.subs.length){for(var t=this.nn.subs[0].buildingID,i=[],n=[],e=[],r=0;r<this.nn.subs.length;r++){var s=this.nn.subs[r];s.buildingID!==t&&(e.push({bid:t,result:i}),i=[],t=s.buildingID),i.push(s),r==this.nn.subs.length-1&&e.push({bid:t,result:i})}for(var h=0;h<e.length;h++){var o=this.Kn(e[h].result);n.push({bid:e[h].bid,resultbuild:o})}this.Fn=e,this.Sn=n}},Kn:function(t){for(var i=[],n=Number.NaN,e=null,r=0;r<t.length;r++){var s,h=t[r];n!=h.levels[0]&&((e={length:0,level:h.levels[0],pointList:[]}).pointList.push(h.waypoint.points[0]),i.push(e),n=h.levels[0]),h.levels[0]==h.levels[1]?((s=e.pointList).push.apply(s,Rt(h.waypoint.points.slice(1))),e.length+=h.distance):(e={length:0,level:h.levels[0],pointList:[h.waypoint.points[0]]},i.push(e),e={length:0,level:h.levels[1],pointList:[h.waypoint.points[1]]},i.push(e))}return i},Hn:function(){for(var t=0;t<this.Sn.length;t++){var i=this.Sn[t].resultbuild;this.Qn(i)}},Qn:function(t){for(var i=0;i<t.length-1;i++){var n,e,r=t[i];r.length&&(n=r.pointList[r.pointList.length-1],e=t[i+1].pointList[0],.2<g.tt(n,e))&&r.pointList.push(Object.assign({},e))}},Un:function(){for(var t=0;t<this.Sn.length;t++){var i=this.Sn[t].resultbuild,i=this.Wn(i);this.Yn.push({bid:this.Sn[t].bid,groupsPoints:i})}},Wn:function(t){for(var i=[],n=null,e=null,r=0;r<t.length;r++){var s=t[r],h=n==s.level;0==s.length&&0!=r&&r!=t.length-1||(h||(n=s.level,e&&i.push(e),e={level:s.level,pointList:[]}),e.pointList=e.pointList.concat(s.pointList))}return e&&i.push(e),i},qn:function(){if(this.nn)for(var t=0;t<this.Fn.length;t++){var i=this.Fn[t].bid,n=this.Fn[t].result,n=this.en(n);this.yn.push({bid:i,result:n}),this.ln+=n.naviDistance}},en:function(t){if(t){for(var i=[],n=[],e=[],r=0,s=this.Ai,h=t,o=0,u=null,a=0;a<h.length;a++){var f=h[a],c=f.waypoint.points,l=f.waypoint.direction[s],l=(i.push(f.instruction[s]),{startDirection:l[0],startIndex:void 0,startLevel:f.levels[0],startPoint:c[0],endDirection:l[1],endIndex:void 0,endLevel:f.levels[1],endPoint:c.slice(-1)[0],distance:f.distance});f.levels[0]==f.levels[1]?(l.startIndex=o,o+=c.length-1,l.endIndex=o):o=0,n.push(l),null!=u&&f.levels[0]==f.levels[1]||(u={level:f.levels[1],distance:0},e.push(u)),u.distance+=f.distance,r+=f.distance}return{naviDescriptions:i,naviDescriptionsData:n,naviFloorsDistance:e,naviDistance:r}}},cn:function(){if(this.Fn){for(var t=0,i=[],n=0;n<this.Fn.length;n++){for(var e=this.Fn[n].result,r=this.Fn[n].bid,s=this.$n(e),h=this.Jn(e),o=0;o<s.length;o++)s[o].index+=t;for(var u=0;u<h.length;u++)h[u].index+=t;var a=this.yn[n].result.naviDistance;t+=e.length,i.push({bid:r,distance:a,naviPoints:s,naviSubPoints:h})}this.fn=i}},$n:function(t){if(!t)return[];for(var i=[],n=t,e=0;e<n.length;e++){var r=n[e];if(r.levels[0]==r.levels[1])for(var s=e+1==n.length?null:n[e+1],h=r.waypoint.points,o=null==s||s.levels[0]!=s.levels[1]?h.length:h.length-1,u=0;u<o;u++){var a={x:h[u].x,y:h[u].y,z:0,level:r.levels[0],index:e};i.push(a)}}return i},Jn:function(t){if(!t)return[];for(var i=[],n=t,e=0;e<n.length;e++){var r=n[e].waypoint.points,s={x:r[0].x,y:r[0].y,level:r[0].level,index:e};i.push(s),e==n.length-1&&(s={x:r.slice(-1)[0].x,y:r.slice(-1)[0].y,level:r.slice(-1)[0].level,index:n.length},i.push(s))}return i},te:function(t,i){var n=null;if(0!=t.length){for(var e=[],r=0;r<t.length;)t[r].distance==i&&e.push(t[r]),r+=1;if(1<e.length){for(var s=0;s<e.length;s++)if(0<=e[s].relDirection){n=e[s];break}n=n||e[0]}else 1==e.length&&(n=e[0])}return n},mn:function(t){if(-1!=t.buildingIndex&&-1!==t.insertIndex){for(var i,n,e=t.buildingIndex,r=this.fn[e].naviPoints,s=0,h=r.length-1;h>t.insertIndex;h--)t.insertIndex<=h-1&&(i=r[h],n=r[h-1],i.level===n.level)&&(s+=g.tt(i,n));r[t.insertIndex]&&r[t.insertIndex].level===t.coords.level&&(s+=g.tt(r[t.insertIndex],t.coords));for(var o=e+1;o<this.fn.length;o++)s+=this.fn[o].distance;t.remain=s}},_n:function(t,i){var r=this;if(0===t.length)return null;1!==this.Vt||this.Gi.hasOwnProperty("color")||(this.Gi.color=this.Hi);for(var n=Object.assign({},this.Gi),s=(i&&i.style&&Object.assign(n,i.style),i&&i.height?i.height:this.ui),h=[],e=0;e<t.length;e++)for(var o=t[e].bid,u=t[e].resultbuild,a=0;a<u.length;a++)(()=>{var t=(i=u[a]).pointList;if(0===t.length)return;var i=i.level,n=[],e=(t.forEach(function(t){var i=parseFloat(""+t.x),t=parseFloat(""+t.y);n.push({x:i,y:t,z:s})}),t.length<2&&(e=parseFloat(""+t[0].x),t=parseFloat(""+t[0].y),n.push({x:e,y:t,z:s})),new r.Wi.FMSegment);e.level=i,e.points=n,e.buildingID=o,h.push(e)})();n=new this.Wi.FMLineMarker(Object.assign({segments:h},n));return n.passed=i&&null!=i.passed?i.passed:this.Ui,n.addTo(this.Bt),n},Bn:function(t,i,n){this.zt.route(t,function(t){i&&i(t)},function(t){n&&n(t)})},Tn:function(t,i,n){this.Bt.setCenter({x:t.x,y:t.y,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:n})},xn:function(t,i,n){this.Bt.setTilt({tilt:t,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:n})},ie:function(t,i,n){this.Bt.setRotation({rotation:t,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:n})},Rn:function(t,i,n){this.Bt.setZoom({zoom:t,animate:"number"==typeof i,duration:"number"==typeof i?i:0,finish:n},!0)},En:function(t,i,n,e){var r,s=null==i||void 0===i?((r=this.Bt).setVisibleLevels([t]),r.getLevel()):((r=this.Bt.getBuilding(i)).setVisibleLevels([t]),r.level);null!=i?this.Bt.setLevel({level:r.levelChart[0],finish:function(){s==t?e&&e():r.setLevel({level:t,animate:"number"==typeof n,duration:"number"==typeof n?n:0,finish:e})}}):r.setLevel({level:t,animate:"number"==typeof n,duration:"number"==typeof n?n:0,finish:e})},ne:function(t){var i=this.Dn;if(0===i.length)return[];for(var n=[],e=0,r=0;r<i.length;r++){var s=i[r];if(!(s.pointList.length<=1))for(var h=s.level,o=0;o<s.pointList.length;o++){for(var u=s.pointList[o],u=new c(u.x,0,u.y),a=(u.level=h,-1),f=1;f<t.length;f++)if(e<t[f].ee){a=t[f-1].re;break}u.re=-1!==a?a:t[t.length-1].re,n.push(u),e++}}return n},se:function(t,i){if(0===i)return t[0];for(var n,e,r=0,s=0,h=t[0],o=1;o<t.length;o++)if((n=t[o]).bid!==h.bid)h=n;else if(n.level!==h.level)h=n;else{if(i<=(r+=(e=n.clone().sub(h)).length()))return e.normalize(),(e=h.clone().add(e.clone().multiplyScalar(i-s))).level=n.level,e.index=n.re!=h.index?h.index:n.re,e.bid=(n.bid!=h.bid?h:n).bid,e;(h=n.clone()).level=n.level,h.index=n.re,h.bid=n.bid,s=r}var u=t[t.length-1];return u.index=u.re,u.bid=u.bid,u},he:function(t){var e,r,s,i,n;return t&&0!==t.length?(r=0,s=e=-1,t=t.map(function(t,i){var n=new c(t.startPoint.x,0,t.startPoint.y);return n.level=t.startLevel,e=n.re=i,t.startLevel!==t.endLevel?(r+=s,n.ee=r,r++):n.ee=t.startIndex+r,s=t.endIndex,n}),i=this._naviDescriptionsData[this._naviDescriptionsData.length-1],(n=new c(i.endPoint.x,0,i.endPoint.y)).level=i.endLevel,n.re=e+1,n.ee=i.endIndex+r,t.push(n),t):[]},oe:function(t){var i,n,e,r=this;this.tn&&(this.xi?(i={x:t.x,y:t.y,height:this.tn.height,level:t.level,buildingID:t.bid},this.tn.moveTo(i),this.xi=!1):(n=(i={}).Wt||this.Wt,i.ti=i.ti||this.ti||0,e=i.ti>this.ni?this.ni:i.ti,this.Qt||(this.ue(t),this.tn.visible=!0),this.ii&&this.xn(this.$t,n,null),this.Tn(t,n,function(){r.Rn(e,n,function(){r.Ti=!1})})))},ae:function(t){this.tn&&(this.ue(t),this.xi=!1)},bn:function(t,i){var n=new c(0,0,1),t=new c(t.x,0,t.y),i=new c(i.x,0,i.y).clone().sub(t).normalize(),t=i.angleTo(n)*g.D();return 0<i.clone().cross(n).y?360-t:t},fe:function(t,i,n){return t===i?t:(180<Math.abs(i-t)&&(t<i?t+=360:i+=360),(t*(1-n)+i*n)%360)},ce:function(t,i){var n=this.Xt,e=Math.floor(t),r=n[e-1]*(1-t%1)+n[e]*(t%1);for(r*=i,e=0;r<n[e];)e++;return e+1-(r-n[e])/(n[e-1]-n[e])},le:function(t){var i,n,e;this.vi||St.window.requestAnimationFrame(this.le.bind(this,t)),this.mi||(t.cnt++,t.cnt!==t.step)||(t.cnt=0,i=this.Ki.getDelta(),this.xi)||this.Ti||this.pi||(this.wi+=this.Gt*i,this.wi<=0)||this.Gt*i==0||(i=Object.assign({},this.se(t.ps,this.wi)),e=this.ln-this.wi,n=i.y,i.y=i.z,i.z=n,this._i={distance:0,remain:e<this.gi?this.gi:e,walk:this.wi,point:i,level:i.level,buildingID:i.bid,index:i.index-1},null!=this.Si&&(this.Ei=this.bn(this.Si,i)),this.Si=Object.assign({},i),!i||e<this.gi&&this.Oi?this.mi=!0:(e<this.gi&&!this.Oi&&(this.Oi=!0),this.Li||(this.Li=t.ps[0].level),null==this.Ri&&(this.Ri=t.ps[0].bid||"outdoor"),this.yi&&(n=i.bid||"outdoor",this.Ri!==n?(this.xi=!0,this.Ri=n,this.Mi++,this.ki=0,this.Li=i.level,this.ve(1,i),this.Qi.k({type:"transit",level:i.level,buildingID:i.bid})):(this.Li!==i.level&&(this.Li=i.level,this.ki++,this.ve(0,i),this.Qi.k({type:"transit",level:i.level,buildingID:i.bid})),this.Ht&&this.Bt.focusBuilding&&this.Bt.focusBuilding.buildingID==i.bid&&this.Bt.focusBuilding.level!==i.level&&(this.Li=this._i.level,e={x:this.tn.x,y:this.tn.y,z:0,level:i.level,bid:i.bid,index:i.index},this.ki++,this.ve(0,e),this.Qi.k({type:"transit",level:e.level,buildingID:e.bid}))))))},ve:function(t,i){var n=this;if(this.Ht){var e={},r=e.Wt||this.Wt,s=(e.ti=e.ti||this.ti||0,e.ti>this.ni?this.ni:e.ti);if(1===t)return this.ye(i.level,i.bid,function(){n.En(i.level,i.bid,r,function(){n.oe(i)})});this.Ti=!0,this.ii&&this.xn(this.Jt,r,null),this.Qt||(this.tn.visible=!1),this.ye(i.level,i.bid,function(){n.En(i.level,i.bid,r,function(){n.Rn(s,r,function(){n.Tn(i,r,function(){n.ii?n.xn(n.$t,r,function(){n.oe(i)}):n.oe(i)})})})})}else if(1===t)return this.ye(i.level,i.bid,function(){n.oe(i)})},de:function(){this.vi=!1;for(var t=[],i=0;i<this.fn.length;i++){for(var n=this.fn[i].naviPoints,e=[],r=0;r<n.length;r++){var s=new c(n[r].x,0,n[r].y);s.re=n[r].index,s.level=n[r].level,s.bid=this.fn[i].bid,e.push(s)}t.push.apply(t,e)}this.Ki.start(),this.mi=!1,this.Mi=0,this.ki=0,this.le({step:2,cnt:0,ps:t})},be:function(){if(!(this.Ti||this.xi||this.pi)){if(this.Si){var t,i,n=new c(this.tn.x,this.tn.y,0).lerp(this.Si,this.Oi?1:this.Ut),e=(n.level=this.Si.level,n.buildingID=this.Si.bid,this.naviConstraint(n,this.Si.index));if(e.index<0)return;if(this.tn.moveTo({x:n.x,y:n.y,height:this.oi,level:n.level,buildingID:n.buildingID}),this.gn&&(this.gn.passed?this.gn.moveProportion(1-e.remain/this.ln):this.gn.moveProportion(0)),this.Bi)for(var r=0;r<this.crossCircles.length;r++)e.coords.buildingID==this.crossCircles[r].bid&&e.coords.level==this.crossCircles[r].level&&e.remain<=this.crossCircles[r].point.remain&&e.remain>=this.crossCircles[r].remain&&(t=!0,i=this.crossCircles[r].point);if(this.Qi.k(Object.assign({},this._i,this.me(e,t,i))),t=!1,i=null,this.Ht?this.Tn(n):this.Bt.updateCountDown_=0,this.mi)return this.stop(),void this.Qi.k({type:"complete"})}null!=this.Ei&&(n=this.fe(this.ji,this.Ei,this.Ut),this.ji=n,this.tn.rotateTo({heading:-n}),this.qt)&&this.ie(n)}},Ln:function(){this.de(),this.An=this.be.bind(this),this.Bt.on("update",this.An)},pn:function(t,i){if(2!==this.di){this.vn=null;var n,e,r=this.naviConstraint(t);if(this.zi==h.Auto&&this.gn&&(this.gn.passed?this.gn.moveProportion(1-r.remain/this.ln):this.gn.moveProportion(0)),this.Bi)for(var s=0;s<this.crossCircles.length;s++)r.coords.buildingID==this.crossCircles[s].bid&&r.coords.leve==this.crossCircles[s].level&&r.remain<=this.crossCircles[s].point.remain&&r.remain>=this.crossCircles[s].remain&&(n=!0,e=this.crossCircles[s].point);this.Qi.k(this.me(r,n,e)),n=!1,e=null,1===this.di?(r.userAngle=i,this.pe(r,n,e)):this.tn&&(r.coords.height=this.oi,this.tn.moveTo(r.coords),void 0!==i?this.tn.rotateTo({heading:i}):this.tn.rotateTo({heading:-r.angle}))}},Mn:function(t,i){if(2!==this.di){var n,e,r=this.naviConstraint(t);if(r.noConstraintCoord=t,this.Bi)for(var s=0;s<this.crossCircles.length;s++)r.coords.buildingID==this.crossCircles[s].bid&&r.coords.leve==this.crossCircles[s].level&&r.remain<=this.crossCircles[s].point.remain&&r.remain>=this.crossCircles[s].remain&&(n=!0,e=this.crossCircles[s].point);this.Qi.k(this.me(r,n,e)),n=!1,e=null,1===this.di?(r.userAngle=i,this.pe(r,n,e)):this.tn&&(t.height=this.oi,this.tn.moveTo(t),void 0!==i?this.tn.rotateTo({heading:i}):this.tn.rotateTo({heading:-r.angle}))}},Me:function(t,i){var n,e=[{x:t.min.x,y:t.min.y},{x:t.min.x,y:t.max.y},{x:t.max.x,y:t.max.y},{x:t.max.x,y:t.min.y}],r=new J;for(n in i)for(var s=i[n],h=0;h<s.length;h++)for(var o=0,o=h===s.length-1?this.ui+2*this.Gi.radius:this.ui,u=0;u<e.length;u++){var a=this.Wi.FMUtil.coordsMapToScreen(this.Bt,{x:e[u].x,y:e[u].y,buildingID:"null"===n?null:n,level:s[h],height:o});a&&r.A([a])}return r},ke:function(t,i){var t=this.Me(t,i).size,i=this.Bt.getContainer().clientHeight,n=this.Bt.getContainer().clientWidth;return n/i>t.x/t.y?t.y/i:t.x/n},we:function(t,i,n,e,r,s){var h=this,o=this.ke(t,i),u=this.Bt.getZoom();o?(u=this.ce(this.Bt.getZoom(),o*(n||1)),r=e-1):u-=1,this.Bt.setZoom({zoom:u,animate:!1,finish:function(){++r===e?s&&s({zoom:u}):h.we(t,i,n,e,r,s)}})},ge:function(t,i){var n,e=this.Me(t,i),r=[];for(n in i)for(var s=i[n],h=("null"===n?null:n)||this.Bt.getMapOptions().buildingID,o=0;o<s.length;o++){var u=this.Bt.getBuilding(h).getFloor(s[o]).height;r.push(this.Wi.FMUtil.coordsScreenToMap(this.Bt,{x:(e.max.x+e.min.x)/2,y:(e.max.y+e.min.y)/2,z:u+2*this.Gi.radius}))}for(var a=new c,f=0;f<r.length;f++)a.add(r[f]);return a.divideScalar(r.length),a},_e:function(n,e,r,s,h,o){var u=this;this.we(n,e,r,10,0,function(t){var i=u.ge(n,e);u.Bt.setCenter({animate:!1,x:i.x,y:i.y,finish:function(){++h===s?o&&o({zoom:t.zoom,center:i}):u._e(n,e,r,s,h,o)}})})},On:function(t,s,h,o){var i,u=this,a=t&&void 0!==t.ratio?t.ratio:1,n=t&&void 0!==t.rotation?t.rotation:0,e=t&&void 0!==t.tilt?t.tilt:30,f=!t||void 0===t.animate||t.animate,r=1,c=[1];for(i in h){for(var l=h[i],v=[],y=l[0];y<=l[1];)v.push(y),y++;"null"===i?r=(c=v)[Math.floor(v.length/2)]:this.Bt.getBuilding(i).setVisibleLevels(v)}this.Bt.setVisibleLevels(c,function(){u.Bt.setLevel({level:r,animate:f,finish:function(){var t=c.length%2==0?u.Bt.getFloorSpace()/2:0;u.Bt.getInteracations().controls.panAdd({x:0,y:t,z:0}),u.Bt.setCenter({animate:f,x:s.center.x,y:s.center.y,finish:function(){u.Bt.setTilt({tilt:e,animate:f,finish:function(){u.Bt.setRotation({rotation:n,animate:f,finish:function(){var i=u.Bt.getInteracations(),t=u.Bt.copyCamera(),n=i.copyControls(t),e=i.controls,r=u.Bt.camera;i.controls=n,u.Bt.camera=t,u.Bt.getInteracations().controls.update(),u._e(s,h,a,10,0,function(t){i.controls=e,u.Bt.camera=r,n.dispose(),n=null,u.Bt.enableUpdateRender(),u.Bt.setZoom({animate:f,zoom:t.zoom,duration:.5}),u.Bt.setCenter({animate:f,x:t.center.x,y:t.center.y,duration:.5,finish:function(){o&&o()}})})}})}})}})}})})},ye:function(t,i,n){if(null==t||null==i)return n&&n(),null;for(var e=this.Bt.getBuilding(i).levelChart,r=this.Bt.getVisibleLevels(),s=null,h=0;h<e.length;h++)if(h%2==1&&e[h]===t&&(s=e[h-1],r.indexOf(s)<0)){this.Bt.setVisibleLevels([s]);break}return null==s||this.Bt.getLevel()===s?(n&&n(),null):this.Bt.setLevel({level:s,animate:"number"==typeof duration,duration:"number"==typeof duration?duration:0,finish:n})},Gn:function(t,i){if(!i)return[];for(var n=0,e=0,r=[],s=0;s<t.length;s++)for(var h=t[s].resultbuild,o=0;o<h.length;o++)e+=h[o].length;for(var u=0;u<t.length;u++)for(var a=t[u].bid,f=t[u].resultbuild,c=0;c<f.length;c++){var l=f[c].level,v=f[c].pointList;if(0<c&&(n+=f[c-1].length),!(v.length<=1)&&(i.has(a)&&i.get(a).has(l)))for(var y=0,d=i.get(a).get(l),b=0;b<v.length;b++){0<b&&(y+=g.distance(v[b-1],v[b]));var m,p=xt(d);try{for(p.s();!(m=p.n()).done;){var M,k=m.value,w=this.Se(v,k,b);w&&(w.remain=0==b?e-(n+y):e-(n+y-w.disIntersectToPoint),M=e-(n+y-w.disCenterToPoint),r.push({center:k.center,radius:k.radius,remain:M,point:w,level:l,bid:a}))}}catch(t){p.e(t)}finally{p.f()}}}return r},Se:function(t,i,n){var e=0;if(0==n)return g.it(t[n],i.center)<=.001?Object.assign({disIntersectToCenter:disIntersectToCenter,disIntersectToPoint:e},t[n]):null;if(!(g.it(i.center,t[n-1])<=.001)&&g.nt(i.center,t[n-1],t[n])<=.001){var r,s=xt(i.points);try{for(s.s();!(r=s.n()).done;){var h=r.value;if(!g.W(h,i.center,t[n]))for(var o=n;0<o;o--)if(g.W(h,t[o-1],t[o])&&g.nt(h,t[o-1],t[o])<=.001){for(var u=[h],a=o;a<=n;a++)u.push(t[a]);for(var f=0;f<u.length-1;f++)e+=g.distance(u[f],u[f+1]);return h.disIntersectToPoint=e,h.disCenterToPoint=g.distance(i.center,t[n]),h}}}catch(t){s.e(t)}finally{s.f()}}return null},ue:function(t){var i={x:this.tn.x,y:this.tn.y,height:this.tn.height,level:t.level,buildingID:t.bid},n=this.Yn[this.Mi].groupsPoints[this.ki];n&&n.pointList&&0<n.pointList.length&&((i=Object.assign(i,n.pointList[0])).buildingID=t.bid),this.tn.moveTo(i)},me:function(t,i,n){i={distance:t.distance,remain:t.remain,distanceToNext:t.distanceToNext,angle:t.angle,point:t.coords,level:t.coords.level,buildingID:t.coords.buildingID,index:t.index,enterCircle:i,intersect:n};return this.Vt===_t.Drive?(i.type="driving",i.drive=this.ln-t.remain):(i.type="walking",i.walk=this.ln-t.remain),i},pe:function(t,i,n){var e=this,r=(e.tn&&(void 0===(r=t.userAngle)&&(r=t.angle),s(t.noConstraintCoord||t.coords,r)),this.me(t,i,n));function s(t,i){null!=i&&(e.tn&&e.tn.rotateTo({heading:-i,duration:.1,animate:!0}),e.qt)&&e.Bt.setRotation({animate:!0,duration:.1,rotation:i}),e.En(t.level,t.buildingID);var n={x:t.x,y:t.y,level:t.level,height:e.tn.height,buildingID:t.buildingID,duration:.5,animate:!1};e.tn.moveTo(n),e.Ht&&e.Bt.setCenter({x:t.x,y:t.y,animate:!1,duration:.5}),e.qt&&i&&e.Bt.setRotation({animate:!1,duration:.5,rotation:i})}t.distance>this.Zi&&((i=Tt({},r)).type="offsetDistance",this.Qi.k(i)),t.remain<=this.li&&(this.gn&&this.gn.moveProportion(1),this.stop(),this.Qi.k({type:"complete"}))}}),t);function k(t){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ct(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=k(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=k(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==k(t)?t:t+""))(e.key),e)}}function Ft(t,i,n){i=w(i);var e=t,i=Dt()?Reflect.construct(i,n||[],w(t).constructor):i.apply(t,n);if(!i||"object"!=k(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=e))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function Dt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Dt=function(){return!!t})()}function Yt(t,i,n,e){var r=Vt(w(1&e?t.prototype:t),i,n);return 2&e&&"function"==typeof r?function(t){return r.apply(n,t)}:r}function Vt(){return(Vt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=((t,i)=>{for(;!{}.hasOwnProperty.call(t,i)&&null!==(t=w(t)););return t})(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(null,arguments)}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Zt(t,i){return(Zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function _(t){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Xt(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=_(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=_(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==_(t)?t:t+""))(e.key),e)}}function Bt(t,i,n){i=P(i);var e=t,i=zt()?Reflect.construct(i,n||[],P(t).constructor):i.apply(t,n);if(!i||"object"!=_(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=e))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function zt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(zt=function(){return!!t})()}function S(t,i,n,e){var r=Gt(P(1&e?t.prototype:t),i,n);return 2&e&&"function"==typeof r?function(t){return r.apply(n,t)}:r}function Gt(){return(Gt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=((t,i)=>{for(;!{}.hasOwnProperty.call(t,i)&&null!==(t=P(t)););return t})(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(null,arguments)}function P(t){return(P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Ht(t,i){return(Ht=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}function N(t){return(N="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ut(t,i){for(var n=0;n<i.length;n++){var e=i[n];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,(t=>(t=((t,i)=>{if("object"!=N(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0===n)return("string"===i?String:Number)(t);if("object"!=N(n=n.call(t,i||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")})(t,"string"),"symbol"==N(t)?t:t+""))(e.key),e)}}function qt(t,i,n){i=C(i);var e=t,i=Kt()?Reflect.construct(i,n||[],C(t).constructor):i.apply(t,n);if(!i||"object"!=N(i)&&"function"!=typeof i){if(void 0!==i)throw new TypeError("Derived constructors may only return object or undefined");if(void 0===(i=e))throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return i}function Kt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(Kt=function(){return!!t})()}function Qt(t,i,n,e){var r=Wt(C(1&e?t.prototype:t),i,n);return 2&e&&"function"==typeof r?function(t){return r.apply(n,t)}:r}function Wt(){return(Wt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,i,n){var e=((t,i)=>{for(;!{}.hasOwnProperty.call(t,i)&&null!==(t=C(t)););return t})(t,i);if(e)return(e=Object.getOwnPropertyDescriptor(e,i)).get?e.get.call(arguments.length<3?t:n):e.value}).apply(null,arguments)}function C(t){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function $t(t,i){return($t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,i){return t.__proto__=i,t})(t,i)}var Jt,ti={FMNaviMode:D,FMNaviPriority:Y,FMLanguageType:V,FMPassedLineFillMode:h,FMNavigation:(()=>{function e(t,i,n){if(this instanceof e)return Ft(this,e,[t,i,n]);throw new TypeError("Cannot call a class as a function")}var t,i=e,n=Nt;if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");return i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),n&&Zt(i,n),i=e,(n=[{key:"on",value:function(t,i){Yt(e,"on",this,3)([t,i])}},{key:"off",value:function(t,i){Yt(e,"off",this,3)([t,i])}}])&&Ct(i.prototype,n),t&&Ct(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i})(),FMNavigationDrive:(()=>{function e(t,i,n){if(this instanceof e)return t.type=_t.Drive,(t=Bt(this,e,[t,i,n])).Gt=7,t.Ut=.2,t;throw new TypeError("Cannot call a class as a function")}var t,i=e,n=Nt;if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");return i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),n&&Ht(i,n),i=e,(n=[{key:"on",value:function(t,i){S(e,"on",this,3)([t,i])}},{key:"off",value:function(t,i){S(e,"off",this,3)([t,i])}},{key:"locate",value:function(t,i){S(e,"locate",this,3)([t,i])}},{key:"route",value:function(t,i,n){S(e,"route",this,3)([t,i,n])}},{key:"locateNoConstraint",value:function(t,i){S(e,"locateNoConstraint",this,3)([t,i])}},{key:"simulate",value:function(t){S(e,"simulate",this,3)([t])}},{key:"naviResult",get:function(){return this.nn}}])&&Xt(i.prototype,n),t&&Xt(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i})(),FMNavigationWalk:(()=>{function e(t,i,n){if(this instanceof e)return t.type=_t.Walk,qt(this,e,[t,i,n]);throw new TypeError("Cannot call a class as a function")}var t,i=e,n=Nt;if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");return i.prototype=Object.create(n&&n.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),n&&$t(i,n),i=e,(n=[{key:"on",value:function(t,i){Qt(e,"on",this,3)([t,i])}},{key:"off",value:function(t,i){Qt(e,"off",this,3)([t,i])}},{key:"route",value:function(t,i,n){Qt(e,"route",this,3)([t,i,n])}}])&&Ut(i.prototype,n),t&&Ut(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i})()},ii=window.fengmap||{};for(Jt in ti)ii[Jt]=ti[Jt];window.fengmap=ii;F.default=ii}],e={},r.m=n,r.c=e,r.d=function(t,i,n){r.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"Oe",{value:!0})},r.t=function(i,t){if(1&t&&(i=r(i)),8&t)return i;if(4&t&&"object"==typeof i&&i&&i.Oe)return i;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:i}),2&t&&"string"!=typeof i)for(var e in i)r.d(n,e,function(t){return i[t]}.bind(null,e));return n},r.n=function(t){var i=t&&t.Oe?function(){return t.default}:function(){return t};return r.d(i,"a",i),i},r.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},r.p="",r(r.s=0).default;function r(t){var i;return(e[t]||(i=e[t]={i:t,l:!1,exports:{}},n[t].call(i.exports,i,i.exports,r),i.l=!0,i)).exports}var n,e});