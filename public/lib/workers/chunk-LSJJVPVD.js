import{Matrix4 as d,Quaternion as C,Vector3 as $}from"./chunk-P5P7TRCV.js";import{Color as P,Vector2 as tt}from"./chunk-ZPMWR67W.js";import{MathUtils as w}from"./chunk-7IGK3GFL.js";import{toVec2 as H}from"./chunk-2DLEF24H.js";var i=[new $,new $,new $,new $,new $,new $,new $,new $],S=new $,_=new u,n=new $,s=new $,h=new $,r=new $,e=new $,o=new $,Y=new $,G=new $,D=new $,f=new $;function u(t,i){this.min=void 0!==t?t:new $(1/0,1/0,1/0),this.max=void 0!==i?i:new $(-1/0,-1/0,-1/0)}function V(t,i,n,s,h){for(var r=0,e=t.length-3;r<=e;r+=3){f.fromArray(t,r);var o=h.x*Math.abs(f.x)+h.y*Math.abs(f.y)+h.z*Math.abs(f.z),u=i.dot(f),a=n.dot(f),c=s.dot(f);if(Math.max(-Math.max(u,a,c),Math.min(u,a,c))>o)return!1}return!0}function I(){}function X(t,i,n,s){this.x=t||0,this.y=i||0,this.z=n||0,this.w=void 0!==s?s:1}Object.assign(u.prototype,{isBox3:!0,set:function(t,i){return this.min.copy(t),this.max.copy(i),this},setFromArray:function(t){for(var i=1/0,n=1/0,s=1/0,h=-1/0,r=-1/0,e=-1/0,o=0,u=t.length;o<u;o+=3){var a=t[o],c=t[o+1],f=t[o+2];a<i&&(i=a),c<n&&(n=c),f<s&&(s=f),h<a&&(h=a),r<c&&(r=c),e<f&&(e=f)}return this.min.set(i,n,s),this.max.set(h,r,e),this},setFromBufferAttribute:function(t){for(var i=1/0,n=1/0,s=1/0,h=-1/0,r=-1/0,e=-1/0,o=0,u=t.count;o<u;o++){var a=t.getX(o),c=t.getY(o),f=t.getZ(o);a<i&&(i=a),c<n&&(n=c),f<s&&(s=f),h<a&&(h=a),r<c&&(r=c),e<f&&(e=f)}return this.min.set(i,n,s),this.max.set(h,r,e),this},setFromPoints:function(t){this.makeEmpty();for(var i=0,n=t.length;i<n;i++)this.expandByPoint(t[i]);return this},setFromCenterAndSize:function(t,i){i=S.copy(i).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new $),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new $),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);for(var i=t.geometry,n=(void 0!==i&&(null===i.boundingBox&&i.computeBoundingBox(),_.copy(i.boundingBox),_.applyMatrix4(t.matrixWorld),this.union(_)),t.children),s=0,h=n.length;s<h;s++)this.expandByObject(n[s]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,i){return void 0===i&&(console.warn("THREE.Box3: .getParameter() target is now required"),i=new $),i.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,S),S.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){var i,n=0<t.normal.x?(i=t.normal.x*this.min.x,t.normal.x*this.max.x):(i=t.normal.x*this.max.x,t.normal.x*this.min.x);return 0<t.normal.y?(i+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(i+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),0<t.normal.z?(i+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(i+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),i<=-t.constant&&n>=-t.constant},intersectsTriangle:function(t){return!this.isEmpty()&&(this.getCenter(Y),G.subVectors(this.max,Y),n.subVectors(t.a,Y),s.subVectors(t.b,Y),h.subVectors(t.c,Y),r.subVectors(s,n),e.subVectors(h,s),o.subVectors(n,h),!!V([0,-r.z,r.y,0,-e.z,e.y,0,-o.z,o.y,r.z,0,-r.x,e.z,0,-e.x,o.z,0,-o.x,-r.y,r.x,0,-e.y,e.x,0,-o.y,o.x,0],n,s,h,G))&&!!V([1,0,0,0,1,0,0,0,1],n,s,h,G)&&(D.crossVectors(r,e),V([D.x,D.y,D.z],n,s,h,G))},clampPoint:function(t,i){return void 0===i&&(console.warn("THREE.Box3: .clampPoint() target is now required"),i=new $),i.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return S.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return void 0===t&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(S).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()||(i[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),i[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),i[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),i[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),i[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),i[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),i[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),i[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(i)),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(I.prototype,{addEventListener:function(t,i){void 0===this.t&&(this.t={});var n=this.t;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(i)&&n[t].push(i)},hasEventListener:function(t,i){var n;return void 0!==this.t&&void 0!==(n=this.t)[t]&&-1!==n[t].indexOf(i)},removeEventListener:function(t,i){var n;void 0!==this.t&&void 0!==(t=this.t[t])&&-1!==(n=t.indexOf(i))&&t.splice(n,1)},dispatchEvent:function(t){if(void 0!==this.t){var i=this.t[t.type];if(void 0!==i){t.target=this;for(var n=i.slice(0),s=0,h=n.length;s<h;s++)n[s].call(this,t)}}}}),Object.defineProperties(X.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),Object.assign(X.prototype,{isVector4:!0,set:function(t,i,n,s){return this.x=t,this.y=i,this.z=n,this.w=s,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,i){switch(t){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,i){return void 0!==i?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,i)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,i){return this.x=t.x+i.x,this.y=t.y+i.y,this.z=t.z+i.z,this.w=t.w+i.w,this},addScaledVector:function(t,i){return this.x+=t.x*i,this.y+=t.y*i,this.z+=t.z*i,this.w+=t.w*i,this},sub:function(t,i){return void 0!==i?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,i)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,i){return this.x=t.x-i.x,this.y=t.y-i.y,this.z=t.z-i.z,this.w=t.w-i.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var i=this.x,n=this.y,s=this.z,h=this.w,t=t.elements;return this.x=t[0]*i+t[4]*n+t[8]*s+t[12]*h,this.y=t[1]*i+t[5]*n+t[9]*s+t[13]*h,this.z=t[2]*i+t[6]*n+t[10]*s+t[14]*h,this.w=t[3]*i+t[7]*n+t[11]*s+t[15]*h,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var i=Math.sqrt(1-t.w*t.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/i,this.y=t.y/i,this.z=t.z/i),this},setAxisAngleFromRotationMatrix:function(t){var i,n,s,h,r,e,o,u,a,c,t=t.elements,f=t[0],v=t[4],l=t[8],d=t[1],w=t[5],M=t[9],m=t[2],p=t[6],t=t[10];return Math.abs(v-d)<.01&&Math.abs(l-m)<.01&&Math.abs(M-p)<.01?Math.abs(v+d)<.1&&Math.abs(l+m)<.1&&Math.abs(M+p)<.1&&Math.abs(f+w+t-3)<.1?this.set(1,0,0,0):(h=Math.PI,e=(t+1)/2,o=(v+d)/4,u=(l+m)/4,a=(M+p)/4,(r=(w+1)/2)<(c=(f+1)/2)&&e<c?s=c<.01?(i=0,n=.707106781):(n=o/(i=Math.sqrt(c)),u/i):e<r?s=r<.01?(n=0,i=.707106781):(i=o/(n=Math.sqrt(r)),a/n):e<.01?(n=i=.707106781,s=0):(i=u/(s=Math.sqrt(e)),n=a/s),this.set(i,n,s,h)):(c=Math.sqrt((p-M)*(p-M)+(l-m)*(l-m)+(d-v)*(d-v)),Math.abs(c)<.001&&(c=1),this.x=(p-M)/c,this.y=(l-m)/c,this.z=(d-v)/c,this.w=Math.acos((f+w+t-1)/2)),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,i){return this.x=Math.max(t.x,Math.min(i.x,this.x)),this.y=Math.max(t.y,Math.min(i.y,this.y)),this.z=Math.max(t.z,Math.min(i.z,this.z)),this.w=Math.max(t.w,Math.min(i.w,this.w)),this},clampScalar:function(t,i){return this.x=Math.max(t,Math.min(i,this.x)),this.y=Math.max(t,Math.min(i,this.y)),this.z=Math.max(t,Math.min(i,this.z)),this.w=Math.max(t,Math.min(i,this.w)),this},clampLength:function(t,i){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(i,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,i){return this.x+=(t.x-this.x)*i,this.y+=(t.y-this.y)*i,this.z+=(t.z-this.z)*i,this.w+=(t.w-this.w)*i,this},lerpVectors:function(t,i,n){return this.subVectors(i,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,i){return this.x=t[i=void 0===i?0:i],this.y=t[i+1],this.z=t[i+2],this.w=t[i+3],this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.x,t[i+1]=this.y,t[i+2]=this.z,t[i+3]=this.w,t},fromBufferAttribute:function(t,i,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(i),this.y=t.getY(i),this.z=t.getZ(i),this.w=t.getW(i),this}});var k=35044,a=new $;function M(t,i,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=i,this.count=void 0!==t?t.length/i:0,this.normalized=!0===n,this.usage=k,this.updateRange={offset:0,count:-1},this.version=0}function W(t,i,n){M.call(this,new Int8Array(t),i,n)}function Z(t,i,n){M.call(this,new Uint8Array(t),i,n)}function U(t,i,n){M.call(this,new Uint8ClampedArray(t),i,n)}function q(t,i,n){M.call(this,new Int16Array(t),i,n)}function K(t,i,n){M.call(this,new Uint16Array(t),i,n)}function z(t,i,n){M.call(this,new Int32Array(t),i,n)}function Q(t,i,n){M.call(this,new Uint32Array(t),i,n)}function c(t,i,n){M.call(this,new Float32Array(t),i,n)}function J(t,i,n){M.call(this,new Float64Array(t),i,n)}Object.defineProperty(M.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(M.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,i,n){t*=this.itemSize,n*=i.itemSize;for(var s=0,h=this.itemSize;s<h;s++)this.array[t+s]=i.array[n+s];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var i=this.array,n=0,s=0,h=t.length;s<h;s++){var r=t[s];void 0===r&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",s),r=new P),i[n++]=r.r,i[n++]=r.g,i[n++]=r.b}return this},copyVector2sArray:function(t){for(var i=this.array,n=0,s=0,h=t.length;s<h;s++){var r=t[s];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),r=new tt),i[n++]=r.x,i[n++]=r.y}return this},copyVector3sArray:function(t){for(var i=this.array,n=0,s=0,h=t.length;s<h;s++){var r=t[s];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",s),r=new $),i[n++]=r.x,i[n++]=r.y,i[n++]=r.z}return this},copyVector4sArray:function(t){for(var i=this.array,n=0,s=0,h=t.length;s<h;s++){var r=t[s];void 0===r&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",s),r=new X),i[n++]=r.x,i[n++]=r.y,i[n++]=r.z,i[n++]=r.w}return this},applyMatrix3:function(t){for(var i=0,n=this.count;i<n;i++)a.x=this.getX(i),a.y=this.getY(i),a.z=this.getZ(i),a.applyMatrix3(t),this.setXYZ(i,a.x,a.y,a.z);return this},applyMatrix4:function(t){for(var i=0,n=this.count;i<n;i++)a.x=this.getX(i),a.y=this.getY(i),a.z=this.getZ(i),a.applyMatrix4(t),this.setXYZ(i,a.x,a.y,a.z);return this},applyNormalMatrix:function(t){for(var i=0,n=this.count;i<n;i++)a.x=this.getX(i),a.y=this.getY(i),a.z=this.getZ(i),a.applyNormalMatrix(t),this.setXYZ(i,a.x,a.y,a.z);return this},transformDirection:function(t){for(var i=0,n=this.count;i<n;i++)a.x=this.getX(i),a.y=this.getY(i),a.z=this.getZ(i),a.transformDirection(t),this.setXYZ(i,a.x,a.y,a.z);return this},set:function(t,i){return this.array.set(t,i=void 0===i?0:i),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,i){return this.array[t*this.itemSize]=i,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,i){return this.array[t*this.itemSize+1]=i,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,i){return this.array[t*this.itemSize+2]=i,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,i){return this.array[t*this.itemSize+3]=i,this},setXY:function(t,i,n){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=n,this},setXYZ:function(t,i,n,s){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=n,this.array[t+2]=s,this},setXYZW:function(t,i,n,s,h){return t*=this.itemSize,this.array[t+0]=i,this.array[t+1]=n,this.array[t+2]=s,this.array[t+3]=h,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),W.prototype=Object.create(M.prototype),W.prototype.constructor=W,Z.prototype=Object.create(M.prototype),Z.prototype.constructor=Z,U.prototype=Object.create(M.prototype),U.prototype.constructor=U,q.prototype=Object.create(M.prototype),q.prototype.constructor=q,K.prototype=Object.create(M.prototype),K.prototype.constructor=K,z.prototype=Object.create(M.prototype),z.prototype.constructor=z,Q.prototype=Object.create(M.prototype),Q.prototype.constructor=Q,c.prototype=Object.create(M.prototype),c.prototype.constructor=c,J.prototype=Object.create(M.prototype),J.prototype.constructor=J;var nt=new u;function st(t,i){this.center=void 0!==t?t:new $,this.radius=void 0!==i?i:0}function ht(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}Object.assign(st.prototype,{set:function(t,i){return this.center.copy(t),this.radius=i,this},setFromPoints:function(t,i){for(var n=this.center,s=(void 0!==i?n.copy(i):nt.setFromPoints(t).getCenter(n),0),h=0,r=t.length;h<r;h++)s=Math.max(s,n.distanceToSquared(t[h]));return this.radius=Math.sqrt(s),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var i=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=i*i},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,i){var n=this.center.distanceToSquared(t);return void 0===i&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),i=new $),i.copy(t),n>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new u),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(ht.prototype,{computeGroups:function(t){for(var i,n=[],s=void 0,h=t.faces,r=0;r<h.length;r++){var e=h[r];e.materialIndex!==s&&(s=e.materialIndex,void 0!==i&&(i.count=3*r-i.start,n.push(i)),i={start:3*r,materialIndex:s})}void 0!==i&&(i.count=3*r-i.start,n.push(i)),this.groups=n},fromGeometry:function(t){var i=t.faces,n=t.vertices,s=t.faceVertexUvs,h=s[0]&&0<s[0].length,r=s[1]&&0<s[1].length,e=t.morphTargets,o=e.length;if(0<o){for(var u=[],a=0;a<o;a++)u[a]={name:e[a].name,data:[]};this.morphTargets.position=u}var c=t.morphNormals,f=c.length;if(0<f){for(var v=[],a=0;a<f;a++)v[a]={name:c[a].name,data:[]};this.morphTargets.normal=v}var l=t.skinIndices,d=t.skinWeights,w=l.length===n.length,M=d.length===n.length;0<n.length&&0===i.length&&console.error("THREE.DirectGeometry: Faceless geometries are not supported.");for(a=0;a<i.length;a++){var m,p=i[a],b=(this.vertices.push(n[p.a],n[p.b],n[p.c]),p.vertexNormals),b=(3===b.length?this.normals.push(b[0],b[1],b[2]):(b=p.normal,this.normals.push(b,b,b)),p.vertexColors);3===b.length?this.colors.push(b[0],b[1],b[2]):(b=p.color,this.colors.push(b,b,b)),!0===h&&(void 0!==(m=s[0][a])?this.uvs.push(m[0],m[1],m[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",a),this.uvs.push(new tt,new tt,new tt))),!0===r&&(void 0!==(m=s[1][a])?this.uvs2.push(m[0],m[1],m[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",a),this.uvs2.push(new tt,new tt,new tt)));for(var y=0;y<o;y++){var E=e[y].vertices;u[y].data.push(E[p.a],E[p.b],E[p.c])}for(y=0;y<f;y++){var g=c[y].vertexNormals[a];v[y].data.push(g.a,g.b,g.c)}w&&this.skinIndices.push(l[p.a],l[p.b],l[p.c]),M&&this.skinWeights.push(d[p.a],d[p.b],d[p.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this}});var rt=new d,et=new C;function v(t,i,n,s){this.h=t||0,this.o=i||0,this.u=n||0,this.v=s||v.DefaultOrder}function ot(){this.mask=1}function ut(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}v.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],v.DefaultOrder="XYZ",Object.defineProperties(v.prototype,{x:{get:function(){return this.h},set:function(t){this.h=t,this.l()}},y:{get:function(){return this.o},set:function(t){this.o=t,this.l()}},z:{get:function(){return this.u},set:function(t){this.u=t,this.l()}},order:{get:function(){return this.v},set:function(t){this.v=t,this.l()}}}),Object.assign(v.prototype,{isEuler:!0,set:function(t,i,n,s){return this.h=t,this.o=i,this.u=n,this.v=s||this.v,this.l(),this},clone:function(){return new this.constructor(this.h,this.o,this.u,this.v)},copy:function(t){return this.h=t.h,this.o=t.o,this.u=t.u,this.v=t.v,this.l(),this},setFromRotationMatrix:function(t,i,n){var s=w.clamp,t=t.elements,h=t[0],r=t[4],e=t[8],o=t[1],u=t[5],a=t[9],c=t[2],f=t[6],t=t[10];return"XYZ"===(i=i||this.v)?(this.o=Math.asin(s(e,-1,1)),Math.abs(e)<.9999999?(this.h=Math.atan2(-a,t),this.u=Math.atan2(-r,h)):(this.h=Math.atan2(f,u),this.u=0)):"YXZ"===i?(this.h=Math.asin(-s(a,-1,1)),Math.abs(a)<.9999999?(this.o=Math.atan2(e,t),this.u=Math.atan2(o,u)):(this.o=Math.atan2(-c,h),this.u=0)):"ZXY"===i?(this.h=Math.asin(s(f,-1,1)),Math.abs(f)<.9999999?(this.o=Math.atan2(-c,t),this.u=Math.atan2(-r,u)):(this.o=0,this.u=Math.atan2(o,h))):"ZYX"===i?(this.o=Math.asin(-s(c,-1,1)),Math.abs(c)<.9999999?(this.h=Math.atan2(f,t),this.u=Math.atan2(o,h)):(this.h=0,this.u=Math.atan2(-r,u))):"YZX"===i?(this.u=Math.asin(s(o,-1,1)),Math.abs(o)<.9999999?(this.h=Math.atan2(-a,u),this.o=Math.atan2(-c,h)):(this.h=0,this.o=Math.atan2(e,t))):"XZY"===i?(this.u=Math.asin(-s(r,-1,1)),Math.abs(r)<.9999999?(this.h=Math.atan2(f,u),this.o=Math.atan2(e,h)):(this.h=Math.atan2(-a,t),this.o=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+i),this.v=i,!1!==n&&this.l(),this},setFromQuaternion:function(t,i,n){return rt.makeRotationFromQuaternion(t),this.setFromRotationMatrix(rt,i,n)},setFromVector3:function(t,i){return this.set(t.x,t.y,t.z,i||this.v)},reorder:function(t){return et.setFromEuler(this),this.setFromQuaternion(et,t)},equals:function(t){return t.h===this.h&&t.o===this.o&&t.u===this.u&&t.v===this.v},fromArray:function(t){return this.h=t[0],this.o=t[1],this.u=t[2],void 0!==t[3]&&(this.v=t[3]),this.l(),this},toArray:function(t,i){return(t=void 0===t?[]:t)[i=void 0===i?0:i]=this.h,t[i+1]=this.o,t[i+2]=this.u,t[i+3]=this.v,t},toVector3:function(t){return t?t.set(this.h,this.o,this.u):new $(this.h,this.o,this.u)},onChange:function(t){return this.l=t,this},l:function(){}}),Object.assign(ot.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return 0!=(this.mask&t.mask)}}),Object.assign(ut.prototype,{isMatrix3:!0,set:function(t,i,n,s,h,r,e,o,u){var a=this.elements;return a[0]=t,a[1]=s,a[2]=e,a[3]=i,a[4]=h,a[5]=o,a[6]=n,a[7]=r,a[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var i=this.elements,t=t.elements;return i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=t[3],i[4]=t[4],i[5]=t[5],i[6]=t[6],i[7]=t[7],i[8]=t[8],this},extractBasis:function(t,i,n){return t.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){t=t.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,i){var t=t.elements,i=i.elements,n=this.elements,s=t[0],h=t[3],r=t[6],e=t[1],o=t[4],u=t[7],a=t[2],c=t[5],t=t[8],f=i[0],v=i[3],l=i[6],d=i[1],w=i[4],M=i[7],m=i[2],p=i[5],i=i[8];return n[0]=s*f+h*d+r*m,n[3]=s*v+h*w+r*p,n[6]=s*l+h*M+r*i,n[1]=e*f+o*d+u*m,n[4]=e*v+o*w+u*p,n[7]=e*l+o*M+u*i,n[2]=a*f+c*d+t*m,n[5]=a*v+c*w+t*p,n[8]=a*l+c*M+t*i,this},multiplyScalar:function(t){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=t,i[4]*=t,i[7]*=t,i[2]*=t,i[5]*=t,i[8]*=t,this},determinant:function(){var t=this.elements,i=t[0],n=t[1],s=t[2],h=t[3],r=t[4],e=t[5],o=t[6],u=t[7],t=t[8];return i*r*t-i*e*u-n*h*t+n*e*o+s*h*u-s*r*o},getInverse:function(t,i){void 0!==i&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var i=t.elements,t=this.elements,n=i[0],s=i[1],h=i[2],r=i[3],e=i[4],o=i[5],u=i[6],a=i[7],i=i[8],c=i*e-o*a,f=o*u-i*r,v=a*r-e*u,l=n*c+s*f+h*v;return 0==l?this.set(0,0,0,0,0,0,0,0,0):(t[0]=c*(c=1/l),t[1]=(h*a-i*s)*c,t[2]=(o*s-h*e)*c,t[3]=f*c,t[4]=(i*n-h*u)*c,t[5]=(h*r-o*n)*c,t[6]=v*c,t[7]=(s*u-a*n)*c,t[8]=(e*n-s*r)*c,this)},transpose:function(){var t=this.elements,i=t[1];return t[1]=t[3],t[3]=i,i=t[2],t[2]=t[6],t[6]=i,i=t[5],t[5]=t[7],t[7]=i,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var i=this.elements;return t[0]=i[0],t[1]=i[3],t[2]=i[6],t[3]=i[1],t[4]=i[4],t[5]=i[7],t[6]=i[2],t[7]=i[5],t[8]=i[8],this},setUvTransform:function(t,i,n,s,h,r,e){var o=Math.cos(h),h=Math.sin(h);this.set(n*o,n*h,-n*(o*r+h*e)+r+t,-s*h,s*o,-s*(-h*r+o*e)+e+i,0,0,1)},scale:function(t,i){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=i,n[4]*=i,n[7]*=i,this},rotate:function(t){var i=Math.cos(t),t=Math.sin(t),n=this.elements,s=n[0],h=n[3],r=n[6],e=n[1],o=n[4],u=n[7];return n[0]=i*s+t*e,n[3]=i*h+t*o,n[6]=i*r+t*u,n[1]=-t*s+i*e,n[4]=-t*h+i*o,n[7]=-t*r+i*u,this},translate:function(t,i){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=i*n[2],n[4]+=i*n[5],n[7]+=i*n[8],this},equals:function(t){for(var i=this.elements,n=t.elements,s=0;s<9;s++)if(i[s]!==n[s])return!1;return!0},fromArray:function(t,i){void 0===i&&(i=0);for(var n=0;n<9;n++)this.elements[n]=t[n+i];return this},toArray:function(t,i){var n=this.elements;return(t=void 0===t?[]:t)[i=void 0===i?0:i]=n[0],t[i+1]=n[1],t[i+2]=n[2],t[i+3]=n[3],t[i+4]=n[4],t[i+5]=n[5],t[i+6]=n[6],t[i+7]=n[7],t[i+8]=n[8],t}});var at=0,ct=new $,l=new C,m=new d,ft=new $,vt=new $,lt=new $,dt=new C,wt=new $(1,0,0),Mt=new $(0,1,0),mt=new $(0,0,1),pt={type:"added"},bt={type:"removed"};function p(){Object.defineProperty(this,"id",{value:at++}),this.uuid=w.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=p.DefaultUp.clone();var t=new $,i=new v,n=new C,s=new $(1,1,1);i.onChange(function(){n.setFromEuler(i,!1)}),n.onChange(function(){i.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:i},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new d},normalMatrix:{value:new ut}}),this.matrix=new d,this.matrixWorld=new d,this.matrixAutoUpdate=p.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ot,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function yt(t){if(0===t.length)return-1/0;for(var i=t[0],n=1,s=t.length;n<s;++n)t[n]>i&&(i=t[n]);return i}p.DefaultUp=new $(0,1,0),p.DefaultMatrixAutoUpdate=!0,p.prototype=Object.assign(Object.create(I.prototype),{constructor:p,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,i){this.quaternion.setFromAxisAngle(t,i)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,i){return l.setFromAxisAngle(t,i),this.quaternion.multiply(l),this},rotateOnWorldAxis:function(t,i){return l.setFromAxisAngle(t,i),this.quaternion.premultiply(l),this},rotateX:function(t){return this.rotateOnAxis(wt,t)},rotateY:function(t){return this.rotateOnAxis(Mt,t)},rotateZ:function(t){return this.rotateOnAxis(mt,t)},translateOnAxis:function(t,i){return ct.copy(t).applyQuaternion(this.quaternion),this.position.add(ct.multiplyScalar(i)),this},translateX:function(t){return this.translateOnAxis(wt,t)},translateY:function(t){return this.translateOnAxis(Mt,t)},translateZ:function(t){return this.translateOnAxis(mt,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(m.getInverse(this.matrixWorld))},lookAt:function(t,i,n){t.isVector3?ft.copy(t):ft.set(t,i,n);t=this.parent;this.updateWorldMatrix(!0,!1),vt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?m.lookAt(vt,ft,this.up):m.lookAt(ft,vt,this.up),this.quaternion.setFromRotationMatrix(m),t&&(m.extractRotation(t.matrixWorld),l.setFromRotationMatrix(m),this.quaternion.premultiply(l.inverse()))},add:function(t){if(1<arguments.length)for(var i=0;i<arguments.length;i++)this.add(arguments[i]);else t===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",t):t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),(t.parent=this).children.push(t),t.dispatchEvent(pt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t);return this},remove:function(t){if(1<arguments.length)for(var i=0;i<arguments.length;i++)this.remove(arguments[i]);else{var n=this.children.indexOf(t);-1!==n&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(bt))}return this},attach:function(t){return this.updateWorldMatrix(!0,!1),m.getInverse(this.matrixWorld),null!==t.parent&&(t.parent.updateWorldMatrix(!0,!1),m.multiply(t.parent.matrixWorld)),t.applyMatrix4(m),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,i){if(this[t]===i)return this;for(var n=0,s=this.children.length;n<s;n++){var h=this.children[n].getObjectByProperty(t,i);if(void 0!==h)return h}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new $),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new C),this.updateMatrixWorld(!0),this.matrixWorld.decompose(vt,t,lt),t},getWorldScale:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new $),this.updateMatrixWorld(!0),this.matrixWorld.decompose(vt,dt,t),t},getWorldDirection:function(t){void 0===t&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new $),this.updateMatrixWorld(!0);var i=this.matrixWorld.elements;return t.set(i[8],i[9],i[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var i=this.children,n=0,s=i.length;n<s;n++)i[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var i=this.children,n=0,s=i.length;n<s;n++)i[n].traverseVisible(t)}},traverseAncestors:function(t){var i=this.parent;null!==i&&(t(i),i.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),t=!(this.matrixWorldNeedsUpdate=!1));for(var i=this.children,n=0,s=i.length;n<s;n++)i[n].updateMatrixWorld(t)},updateWorldMatrix:function(t,i){var n=this.parent;if(!0===t&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===i)for(var s=this.children,h=0,r=s.length;h<r;h++)s[h].updateWorldMatrix(!1,!0)},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,i){if(void 0===i&&(i=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===i)for(var n=0;n<t.children.length;n++){var s=t.children[n];this.add(s.clone())}return this}});var Et=1,b=new d,gt=new p,y=new $,E=new u,At=new u,g=new $;function j(){Object.defineProperty(this,"id",{value:Et+=2}),this.uuid=w.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}function Rt(t,i,n,s,h,r){this.a=t,this.b=i,this.c=n,this.normal=s&&s.isVector3?s:new $,this.vertexNormals=Array.isArray(s)?s:[],this.color=h&&h.isColor?h:new P,this.vertexColors=Array.isArray(h)?h:[],this.materialIndex=void 0!==r?r:0}j.prototype=Object.assign(Object.create(I.prototype),{constructor:j,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<yt(t)?Q:K)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,i){return this.attributes[t]=i,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,i,n){this.groups.push({start:t,count:i,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,i){this.drawRange.start=t,this.drawRange.count=i},applyMatrix4:function(t){var i=this.attributes.position,i=(void 0!==i&&(i.applyMatrix4(t),i.needsUpdate=!0),this.attributes.normal),n=(void 0!==i&&(n=(new ut).getNormalMatrix(t),i.applyNormalMatrix(n),i.needsUpdate=!0),this.attributes.tangent);return void 0!==n&&(n.transformDirection(t),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(t){return b.makeRotationX(t),this.applyMatrix4(b),this},rotateY:function(t){return b.makeRotationY(t),this.applyMatrix4(b),this},rotateZ:function(t){return b.makeRotationZ(t),this.applyMatrix4(b),this},translate:function(t,i,n){return b.makeTranslation(t,i,n),this.applyMatrix4(b),this},scale:function(t,i,n){return b.makeScale(t,i,n),this.applyMatrix4(b),this},lookAt:function(t){return gt.lookAt(t),gt.updateMatrix(),this.applyMatrix4(gt.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(y).negate(),this.translate(y.x,y.y,y.z),this},setFromObject:function(t){var i,n,s=t.geometry;return t.isPoints||t.isLine?(n=new c(3*s.vertices.length,3),i=new c(3*s.colors.length,3),this.setAttribute("position",n.copyVector3sArray(s.vertices)),this.setAttribute("color",i.copyColorsArray(s.colors)),s.lineDistances&&s.lineDistances.length===s.vertices.length&&(n=new c(s.lineDistances.length,1),this.setAttribute("lineDistance",n.copyArray(s.lineDistances))),null!==s.boundingSphere&&(this.boundingSphere=s.boundingSphere.clone()),null!==s.boundingBox&&(this.boundingBox=s.boundingBox.clone())):t.isMesh&&s&&s.isGeometry&&this.fromGeometry(s),this},setFromPoints:function(t){for(var i=[],n=0,s=t.length;n<s;n++){var h=t[n];i.push(h.x,h.y,h.z||0)}return this.setAttribute("position",new c(i,3)),this},updateFromObject:function(t){var i,n=t.geometry;if(t.isMesh){var s=n.M;if(!0===n.elementsNeedUpdate&&(s=void 0,n.elementsNeedUpdate=!1),void 0===s)return this.fromGeometry(n);s.verticesNeedUpdate=n.verticesNeedUpdate,s.normalsNeedUpdate=n.normalsNeedUpdate,s.colorsNeedUpdate=n.colorsNeedUpdate,s.uvsNeedUpdate=n.uvsNeedUpdate,s.groupsNeedUpdate=n.groupsNeedUpdate,n.verticesNeedUpdate=!1,n.normalsNeedUpdate=!1,n.colorsNeedUpdate=!1,n.uvsNeedUpdate=!1,n.groupsNeedUpdate=!1,n=s}return!0===n.verticesNeedUpdate&&(void 0!==(i=this.attributes.position)&&(i.copyVector3sArray(n.vertices),i.needsUpdate=!0),n.verticesNeedUpdate=!1),!0===n.normalsNeedUpdate&&(void 0!==(i=this.attributes.normal)&&(i.copyVector3sArray(n.normals),i.needsUpdate=!0),n.normalsNeedUpdate=!1),!0===n.colorsNeedUpdate&&(void 0!==(i=this.attributes.color)&&(i.copyColorsArray(n.colors),i.needsUpdate=!0),n.colorsNeedUpdate=!1),n.uvsNeedUpdate&&(void 0!==(i=this.attributes.uv)&&(i.copyVector2sArray(n.uvs),i.needsUpdate=!0),n.uvsNeedUpdate=!1),n.lineDistancesNeedUpdate&&(void 0!==(i=this.attributes.lineDistance)&&(i.copyArray(n.lineDistances),i.needsUpdate=!0),n.lineDistancesNeedUpdate=!1),n.groupsNeedUpdate&&(n.computeGroups(t.geometry),this.groups=n.groups,n.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.M=(new ht).fromGeometry(t),this.fromDirectGeometry(t.M)},fromDirectGeometry:function(t){var i,n=new Float32Array(3*t.vertices.length);for(i in this.setAttribute("position",new M(n,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(n=new Float32Array(3*t.normals.length),this.setAttribute("normal",new M(n,3).copyVector3sArray(t.normals))),0<t.colors.length&&(n=new Float32Array(3*t.colors.length),this.setAttribute("color",new M(n,3).copyColorsArray(t.colors))),0<t.uvs.length&&(n=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new M(n,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(n=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new M(n,2).copyVector2sArray(t.uvs2))),this.groups=t.groups,t.morphTargets){for(var s=[],h=t.morphTargets[i],r=0,e=h.length;r<e;r++){var o=h[r],u=new c(3*o.data.length,3);u.name=o.name,s.push(u.copyVector3sArray(o.data))}this.morphAttributes[i]=s}return 0<t.skinIndices.length&&(n=new c(4*t.skinIndices.length,4),this.setAttribute("skinIndex",n.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(n=new c(4*t.skinWeights.length,4),this.setAttribute("skinWeight",n.copyVector4sArray(t.skinWeights))),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new u);var t=this.attributes.position,i=this.morphAttributes.position;if(void 0!==t){if(this.boundingBox.setFromBufferAttribute(t),i)for(var n=0,s=i.length;n<s;n++){var h=i[n];E.setFromBufferAttribute(h),this.morphTargetsRelative?(g.addVectors(this.boundingBox.min,E.min),this.boundingBox.expandByPoint(g),g.addVectors(this.boundingBox.max,E.max),this.boundingBox.expandByPoint(g)):(this.boundingBox.expandByPoint(E.min),this.boundingBox.expandByPoint(E.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new st);var t=this.attributes.position,i=this.morphAttributes.position;if(t){var n=this.boundingSphere.center;if(E.setFromBufferAttribute(t),i)for(var s=0,h=i.length;s<h;s++){var r=i[s];At.setFromBufferAttribute(r),this.morphTargetsRelative?(g.addVectors(E.min,At.min),E.expandByPoint(g),g.addVectors(E.max,At.max),E.expandByPoint(g)):(E.expandByPoint(At.min),E.expandByPoint(At.max))}E.getCenter(n);for(var e=0,s=0,h=t.count;s<h;s++)g.fromBufferAttribute(t,s),e=Math.max(e,n.distanceToSquared(g));if(i)for(s=0,h=i.length;s<h;s++)for(var r=i[s],o=this.morphTargetsRelative,u=0,a=r.count;u<a;u++)g.fromBufferAttribute(r,u),o&&(y.fromBufferAttribute(t,u),g.add(y)),e=Math.max(e,n.distanceToSquared(g));this.boundingSphere.radius=Math.sqrt(e),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,i=this.attributes;if(i.position){var n=i.position.array;if(void 0===i.normal)this.setAttribute("normal",new M(new Float32Array(n.length),3));else for(var s=i.normal.array,h=0,r=s.length;h<r;h++)s[h]=0;var e,o,u,a=i.normal.array,c=new $,f=new $,v=new $,l=new $,d=new $;if(t)for(var w=t.array,h=0,r=t.count;h<r;h+=3)e=3*w[h+0],o=3*w[h+1],u=3*w[h+2],c.fromArray(n,e),f.fromArray(n,o),v.fromArray(n,u),l.subVectors(v,f),d.subVectors(c,f),l.cross(d),a[e]+=l.x,a[1+e]+=l.y,a[2+e]+=l.z,a[o]+=l.x,a[1+o]+=l.y,a[2+o]+=l.z,a[u]+=l.x,a[1+u]+=l.y,a[2+u]+=l.z;else for(h=0,r=n.length;h<r;h+=9)c.fromArray(n,h),f.fromArray(n,h+3),v.fromArray(n,h+6),l.subVectors(v,f),d.subVectors(c,f),l.cross(d),a[h]=l.x,a[h+1]=l.y,a[h+2]=l.z,a[h+3]=l.x,a[h+4]=l.y,a[h+5]=l.z,a[h+6]=l.x,a[h+7]=l.y,a[h+8]=l.z;this.normalizeNormals(),i.normal.needsUpdate=!0}},normalizeNormals:function(){for(var t=this.attributes.normal,i=0,n=t.count;i<n;i++)g.x=t.getX(i),g.y=t.getY(i),g.z=t.getZ(i),g.normalize(),t.setXYZ(i,g.x,g.y,g.z)},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(Rt.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var i=0,n=t.vertexNormals.length;i<n;i++)this.vertexNormals[i]=t.vertexNormals[i].clone();for(i=0,n=t.vertexColors.length;i<n;i++)this.vertexColors[i]=t.vertexColors[i].clone();return this}});var Ot=0,A=new d,xt=new p,jt=new $;function R(){Object.defineProperty(this,"id",{value:Ot+=2}),this.uuid=w.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function O(){this.type="Curve",this.arcLengthDivisions=200}function x(t,i,n,s,h,r,e,o){O.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=i||0,this.xRadius=n||1,this.yRadius=s||1,this.aStartAngle=h||0,this.aEndAngle=r||2*Math.PI,this.aClockwise=e||!1,this.aRotation=o||0}function Tt(t,i,n,s,h,r){x.call(this,t,i,n,n,s,h,r),this.type="ArcCurve"}function Bt(){var h=0,r=0,e=0,o=0;function u(t,i,n,s){e=-3*(h=t)+3*i-2*(r=n)-s,o=2*t-2*i+n+s}return{initCatmullRom:function(t,i,n,s,h){u(i,n,h*(n-t),h*(s-i))},initNonuniformCatmullRom:function(t,i,n,s,h,r,e){t=(i-t)/h-(n-t)/(h+r)+(n-i)/r,h=(n-i)/r-(s-i)/(r+e)+(s-n)/e;u(i,n,t*=r,h*=r)},calc:function(t){var i=t*t;return h+r*t+e*i+o*(i*t)}}}R.prototype=Object.assign(Object.create(I.prototype),{constructor:R,isGeometry:!0,applyMatrix4:function(t){for(var i=(new ut).getNormalMatrix(t),n=0,s=this.vertices.length;n<s;n++)this.vertices[n].applyMatrix4(t);for(n=0,s=this.faces.length;n<s;n++){var h=this.faces[n];h.normal.applyMatrix3(i).normalize();for(var r=0,e=h.vertexNormals.length;r<e;r++)h.vertexNormals[r].applyMatrix3(i).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(t){return A.makeRotationX(t),this.applyMatrix4(A),this},rotateY:function(t){return A.makeRotationY(t),this.applyMatrix4(A),this},rotateZ:function(t){return A.makeRotationZ(t),this.applyMatrix4(A),this},translate:function(t,i,n){return A.makeTranslation(t,i,n),this.applyMatrix4(A),this},scale:function(t,i,n){return A.makeScale(t,i,n),this.applyMatrix4(A),this},lookAt:function(t){return xt.lookAt(t),xt.updateMatrix(),this.applyMatrix4(xt.matrix),this},fromBufferGeometry:function(t){var r=this,i=null!==t.index?t.index.array:void 0,n=t.attributes;if(void 0===n.position)console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion.");else{var s=n.position.array,e=void 0!==n.normal?n.normal.array:void 0,o=void 0!==n.color?n.color.array:void 0,u=void 0!==n.uv?n.uv.array:void 0,a=void 0!==n.uv2?n.uv2.array:void 0;void 0!==a&&(this.faceVertexUvs[1]=[]);for(var h=0;h<s.length;h+=3)r.vertices.push((new $).fromArray(s,h)),void 0!==o&&r.colors.push((new P).fromArray(o,h));var c=t.groups;if(0<c.length)for(h=0;h<c.length;h++)for(var f=c[h],v=f.start,l=v,d=v+f.count;l<d;l+=3)void 0!==i?w(i[l],i[l+1],i[l+2],f.materialIndex):w(l,l+1,l+2,f.materialIndex);else if(void 0!==i)for(h=0;h<i.length;h+=3)w(i[h],i[h+1],i[h+2]);else for(h=0;h<s.length/3;h+=3)w(h,h+1,h+2);this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone())}return this;function w(t,i,n,s){var h=void 0===o?[]:[r.colors[t].clone(),r.colors[i].clone(),r.colors[n].clone()],h=new Rt(t,i,n,void 0===e?[]:[(new $).fromArray(e,3*t),(new $).fromArray(e,3*i),(new $).fromArray(e,3*n)],h,s);r.faces.push(h),void 0!==u&&r.faceVertexUvs[0].push([(new tt).fromArray(u,2*t),(new tt).fromArray(u,2*i),(new tt).fromArray(u,2*n)]),void 0!==a&&r.faceVertexUvs[1].push([(new tt).fromArray(a,2*t),(new tt).fromArray(a,2*i),(new tt).fromArray(a,2*n)])}},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(jt).negate(),this.translate(jt.x,jt.y,jt.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,i=this.boundingSphere.radius,i=0===i?1:1/i,n=new d;return n.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix4(n),this},computeFaceNormals:function(){for(var t=new $,i=new $,n=0,s=this.faces.length;n<s;n++){var h=this.faces[n],r=this.vertices[h.a],e=this.vertices[h.b],o=this.vertices[h.c];t.subVectors(o,e),i.subVectors(r,e),t.cross(i),t.normalize(),h.normal.copy(t)}},computeVertexNormals:function(t){var i,n,s;for(void 0===t&&(t=!0),s=new Array(this.vertices.length),i=0,n=this.vertices.length;i<n;i++)s[i]=new $;if(t)for(var h,r,e,o=new $,u=new $,a=0,c=this.faces.length;a<c;a++)f=this.faces[a],h=this.vertices[f.a],r=this.vertices[f.b],e=this.vertices[f.c],o.subVectors(e,r),u.subVectors(h,r),o.cross(u),s[f.a].add(o),s[f.b].add(o),s[f.c].add(o);else for(this.computeFaceNormals(),a=0,c=this.faces.length;a<c;a++)s[(f=this.faces[a]).a].add(f.normal),s[f.b].add(f.normal),s[f.c].add(f.normal);for(i=0,n=this.vertices.length;i<n;i++)s[i].normalize();for(a=0,c=this.faces.length;a<c;a++){var f,v=(f=this.faces[a]).vertexNormals;3===v.length?(v[0].copy(s[f.a]),v[1].copy(s[f.b]),v[2].copy(s[f.c])):(v[0]=s[f.a].clone(),v[1]=s[f.b].clone(),v[2]=s[f.c].clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,i;for(this.computeFaceNormals(),t=0,i=this.faces.length;t<i;t++){var n,s=(n=this.faces[t]).vertexNormals;3===s.length?(s[0].copy(n.normal),s[1].copy(n.normal),s[2].copy(n.normal)):(s[0]=n.normal.clone(),s[1]=n.normal.clone(),s[2]=n.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,i,n;for(e=0,o=this.faces.length;e<o;e++)for((n=this.faces[e]).m?n.m.copy(n.normal):n.m=n.normal.clone(),n.p||(n.p=[]),t=0,i=n.vertexNormals.length;t<i;t++)n.p[t]?n.p[t].copy(n.vertexNormals[t]):n.p[t]=n.vertexNormals[t].clone();var s=new R;for(s.faces=this.faces,t=0,i=this.morphTargets.length;t<i;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];for(var h=this.morphNormals[t].faceNormals,r=this.morphNormals[t].vertexNormals,e=0,o=this.faces.length;e<o;e++)u=new $,a={a:new $,b:new $,c:new $},h.push(u),r.push(a)}var u,a,c=this.morphNormals[t];for(s.vertices=this.morphTargets[t].vertices,s.computeFaceNormals(),s.computeVertexNormals(),e=0,o=this.faces.length;e<o;e++)n=this.faces[e],u=c.faceNormals[e],a=c.vertexNormals[e],u.copy(n.normal),a.a.copy(n.vertexNormals[0]),a.b.copy(n.vertexNormals[1]),a.c.copy(n.vertexNormals[2])}for(e=0,o=this.faces.length;e<o;e++)(n=this.faces[e]).normal=n.m,n.vertexNormals=n.p},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new u),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new st),this.boundingSphere.setFromPoints(this.vertices)},mergeVertices:function(){for(var t,i,n,s,h={},r=[],e=[],o=Math.pow(10,4),u=0,a=this.vertices.length;u<a;u++)t=this.vertices[u],void 0===h[t=Math.round(t.x*o)+"_"+Math.round(t.y*o)+"_"+Math.round(t.z*o)]?(h[t]=u,r.push(this.vertices[u]),e[u]=r.length-1):e[u]=e[h[t]];var c=[];for(u=0,a=this.faces.length;u<a;u++){(i=this.faces[u]).a=e[i.a],i.b=e[i.b],i.c=e[i.c];for(var f=[i.a,i.b,i.c],v=0;v<3;v++)if(f[v]===f[(v+1)%3]){c.push(u);break}}for(u=c.length-1;0<=u;u--){var l=c[u];for(this.faces.splice(l,1),n=0,s=this.faceVertexUvs.length;n<s;n++)this.faceVertexUvs[n].splice(l,1)}var d=this.vertices.length-r.length;return this.vertices=r,d},setFromPoints:function(t){this.vertices=[];for(var i=0,n=t.length;i<n;i++){var s=t[i];this.vertices.push(new $(s.x,s.y,s.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,i=t.length,n=0;n<i;n++)t[n].g=n;t.sort(function(t,i){return t.materialIndex-i.materialIndex});var s,h,r=this.faceVertexUvs[0],e=this.faceVertexUvs[1];r&&r.length===i&&(s=[]),e&&e.length===i&&(h=[]);for(n=0;n<i;n++){var o=t[n].g;s&&s.push(r[o]),h&&h.push(e[o])}s&&(this.faceVertexUvs[0]=s),h&&(this.faceVertexUvs[1]=h)},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.assign(O.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,i){t=this.getUtoTmapping(t);return this.getPoint(t,i)},getPoints:function(t){void 0===t&&(t=5);for(var i=[],n=0;n<=t;n++)i.push(this.getPoint(n/t));return i},getSpacedPoints:function(t){void 0===t&&(t=5);for(var i=[],n=0;n<=t;n++)i.push(this.getPointAt(n/t));return i},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var i,n,s=[],h=this.getPoint(0),r=0;for(s.push(0),n=1;n<=t;n++)r+=(i=this.getPoint(n/t)).distanceTo(h),s.push(r),h=i;return this.cacheArcLengths=s},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,i){for(var n,s=this.getLengths(),h=0,r=s.length,e=i||t*s[r-1],o=0,u=r-1;o<=u;)if((n=s[h=Math.floor(o+(u-o)/2)]-e)<0)o=h+1;else{if(!(0<n)){u=h;break}u=h-1}return s[h=u]===e?h/(r-1):(h+(e-(i=s[h]))/(s[h+1]-i))/(r-1)},getTangent:function(t){var i=t-1e-4,t=t+1e-4,i=(1<t&&(t=1),this.getPoint(i=i<0?0:i));return this.getPoint(t).clone().sub(i).normalize()},getTangentAt:function(t){t=this.getUtoTmapping(t);return this.getTangent(t)},computeFrenetFrames:function(t,i){for(var n,s=new $,h=[],r=[],e=[],o=new $,u=new d,a=0;a<=t;a++)h[a]=this.getTangentAt(a/t),h[a].normalize();r[0]=new $,e[0]=new $;var c=Number.MAX_VALUE,f=Math.abs(h[0].x),v=Math.abs(h[0].y),l=Math.abs(h[0].z);for(f<=c&&(c=f,s.set(1,0,0)),v<=c&&(c=v,s.set(0,1,0)),l<=c&&s.set(0,0,1),o.crossVectors(h[0],s).normalize(),r[0].crossVectors(h[0],o),e[0].crossVectors(h[0],r[0]),a=1;a<=t;a++)r[a]=r[a-1].clone(),e[a]=e[a-1].clone(),o.crossVectors(h[a-1],h[a]),o.length()>Number.EPSILON&&(o.normalize(),n=Math.acos(w.clamp(h[a-1].dot(h[a]),-1,1)),r[a].applyMatrix4(u.makeRotationAxis(o,n))),e[a].crossVectors(h[a],r[a]);if(!0===i)for(n=Math.acos(w.clamp(r[0].dot(r[t]),-1,1)),n/=t,0<h[0].dot(o.crossVectors(r[0],r[t]))&&(n=-n),a=1;a<=t;a++)r[a].applyMatrix4(u.makeRotationAxis(h[a],n*a)),e[a].crossVectors(h[a],r[a]);return{tangents:h,normals:r,binormals:e}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),x.prototype=Object.create(O.prototype),(x.prototype.constructor=x).prototype.isEllipseCurve=!0,x.prototype.getPoint=function(t,i){for(var i=i||new tt,n=2*Math.PI,s=this.aEndAngle-this.aStartAngle,h=Math.abs(s)<Number.EPSILON;s<0;)s+=n;for(;n<s;)s-=n;s<Number.EPSILON&&(s=h?0:n),!0!==this.aClockwise||h||(s===n?s=-n:s-=n);var r,e,o,u,h=this.aStartAngle+t*s,t=this.aX+this.xRadius*Math.cos(h),h=this.aY+this.yRadius*Math.sin(h);return 0!==this.aRotation&&(r=Math.cos(this.aRotation),e=Math.sin(this.aRotation),t=(o=t-this.aX)*r-(u=h-this.aY)*e+this.aX,h=o*e+u*r+this.aY),i.set(t,h)},x.prototype.copy=function(t){return O.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Tt.prototype=Object.create(x.prototype),(Tt.prototype.constructor=Tt).prototype.isArcCurve=!0;var Nt=new $,Lt=new Bt,Ft=new Bt,Ct=new Bt;function Pt(t,i,n,s){O.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=i||!1,this.curveType=n||"centripetal",this.tension=s||.5}function Ht(t,i,n,s,h){var i=.5*(s-i),h=.5*(h-n),r=t*t;return(2*n-2*s+i+h)*(t*r)+(-3*n+3*s-2*i-h)*r+i*t+n}function St(t,i){t=1-t;return t*t*i}function _t(t,i){return 2*(1-t)*t*i}function Yt(t,i){return t*t*i}function Gt(t,i,n,s){return St(t,i)+_t(t,n)+Yt(t,s)}function Dt(t,i){t=1-t;return t*t*t*i}function Vt(t,i){var n=1-t;return 3*n*n*t*i}function It(t,i){return 3*(1-t)*t*t*i}function Xt(t,i){return t*t*t*i}function kt(t,i,n,s,h){return Dt(t,i)+Vt(t,n)+It(t,s)+Xt(t,h)}function T(t,i,n,s){O.call(this),this.type="CubicBezierCurve",this.v0=t||new tt,this.v1=i||new tt,this.v2=n||new tt,this.v3=s||new tt}function Wt(t,i,n,s){O.call(this),this.type="CubicBezierCurve3",this.v0=t||new $,this.v1=i||new $,this.v2=n||new $,this.v3=s||new $}function B(t,i){O.call(this),this.type="LineCurve",this.v1=t||new tt,this.v2=i||new tt}function t(t,i){O.call(this),this.type="LineCurve3",this.v1=t||new $,this.v2=i||new $}function Zt(t,i,n){O.call(this),this.type="QuadraticBezierCurve",this.v0=t||new tt,this.v1=i||new tt,this.v2=n||new tt}function Ut(t,i,n){O.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new $,this.v1=i||new $,this.v2=n||new $}function qt(t){O.call(this),this.type="SplineCurve",this.points=t||[]}function Kt(){O.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function zt(t){Kt.call(this),this.type="Path",this.currentPoint=new tt,t&&this.setFromPoints(t)}function Qt(t){zt.call(this,t),this.uuid=w.generateUUID(),this.type="Shape",this.holes=[]}Pt.prototype=Object.create(O.prototype),(Pt.prototype.constructor=Pt).prototype.isCatmullRomCurve3=!0,Pt.prototype.getPoint=function(t,i){var n,s,h,r,i=i||new $,e=this.points,o=e.length,t=(o-(this.closed?0:1))*t,u=Math.floor(t),t=t-u;return this.closed?u+=0<u?0:(Math.floor(Math.abs(u)/o)+1)*o:0===t&&u===o-1&&(u=o-2,t=1),n=this.closed||0<u?e[(u-1)%o]:(Nt.subVectors(e[0],e[1]).add(e[0]),Nt),s=e[u%o],h=e[(u+1)%o],u=this.closed||u+2<o?e[(u+2)%o]:(Nt.subVectors(e[o-1],e[o-2]).add(e[o-1]),Nt),"centripetal"===this.curveType||"chordal"===this.curveType?(e="chordal"===this.curveType?.5:.25,o=Math.pow(n.distanceToSquared(s),e),(r=Math.pow(s.distanceToSquared(h),e))<1e-4&&(r=1),o<1e-4&&(o=r),(e=Math.pow(h.distanceToSquared(u),e))<1e-4&&(e=r),Lt.initNonuniformCatmullRom(n.x,s.x,h.x,u.x,o,r,e),Ft.initNonuniformCatmullRom(n.y,s.y,h.y,u.y,o,r,e),Ct.initNonuniformCatmullRom(n.z,s.z,h.z,u.z,o,r,e)):"catmullrom"===this.curveType&&(Lt.initCatmullRom(n.x,s.x,h.x,u.x,this.tension),Ft.initCatmullRom(n.y,s.y,h.y,u.y,this.tension),Ct.initCatmullRom(n.z,s.z,h.z,u.z,this.tension)),i.set(Lt.calc(t),Ft.calc(t),Ct.calc(t)),i},Pt.prototype.copy=function(t){O.prototype.copy.call(this,t),this.points=[];for(var i=0,n=t.points.length;i<n;i++){var s=t.points[i];this.points.push(s.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},T.prototype=Object.create(O.prototype),(T.prototype.constructor=T).prototype.isCubicBezierCurve=!0,T.prototype.getPoint=function(t,i){var i=i||new tt,n=this.v0,s=this.v1,h=this.v2,r=this.v3;return i.set(kt(t,n.x,s.x,h.x,r.x),kt(t,n.y,s.y,h.y,r.y)),i},T.prototype.copy=function(t){return O.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Wt.prototype=Object.create(O.prototype),(Wt.prototype.constructor=Wt).prototype.isCubicBezierCurve3=!0,Wt.prototype.getPoint=function(t,i){var i=i||new $,n=this.v0,s=this.v1,h=this.v2,r=this.v3;return i.set(kt(t,n.x,s.x,h.x,r.x),kt(t,n.y,s.y,h.y,r.y),kt(t,n.z,s.z,h.z,r.z)),i},Wt.prototype.copy=function(t){return O.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},B.prototype=Object.create(O.prototype),(B.prototype.constructor=B).prototype.isLineCurve=!0,B.prototype.getPoint=function(t,i){i=i||new tt;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i},B.prototype.getPointAt=function(t,i){return this.getPoint(t,i)},B.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},B.prototype.copy=function(t){return O.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},t.prototype=Object.create(O.prototype),(t.prototype.constructor=t).prototype.isLineCurve3=!0,t.prototype.getPoint=function(t,i){i=i||new $;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i},t.prototype.getPointAt=function(t,i){return this.getPoint(t,i)},t.prototype.copy=function(t){return O.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Zt.prototype=Object.create(O.prototype),(Zt.prototype.constructor=Zt).prototype.isQuadraticBezierCurve=!0,Zt.prototype.getPoint=function(t,i){var i=i||new tt,n=this.v0,s=this.v1,h=this.v2;return i.set(Gt(t,n.x,s.x,h.x),Gt(t,n.y,s.y,h.y)),i},Zt.prototype.copy=function(t){return O.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ut.prototype.getPoint=function(t,i){var i=i||new $,n=this.v0,s=this.v1,h=this.v2;return i.set(Gt(t,n.x,s.x,h.x),Gt(t,n.y,s.y,h.y),Gt(t,n.z,s.z,h.z)),i},qt.prototype=Object.create(O.prototype),(qt.prototype.constructor=qt).prototype.isSplineCurve=!0,qt.prototype.getPoint=function(t,i){var i=i||new tt,n=this.points,t=(n.length-1)*t,s=Math.floor(t),t=t-s,h=n[0===s?s:s-1],r=n[s],e=n[s>n.length-2?n.length-1:s+1],n=n[s>n.length-3?n.length-1:s+2];return i.set(Ht(t,h.x,r.x,e.x,n.x),Ht(t,h.y,r.y,e.y,n.y)),i},qt.prototype.copy=function(t){O.prototype.copy.call(this,t),this.points=[];for(var i=0,n=t.points.length;i<n;i++){var s=t.points[i];this.points.push(s.clone())}return this},Kt.prototype=Object.assign(Object.create(O.prototype),{constructor:Kt,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),i=this.curves[this.curves.length-1].getPoint(1);t.equals(i)||this.curves.push(new B(i,t))},getPoint:function(t){for(var i,n,s,h=t*this.getLength(),r=this.getCurveLengths(),e=0;e<r.length;){if(r[e]>=h)return i=r[e]-h,s=(n=this.curves[e]).getLength(),n.getPointAt(0===s?0:1-i/s);e++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],i=0,n=0,s=this.curves.length;n<s;n++)i+=this.curves[n].getLength(),t.push(i);return this.cacheLengths=t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var i=[],n=0;n<=t;n++)i.push(this.getPoint(n/t));return this.autoClose&&i.push(i[0]),i},getPoints:function(t){t=t||12;for(var i,n=[],s=0,h=this.curves;s<h.length;s++)for(var r=h[s],e=r&&r.isEllipseCurve?2*t:r&&(r.isLineCurve||r.isLineCurve3)?1:r&&r.isSplineCurve?t*r.points.length:t,o=r.getPoints(e),u=0;u<o.length;u++){var a=o[u];i&&i.equals(a)||(n.push(a),i=a)}return this.autoClose&&1<n.length&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){O.prototype.copy.call(this,t),this.curves=[];for(var i=0,n=t.curves.length;i<n;i++){var s=t.curves[i];this.curves.push(s.clone())}return this.autoClose=t.autoClose,this}}),zt.prototype=Object.assign(Object.create(Kt.prototype),{constructor:zt,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var i=1,n=t.length;i<n;i++)this.lineTo(t[i].x,t[i].y);return this},moveTo:function(t,i){return this.currentPoint.set(t,i),this},lineTo:function(t,i){var n=new B(this.currentPoint.clone(),new tt(t,i));return this.curves.push(n),this.currentPoint.set(t,i),this},quadraticCurveTo:function(t,i,n,s){t=new Zt(this.currentPoint.clone(),new tt(t,i),new tt(n,s));return this.curves.push(t),this.currentPoint.set(n,s),this},bezierCurveTo:function(t,i,n,s,h,r){t=new T(this.currentPoint.clone(),new tt(t,i),new tt(n,s),new tt(h,r));return this.curves.push(t),this.currentPoint.set(h,r),this},splineThru:function(t){var i=new qt([this.currentPoint.clone()].concat(t));return this.curves.push(i),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,i,n,s,h,r){var e=this.currentPoint.x,o=this.currentPoint.y;return this.absarc(t+e,i+o,n,s,h,r),this},absarc:function(t,i,n,s,h,r){return this.absellipse(t,i,n,n,s,h,r),this},ellipse:function(t,i,n,s,h,r,e,o){var u=this.currentPoint.x,a=this.currentPoint.y;return this.absellipse(t+u,i+a,n,s,h,r,e,o),this},absellipse:function(t,i,n,s,h,r,e,o){t=new x(t,i,n,s,h,r,e,o),0<this.curves.length&&((i=t.getPoint(0)).equals(this.currentPoint)||this.lineTo(i.x,i.y)),this.curves.push(t),n=t.getPoint(1);return this.currentPoint.copy(n),this},copy:function(t){return Kt.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this}}),Qt.prototype=Object.assign(Object.create(zt.prototype),{constructor:Qt,getPointsHoles:function(t){for(var i=[],n=0,s=this.holes.length;n<s;n++)i[n]=this.holes[n].getPoints(t);return i},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){zt.prototype.copy.call(this,t),this.holes=[];for(var i=0,n=t.holes.length;i<n;i++){var s=t.holes[i];this.holes.push(s.clone())}return this}});var Jt={triangulate:function(t,i,n){n=n||2;var s,h,r,e,o,u=i&&i.length,a=u?i[0]*n:t.length,c=$t(t,0,a,n,!0),f=[];if(c&&c.next!==c.prev){if(u&&(c=ei(t,i,c,n)),t.length>80*n){for(var v=s=t[0],l=h=t[1],d=n;d<a;d+=n)(r=t[d])<v&&(v=r),(e=t[d+1])<l&&(l=e),s<r&&(s=r),h<e&&(h=e);o=0!==(o=Math.max(s-v,h-l))?1/o:0}ii(c,f,n,v,l,o)}return f}};function $t(t,i,n,s,h){var r,e;if(h===0<Ri(t,i,n,s))for(r=i;r<n;r+=s)e=Ei(r,t[r],t[r+1],e);else for(r=n-s;i<=r;r-=s)e=Ei(r,t[r],t[r+1],e);return e&&L(e,e.next)&&(gi(e),e=e.next),e}function ti(t,i){if(!t)return t;i=i||t;var n,s=t;do{if(n=!1,s.steiner||!L(s,s.next)&&0!==N(s.prev,s,s.next))s=s.next;else{if(gi(s),(s=i=s.prev)===s.next)break;n=!0}}while(n||s!==i);return i}function ii(t,i,n,s,h,r,e){if(t){!e&&r&&ci(t,s,h,r);for(var o,u,a=t;t.prev!==t.next;)if(o=t.prev,u=t.next,r?si(t,s,h,r):ni(t))i.push(o.i/n),i.push(t.i/n),i.push(u.i/n),gi(t),t=u.next,a=u.next;else if((t=u)===a){e?1===e?ii(t=hi(t,i,n),i,n,s,h,r,2):2===e&&ri(t,i,n,s,h,r):ii(ti(t),i,n,s,h,r,1);break}}}function ni(t){var i=t.prev,n=t,s=t.next;if(0<=N(i,n,s))return!1;for(var h=t.next.next;h!==t.prev;){if(di(i.x,i.y,n.x,n.y,s.x,s.y,h.x,h.y)&&0<=N(h.prev,h,h.next))return!1;h=h.next}return!0}function si(t,i,n,s){var h=t.prev,r=t,e=t.next;if(0<=N(h,r,e))return!1;for(var o=(h.x<r.x?h.x<e.x?h:e:r.x<e.x?r:e).x,u=(h.y<r.y?h.y<e.y?h:e:r.y<e.y?r:e).y,a=(h.x>r.x?h.x>e.x?h:e:r.x>e.x?r:e).x,c=(h.y>r.y?h.y>e.y?h:e:r.y>e.y?r:e).y,f=vi(o,u,i,n,s),v=vi(a,c,i,n,s),l=t.prevZ,d=t.nextZ;l&&l.z>=f&&d&&d.z<=v;){if(l!==t.prev&&l!==t.next&&di(h.x,h.y,r.x,r.y,e.x,e.y,l.x,l.y)&&0<=N(l.prev,l,l.next))return!1;if(l=l.prevZ,d!==t.prev&&d!==t.next&&di(h.x,h.y,r.x,r.y,e.x,e.y,d.x,d.y)&&0<=N(d.prev,d,d.next))return!1;d=d.nextZ}for(;l&&l.z>=f;){if(l!==t.prev&&l!==t.next&&di(h.x,h.y,r.x,r.y,e.x,e.y,l.x,l.y)&&0<=N(l.prev,l,l.next))return!1;l=l.prevZ}for(;d&&d.z<=v;){if(d!==t.prev&&d!==t.next&&di(h.x,h.y,r.x,r.y,e.x,e.y,d.x,d.y)&&0<=N(d.prev,d,d.next))return!1;d=d.nextZ}return!0}function hi(t,i,n){var s=t;do{var h=s.prev,r=s.next.next}while(!L(h,r)&&Mi(h,s,s.next,r)&&pi(h,r)&&pi(r,h)&&(i.push(h.i/n),i.push(s.i/n),i.push(r.i/n),gi(s),gi(s.next),s=t=r),(s=s.next)!==t);return s}function ri(t,i,n,s,h,r){var e=t;do{for(var o,u=e.next.next;u!==e.prev;){if(e.i!==u.i&&wi(e,u))return o=yi(e,u),e=ti(e,e.next),o=ti(o,o.next),ii(e,i,n,s,h,r),void ii(o,i,n,s,h,r);u=u.next}}while((e=e.next)!==t)}function ei(t,i,n,s){for(var h,r=[],e=0,o=i.length;e<o;e++)(h=$t(t,i[e]*s,e<o-1?i[e+1]*s:t.length,s,!1))===h.next&&(h.steiner=!0),r.push(li(h));for(r.sort(oi),e=0;e<r.length;e++)ui(r[e],n),n=ti(n,n.next);return n}function oi(t,i){return t.x-i.x}function ui(t,i){(i=ai(t,i))&&ti(i=yi(i,t),i.next)}function ai(t,i){var n,s=i,h=t.x,r=t.y,e=-1/0;do{if(r<=s.y&&r>=s.next.y&&s.next.y!==s.y){var o=s.x+(r-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(o<=h&&e<o){if((e=o)===h){if(r===s.y)return s;if(r===s.next.y)return s.next}n=s.x<s.next.x?s:s.next}}}while((s=s.next)!==i);if(!n)return null;if(h===e)return n.prev;for(var u,a=n,c=n.x,f=n.y,v=1/0,s=n.next;s!==a;)h>=s.x&&s.x>=c&&h!==s.x&&di(r<f?h:e,r,c,f,r<f?e:h,r,s.x,s.y)&&((u=Math.abs(r-s.y)/(h-s.x))<v||u===v&&s.x>n.x)&&pi(s,t)&&(n=s,v=u),s=s.next;return n}function ci(t,i,n,s){for(var h=t;null===h.z&&(h.z=vi(h.x,h.y,i,n,s)),h.prevZ=h.prev,h.nextZ=h.next,(h=h.next)!==t;);h.prevZ.nextZ=null,h.prevZ=null,fi(h)}function fi(t){var i,n,s,h,r,e,o,u,a=1;do{for(n=t,r=t=null,e=0;n;){for(e++,s=n,i=o=0;i<a&&(o++,s=s.nextZ);i++);for(u=a;0<o||0<u&&s;)0!==o&&(0===u||!s||n.z<=s.z)?(n=(h=n).nextZ,o--):(s=(h=s).nextZ,u--),r?r.nextZ=h:t=h,h.prevZ=r,r=h;n=s}}while(r.nextZ=null,a*=2,1<e);return t}function vi(t,i,n,s,h){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-n)*h)|t<<8))|t<<4))|t<<2))|t<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=32767*(i-s)*h)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function li(t){for(var i=t,n=t;(i.x<n.x||i.x===n.x&&i.y<n.y)&&(n=i),(i=i.next)!==t;);return n}function di(t,i,n,s,h,r,e,o){return 0<=(h-e)*(i-o)-(t-e)*(r-o)&&0<=(t-e)*(s-o)-(n-e)*(i-o)&&0<=(n-e)*(r-o)-(h-e)*(s-o)}function wi(t,i){return t.next.i!==i.i&&t.prev.i!==i.i&&!mi(t,i)&&pi(t,i)&&pi(i,t)&&bi(t,i)}function N(t,i,n){return(i.y-t.y)*(n.x-i.x)-(i.x-t.x)*(n.y-i.y)}function L(t,i){return t.x===i.x&&t.y===i.y}function Mi(t,i,n,s){return!!(L(t,n)&&L(i,s)||L(t,s)&&L(n,i))||0<N(t,i,n)!=0<N(t,i,s)&&0<N(n,s,t)!=0<N(n,s,i)}function mi(t,i){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==i.i&&n.next.i!==i.i&&Mi(n,n.next,t,i))return!0}while((n=n.next)!==t);return!1}function pi(t,i){return N(t.prev,t,t.next)<0?0<=N(t,i,t.next)&&0<=N(t,t.prev,i):N(t,i,t.prev)<0||N(t,t.next,i)<0}function bi(t,i){for(var n=t,s=!1,h=(t.x+i.x)/2,r=(t.y+i.y)/2;n.y>r!=n.next.y>r&&n.next.y!==n.y&&h<(n.next.x-n.x)*(r-n.y)/(n.next.y-n.y)+n.x&&(s=!s),(n=n.next)!==t;);return s}function yi(t,i){var n=new Ai(t.i,t.x,t.y),s=new Ai(i.i,i.x,i.y),h=t.next,r=i.prev;return(t.next=i).prev=t,(n.next=h).prev=n,(s.next=n).prev=s,(r.next=s).prev=r,s}function Ei(t,i,n,s){t=new Ai(t,i,n);return s?(t.next=s.next,(t.prev=s).next.prev=t,s.next=t):(t.prev=t).next=t,t}function gi(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ai(t,i,n){this.i=t,this.x=i,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ri(t,i,n,s){for(var h=0,r=i,e=n-s;r<n;r+=s)h+=(t[e]-t[r])*(t[r+1]+t[e+1]),e=r;return h}var it={area:function(t){for(var i=t.length,n=0,s=i-1,h=0;h<i;s=h++)n+=t[s].x*t[h].y-t[h].x*t[s].y;return.5*n},isClockWise:function(t){return it.area(t)<0},triangulateShape:function(t,i){var n=[],s=[],h=[],r=(Oi(t),xi(n,t),t.length);i.forEach(Oi);for(var e=0;e<i.length;e++)s.push(r),r+=i[e].length,xi(n,i[e]);for(var o=Jt.triangulate(n,s),e=0;e<o.length;e+=3)h.push(o.slice(e,e+3));return h}};function Oi(t){var i=t.length;2<i&&t[i-1].equals(t[0])&&t.pop()}function xi(t,i){for(var n=0;n<i.length;n++)t.push(i[n].x),t.push(i[n].y)}function ji(t,i){R.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:i},this.fromBufferGeometry(new Ti(t,i)),this.mergeVertices()}function Ti(t,K){j.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:K},t=Array.isArray(t)?t:[t];for(var z=this,Q=[],J=[],i=0,n=t.length;i<n;i++)!function(S){var s=[],_=void 0!==K.curveSegments?K.curveSegments:12,v=void 0!==K.steps?K.steps:1,t=void 0!==K.depth?K.depth:100,n=void 0===K.bevelEnabled||K.bevelEnabled,i=void 0!==K.bevelThickness?K.bevelThickness:6,Y=void 0!==K.bevelSize?K.bevelSize:i-2,G=void 0!==K.bevelOffset?K.bevelOffset:0,l=void 0!==K.bevelSegments?K.bevelSegments:3,h=K.extrudePath,D=void 0!==K.UVGenerator?K.UVGenerator:Bi;void 0!==K.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),t=K.amount);var r,e,o,u,a,c,f,d,V=!1;h&&(r=h.getSpacedPoints(v),n=!(V=!0),e=h.computeFrenetFrames(v,!1),o=new $,u=new $,a=new $);n||(G=Y=i=l=0);var h=S.extractPoints(_),w=h.shape,M=h.holes;if(!it.isClockWise(w))for(w=w.reverse(),f=0,d=M.length;f<d;f++)c=M[f],it.isClockWise(c)&&(M[f]=c.reverse());var m=it.triangulateShape(w,M),p=w;for(f=0,d=M.length;f<d;f++)c=M[f],w=w.concat(c);function b(t,i,n){return i||console.error("THREE.ExtrudeGeometry: vec does not exist"),i.clone().multiplyScalar(n).add(t)}var y,E,g,A,R,O,x=w.length,I=m.length;function X(t,i,n){var s=t.x-i.x,h=t.y-i.y,r=n.x-t.x,e=n.y-t.y,o=s*s+h*h;if(Math.abs(s*e-h*r)>Number.EPSILON){var u=Math.sqrt(o),a=Math.sqrt(r*r+e*e),c=i.x-h/u,i=i.y+s/u,u=((n.x-e/a-c)*e-(n.y+r/a-i)*r)/(s*e-h*r),n=(a=c+s*u-t.x)*a+(c=i+h*u-t.y)*c;if(n<=2)return new tt(a,c);u=Math.sqrt(n/2)}else{i=!1;s>Number.EPSILON?r>Number.EPSILON&&(i=!0):s<-Number.EPSILON?r<-Number.EPSILON&&(i=!0):Math.sign(h)===Math.sign(e)&&(i=!0),u=i?(a=-h,c=s,Math.sqrt(o)):(a=s,c=h,Math.sqrt(o/2))}return new tt(a/u,c/u)}for(var k=[],j=0,T=p.length,B=T-1,N=j+1;j<T;j++,B++,N++)B===T&&(B=0),N===T&&(N=0),k[j]=X(p[j],p[B],p[N]);var L,F,W=[],Z=k.concat();for(f=0,d=M.length;f<d;f++){for(c=M[f],L=[],j=0,T=c.length,B=T-1,N=j+1;j<T;j++,B++,N++)B===T&&(B=0),N===T&&(N=0),L[j]=X(c[j],c[B],c[N]);W.push(L),Z=Z.concat(L)}for(y=0;y<l;y++){for(g=y/l,A=i*Math.cos(g*Math.PI/2),E=Y*Math.sin(g*Math.PI/2)+G,j=0,T=p.length;j<T;j++)C((R=b(p[j],k[j],E)).x,R.y,-A);for(f=0,d=M.length;f<d;f++)for(c=M[f],L=W[f],j=0,T=c.length;j<T;j++)C((R=b(c[j],L[j],E)).x,R.y,-A)}for(E=Y+G,j=0;j<x;j++)R=n?b(w[j],Z[j],E):w[j],V?(u.copy(e.normals[0]).multiplyScalar(R.x),o.copy(e.binormals[0]).multiplyScalar(R.y),a.copy(r[0]).add(u).add(o),C(a.x,a.y,a.z)):C(R.x,R.y,0);for(F=1;F<=v;F++)for(j=0;j<x;j++)R=n?b(w[j],Z[j],E):w[j],V?(u.copy(e.normals[F]).multiplyScalar(R.x),o.copy(e.binormals[F]).multiplyScalar(R.y),a.copy(r[F]).add(u).add(o),C(a.x,a.y,a.z)):C(R.x,R.y,t/v*F);for(y=l-1;0<=y;y--){for(g=y/l,A=i*Math.cos(g*Math.PI/2),E=Y*Math.sin(g*Math.PI/2)+G,j=0,T=p.length;j<T;j++)C((R=b(p[j],k[j],E)).x,R.y,t+A);for(f=0,d=M.length;f<d;f++)for(c=M[f],L=W[f],j=0,T=c.length;j<T;j++)R=b(c[j],L[j],E),V?C(R.x,R.y+r[v-1].y,r[v-1].x+A):C(R.x,R.y,t+A)}function U(t,i){var n,s;for(j=t.length;0<=--j;){(s=(n=j)-1)<0&&(s=t.length-1);for(var h=0,r=v+2*l,h=0;h<r;h++){var e=x*h,o=x*(h+1),u=(f=c=a=u=void 0,i+n+e),a=i+s+e,c=i+s+o,f=i+n+o;P(u),P(a),P(f),P(a),P(c),P(f),u=Q.length/3,H((a=D.generateSideWallUV(z,Q,u-6,u-3,u-2,u-1))[0]),H(a[1]),H(a[3]),H(a[1]),H(a[2]),H(a[3])}}}function C(t,i,n){s.push(t),s.push(i),s.push(n)}function q(t,i,n){P(t),P(i),P(n);t=Q.length/3,i=D.generateTopUV(z,Q,t-3,t-2,t-1);H(i[0]),H(i[1]),H(i[2])}function P(t){Q.push(s[3*t+0]),Q.push(s[3*t+1]),Q.push(s[3*t+2])}function H(t){J.push(t.x),J.push(t.y)}(function(){var t=Q.length/3;if(n){var i=0*x;for(j=0;j<I;j++)q((O=m[j])[2]+i,O[1]+i,O[0]+i);for(i=x*(v+2*l),j=0;j<I;j++)q((O=m[j])[0]+i,O[1]+i,O[2]+i)}else{for(j=0;j<I;j++)q((O=m[j])[2],O[1],O[0]);for(j=0;j<I;j++)q((O=m[j])[0]+x*v,O[1]+x*v,O[2]+x*v)}z.addGroup(t,Q.length/3-t,0)})(),function(){var t=Q.length/3,i=0;for(U(p,i),i+=p.length,f=0,d=M.length;f<d;f++)U(c=M[f],i),i+=c.length;z.addGroup(t,Q.length/3-t,1)}()}(t[i]);this.setAttribute("position",new c(Q,3)),this.setAttribute("uv",new c(J,2)),this.computeVertexNormals()}ji.prototype=Object.create(R.prototype),ji.prototype.constructor=ji,Ti.prototype=Object.create(j.prototype),Ti.prototype.constructor=Ti;var Bi={generateTopUV:function(t,i,n,s,h){var r=i[3*n],n=i[3*n+1],e=i[3*s],s=i[3*s+1],o=i[3*h],i=i[3*h+1];return[new tt(r,n),new tt(e,s),new tt(o,i)]},generateSideWallUV:function(t,i,n,s,h,r){var e=i[3*n],o=i[3*n+1],n=i[3*n+2],u=i[3*s],a=i[3*s+1],s=i[3*s+2],c=i[3*h],f=i[3*h+1],h=i[3*h+2],v=i[3*r],l=i[3*r+1],i=i[3*r+2];return Math.abs(o-a)<.01?[new tt(e,1-n),new tt(u,1-s),new tt(c,1-h),new tt(v,1-i)]:[new tt(o,1-n),new tt(a,1-s),new tt(f,1-h),new tt(l,1-i)]}};function Ni(t,i){R.call(this),this.type="ShapeGeometry","object"==typeof i&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),i=i.curveSegments),this.parameters={shapes:t,curveSegments:i},this.fromBufferGeometry(new Li(t,i)),this.mergeVertices()}function Li(t,v){j.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:v},v=v||12;var l=[],d=[],w=[],M=[],i=0,m=0;if(!1===Array.isArray(t))s(t);else for(var n=0;n<t.length;n++)s(t[n]),this.addGroup(i,m,n),i+=m,m=0;function s(t){var i,n=d.length/3,t=t.extractPoints(v),s=t.shape,h=t.holes;for(!1===it.isClockWise(s)&&(s=s.reverse()),e=0,o=h.length;e<o;e++)i=h[e],!0===it.isClockWise(i)&&(h[e]=i.reverse());for(var r=it.triangulateShape(s,h),e=0,o=h.length;e<o;e++)i=h[e],s=s.concat(i);for(e=0,o=s.length;e<o;e++){var u=s[e];d.push(u.x,u.y,0),w.push(0,0,1),M.push(u.x,u.y)}for(e=0,o=r.length;e<o;e++){var a=r[e],c=a[0]+n,f=a[1]+n,a=a[2]+n;l.push(c,f,a),m+=3}}this.setIndex(l),this.setAttribute("position",new c(d,3)),this.setAttribute("normal",new c(w,3)),this.setAttribute("uv",new c(M,2))}Ni.prototype=Object.create(R.prototype),Ni.prototype.constructor=Ni,Li.prototype=Object.create(j.prototype),Li.prototype.constructor=Li;var Fi=class Yi{constructor(){this.A={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.R={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}get min(){return this.A}get max(){return this.R}get center(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=(this.min.x+this.max.x)/2,t.y=(this.min.y+this.max.y)/2),t}get size(){var t={x:Number.NaN,y:Number.NaN};return this.valid()&&(t.x=this.max.x-this.min.x,t.y=this.max.y-this.min.y),t}copy(t){return this.R.x=t.max.x,this.R.y=t.max.y,this.A.x=t.min.x,this.A.y=t.min.y,this}clone(){return(new Yi).copy(this)}reset(){this.A={x:Number.MAX_VALUE,y:Number.MAX_VALUE},this.R={x:-Number.MAX_VALUE,y:-Number.MAX_VALUE}}toObject(){return{min:this.min,max:this.max,center:this.center,size:this.size}}expand(t){this.O(t)}expandByCoords(t){this.j(t)}valid(){return this.T()}isCross(t){let i=!0;return t.max.x<this.min.x&&(i=!1),t.min.x>this.max.x&&(i=!1),t.max.y<this.min.y&&(i=!1),i=t.min.y>this.max.y?!1:i}},Ci=(Object.assign(Fi.prototype,{T(){return!(this.min.x>this.max.x||this.min.y>this.max.y)},O(t){t&&t.valid()&&(t.min.x<this.min.x&&(this.min.x=t.min.x),t.min.y<this.min.y&&(this.min.y=t.min.y),t.max.x>this.max.x&&(this.max.x=t.max.x),t.max.y>this.max.y)&&(this.max.y=t.max.y)},j(t){t&&0!=t.length&&t.forEach(t=>{t.x<this.min.x&&(this.min.x=t.x),t.y<this.min.y&&(this.min.y=t.y),t.x>this.max.x&&(this.max.x=t.x),t.y>this.max.y&&(this.max.y=t.y)})}}),Fi),F={NONE:0,EXTRUDE_MARKER:2,FM3DTILE_LAYER:4,IMAGE_MARKER:8,LOCATION_MARKER:16,POLYGON_MARKER:32,TEXT_MARKER:64,LINE_MARKER:128,LINE3D_MARKER:256,HEAT_MAP_MARKER:512,EXTENT:1024,EXTERNAL_MODEL:2048,MODEL:4096,FACILITY:8192,LABEL:16384,DYNAMIC_MODEL_MARKER:32768,DOM_MARKER:65536,SPHERE_MARKER:1<<17,CAD_LAYER:1<<18,EXTENT_LAYER:1<<20,EXTERNAL_MODEL_LAYER:1<<21,MODEL_LAYER:1<<22,FACILITY_LAYER:1<<23,LABEL_LAYER:1<<24,MARKER_GROUP:1<<25,FLOW_LINE_LAYER:1<<27,FLOW_LINE_MARKER:1<<27,FIRE_MARKER:1<<28,WALL_MARKER:1<<29,TUBE_MARKER:1<<30},Pi=(F.LAYER_NODE_TYPE=new Map,F.LAYER_NODE_TYPE.set(F.EXTENT_LAYER,F.EXTENT),F.LAYER_NODE_TYPE.set(F.EXTERNAL_MODEL_LAYER,F.EXTERNAL_MODEL),F.LAYER_NODE_TYPE.set(F.MODEL_LAYER,F.MODEL),F.LAYER_NODE_TYPE.set(F.FACILITY_LAYER,F.FACILITY),F.LAYER_NODE_TYPE.set(F.LABEL_LAYER,F.LABEL),F.LAYER_NODE_TYPE.set(F.DOM_MARKER,F.DOM_MARKER),F.LAYER_NODE_TYPE.set(F.DYNAMIC_MODEL_MARKER,F.DYNAMIC_MODEL_MARKER),F.LAYER_NODE_TYPE.set(F.EXTRUDE_MARKER,F.EXTRUDE_MARKER),F.LAYER_NODE_TYPE.set(F.HEAT_MAP_MARKER,F.HEAT_MAP_MARKER),F.LAYER_NODE_TYPE.set(F.LINE_MARKER,F.LINE_MARKER),F.LAYER_NODE_TYPE.set(F.LOCATION_MARKER,F.LOCATION_MARKER),F.LAYER_NODE_TYPE.set(F.POLYGON_MARKER,F.POLYGON_MARKER),F.LAYER_NODE_TYPE.set(F.TEXT_MARKER,F.TEXT_MARKER),F.LAYER_NODE_TYPE.set(F.IMAGE_MARKER,F.IMAGE_MARKER),F.LAYER_NODE_TYPE.set(F.FLOW_LINE_LAYER,F.FLOW_LINE_MARKER),F.LAYER_NODE_TYPE.set(F.FIRE_MARKER,F.FIRE_MARKER),F.LAYER_NODE_TYPE.set(F.WALL_MARKER,F.WALL_MARKER),F.LAYER_NODE_TYPE.set(F.TUBE_MARKER,F.TUBE_MARKER),F.LAYER_NODE_TYPE.set(F.LINE3D_MARKER,F.LINE3D_MARKER),F.LAYER_NODE_TYPE.set(F.SPHERE_MARKER,F.SPHERE_MARKER),F.LAYER_NODE_TYPE.set(F.CAD_LAYER,F.CAD_LAYER),F);function Hi(t,i){var n=(new R).setFromPoints(t.getPoints()),s=(n&&0<n.vertices.length&&n.vertices.push(n.vertices[0]),[]),h=n.vertices.length;for(let t=0;t<h;t++)n.vertices[t].z=i,0===t||t===h-1?s.push(n.vertices[t]):s.push(n.vertices[t],n.vertices[t]);return n.vertices=s,(new j).setFromObject({geometry:n,isLine:!0})}function Si(t,i,n){var s,h=t["attributes"];for(s in h){var{count:r,itemSize:e,usage:o,array:u}=h[s],r=new ArrayBuffer(r*e*4);new Float32Array(r).set(u),n.push(r),i.push({key:s,itemSize:e,usage:o,array:r})}}function _i(t,i){const{type:n,coordGroup:s,bound:h,amount:r,referenceBound:e,createLineType:o,lineHeight:u}=t;var a=new Ci,t=(a.expandByCoords([h.max,h.min]),new Ci),c=(n===Pi.MODEL&&t.expandByCoords([e.max,e.min]),new Qt),f=new Float64Array(s[0]);let v=H(f);if(0<v.length){c.moveTo(v[0].x-a.center.x,v[0].y-a.center.y);for(let t=1;t<v.length;t++)c.lineTo(v[t].x-a.center.x,v[t].y-a.center.y)}if(1<s.length)for(let t=1;t<s.length;t++){var l=new Float64Array(s[t]),d=new zt;if(0<l.length){v=H(l),d.moveTo(v[0].x-a.center.x,v[0].y-a.center.y);for(let t=1;t<v.length;t++)d.lineTo(v[t].x-a.center.x,v[t].y-a.center.y)}c.holes.push(d)}let w=null;w=0===r?new Ni(c):new ji(c,{depth:r,bevelEnabled:!1});let M,m,p,b;b=n===Pi.MODEL?(M=t.min.x,m=t.min.y,p=t.max.x-M,t.max.y-m):(M=a.min.x,m=a.min.y,p=a.max.x-M,a.max.y-m);var y=w.faces,E=y.length;for(let t=0;t<E;t++){var g=w.vertices[y[t].a],A=w.vertices[y[t].b],R=w.vertices[y[t].c];w.faceVertexUvs[0][t][0].x=(g.x+a.center.x-M)/p,w.faceVertexUvs[0][t][0].y=(g.y+a.center.y-m)/b,w.faceVertexUvs[0][t][1].x=(A.x+a.center.x-M)/p,w.faceVertexUvs[0][t][1].y=(A.y+a.center.y-m)/b,w.faceVertexUvs[0][t][2].x=(R.x+a.center.x-M)/p,w.faceVertexUvs[0][t][2].y=(R.y+a.center.y-m)/b}f=[];Si((new j).fromGeometry(w),f,i);let O=[];if("geometry"===o)Si(Hi(c,u),O,i);else if("onlyData"===o){t=c.getPoints();const x=[];t.forEach(t=>{x.push(t.x,t.y,u)});t=new ArrayBuffer(4*x.length);i.push(t),new Float32Array(t).set(x),O=t}return{attributesInfo:f,lineAttributeInfo:O}}export{Pi as FMType_default,_i as handleGeometry};